<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="This is a demo site for Nikola.">
<meta name="viewport" content="width=device-width">
<title>My Nikola Site (old posts, page 2) | My Nikola Site</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="https://example.com/index-2.html">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><style>
    div.input_prompt {
      display: none;
    }
    </style>
</head>
<body>
    <section class="social"><ul>
<li><a href="index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="rss.xml" title="RSS"><i class="icon-rss"></i></a></li>
            <li><a href="https://getnikola.com" title="About me"><i class="icon-user"></i></a></li>
            <li><a href="https://twitter.com/getnikola" title="My Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="https://github.com/getnikola" title="My Github"><i class="icon-github"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
        <div class="post">
            <h1 class="title"><a href="posts/books/python_cookbook/ch08-01/">ch08_01</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-06-15T19:51:40-09:00">2016-06-15 19:51</time>
</div>
                <div class="stats">
                    
                </div>
                
            </div>
            <div class="body">
                <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="8.-클래스와-객체">8. 클래스와 객체<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#8.-%ED%81%B4%EB%9E%98%EC%8A%A4%EC%99%80-%EA%B0%9D%EC%B2%B4">¶</a>
</h2>
<ul>
<li>클래스 정의와 관련된 프로그래밍 패턴에 대해 주로 알아봄</li>
<li>일반적인 파이썬 기능을 객체가 지원하도록 하기, 특별 메소드 사용, encapsulation 기술, 상속, 메모리 관리, 유용한 디자인 패턴 등이 포함됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="8.1-인스턴스의-문자열-표현식-변형">8.1 인스턴스의 문자열 표현식 변형<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#8.1-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4%EC%9D%98-%EB%AC%B8%EC%9E%90%EC%97%B4-%ED%91%9C%ED%98%84%EC%8B%9D-%EB%B3%80%ED%98%95">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>인스턴스를 출력하거나 볼 때 생성되는 결과물을 좀 더 보기 좋게 바꾸고 싶다</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>인스턴스의 문자열 표현식을 바꾸려면 __str__()와 __repr__() 메소드 정의</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Pair</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
        
    <span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">'Pair(</span><span class="si">{0.x!r}</span><span class="s1">, </span><span class="si">{0.y!r}</span><span class="s1">)'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">'(</span><span class="si">{0.x!s}</span><span class="s1">, </span><span class="si">{0.y!s}</span><span class="s1">)'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>__repr__() 메소드는 인스턴스의 코드 표현식을 반환하고, 일반적으로 인스턴스를 재생성할 때 입력하는 텍스트</li>
<li>내장 repr() 함수는 인터프리터에서 값을 조사할 때와 마찬가지로 이 텍스트를 반환함</li>
<li>__str__() 메소드는 인스턴스를 문자열로 변환하고, str()와 print() 함수가 출력하는 결과가 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Pair</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[3]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>Pair(3, 4)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>(3, 4)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>__repr__()와 __str__()를 정의하면 디버깅과 인스턴스 출력을 간소화</li>
<li>예를 들어, 단지 출력이나 인스턴스 로깅을 할 때도, 프로그래머는 인스턴스 내용에 대해 더 유용한 정보를 얻을 수 있음</li>
<li>__repr__()는 eval(repr(x)) == x와 같은 텍스트를 만드는 것이 표준</li>
<li>이것을 원하지 않거나 불가능하다면 일반적으로  사이에 텍스트를 넣는다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'08/calling_a_method_on_a_parent_class/example1.py'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[6]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;_io.TextIOWrapper name='08/calling_a_method_on_a_parent_class/example1.py' mode='r' encoding='UTF-8'&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>__str__()를 정의하지 않으면 대신 __repr__()의 결과물을 사용</li>
<li>format()을 사용한 점이 족므 우스울지 모르겠지만, 서식 코드 {0.x}는 인자 0의 x 속성을 명시함</li>
<li>따라서 다음 함수에서 0은 실제로 인스턴스 self를 의미함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">'Pair(</span><span class="si">{0.x!r}</span><span class="s1">, </span><span class="si">{0.y!r}</span><span class="s1">)'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 구현법에 대한 대안으로 % 연산자와 다음 코드를 사용해도 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">'Pair(</span><span class="si">%r</span><span class="s1">, </span><span class="si">%r</span><span class="s1">)'</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="8.2-문자열-서식화-조절">8.2 문자열 서식화 조절<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#8.2-%EB%AC%B8%EC%9E%90%EC%97%B4-%EC%84%9C%EC%8B%9D%ED%99%94-%EC%A1%B0%EC%A0%88">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>format() 함수와 문자열 메소드로 사용자가 정의한 서식화를 지원하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>문자열 서식화를 조절하고 싶으면 클래스에 __format__ 메소드 정의</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_formats</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'ymd'</span> <span class="p">:</span> <span class="s1">'</span><span class="si">{d.year}</span><span class="s1">-</span><span class="si">{d.month}</span><span class="s1">-</span><span class="si">{d.day}</span><span class="s1">'</span><span class="p">,</span>
    <span class="s1">'mdy'</span> <span class="p">:</span> <span class="s1">'</span><span class="si">{d.month}</span><span class="s1">/</span><span class="si">{d.day}</span><span class="s1">/</span><span class="si">{d.year}</span><span class="s1">'</span><span class="p">,</span>
    <span class="s1">'dmy'</span> <span class="p">:</span> <span class="s1">'</span><span class="si">{d.day}</span><span class="s1">/</span><span class="si">{d.month}</span><span class="s1">/</span><span class="si">{d.year}</span><span class="s1">'</span>
<span class="p">}</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Date</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span>
        
    <span class="k">def</span> <span class="nf">__format__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="s1">''</span><span class="p">:</span>
            <span class="n">code</span> <span class="o">=</span> <span class="s1">'ymd'</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="n">_formats</span><span class="p">[</span><span class="n">code</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Date 클래스의 인스턴스는 이제 다음과 같은 서식화 지원</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">Date</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">format</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[41]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'2012-12-21'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">format</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">'mdy'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[42]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'12/21/2012'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">'The date is {:ymd}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[43]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'The date is 2012-12-21'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [44]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">'The date is {:mdy}'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[44]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'The date is 12/21/2012'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>__format__() 메소드는 파이썬의 문자열 서식화 함수에 후크(hook)를 제공</li>
<li>서식화 코드의 해석은 모두 클래스 자체에 달려있다는 점이 중요</li>
<li>따라서 코드에는 거의 모든 내용이 올 수 있음</li>
<li>다음 datetime 모듈을 보자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">date</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [46]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="n">date</span><span class="p">(</span><span class="mi">2012</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">format</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[47]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'2012-12-21'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">format</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="s1">'%A, %B </span><span class="si">%d</span><span class="s1">, %Y'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[48]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'Friday, December 21, 2012'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="s1">'The end is {:</span><span class="si">%d</span><span class="s1"> %b %Y}. Goodbye'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[49]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'The end is 21 Dec 2012. Goodbye'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>내장 타입의 서식화에는 어느 정도 표준이 있음</li>
<li><a href="https://docs.python.org/2/library/string.html">7.1. string â Common string operations — Python 2.7.8 documentation</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="8.3-객체의-콘텍스트-관리-프로토콜-지원">8.3 객체의 콘텍스트 관리 프로토콜 지원<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#8.3-%EA%B0%9D%EC%B2%B4%EC%9D%98-%EC%BD%98%ED%85%8D%EC%8A%A4%ED%8A%B8-%EA%B4%80%EB%A6%AC-%ED%94%84%EB%A1%9C%ED%86%A0%EC%BD%9C-%EC%A7%80%EC%9B%90">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>객체가 콘텍스트 관리 프로토콜(with 구문)을 지원하게 만들고 싶다</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>객체와 with 구문을 함께 사용할 수 있게 만들려면, __enter__()와 __exit__() 메소드를 구현해야 함</li>
<li>예를 들어 네트워크 연결을 제공하는 다음 클래스를 보자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">socket</span> <span class="k">import</span> <span class="n">socket</span><span class="p">,</span> <span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [56]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">LazyConnection</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">AF_INET</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">SOCK_STREAM</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="o">=</span> <span class="n">AF_INET</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">SOCK_STREAM</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sock</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">sock</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">'Already connected'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">family</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sock</span>
    
    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_ty</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">tb</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sock</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 클래스의 주요 기능은 네트워크 연결을 표현하는 것이지만, 처음에는 아무런 작업을 하지 않는다.(예: 실제 연결 등)</li>
<li>그 대신 연결은 with 구문에서 이루어짐(요구에 의해)</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [57]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">partial</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [58]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">conn</span> <span class="o">=</span> <span class="n">LazyConnection</span><span class="p">((</span><span class="s1">'www.python.org'</span><span class="p">,</span> <span class="mi">80</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [68]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 연결 종료</span>
<span class="k">with</span> <span class="n">conn</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
    <span class="c1"># conn.__enter__() 실행: 연결</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">b</span><span class="s1">'GET /index.html HTTP/1.0</span><span class="se">\r\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">b</span><span class="s1">'Host: www.python.org</span><span class="se">\r\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">b</span><span class="s1">'</span><span class="se">\r\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">resp</span> <span class="o">=</span> <span class="n">b</span><span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">,</span> <span class="mi">8192</span><span class="p">),</span> <span class="n">b</span><span class="s1">''</span><span class="p">))</span>
    <span class="c1"># conn.__exit__() 실행: 연결 종료</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Got </span><span class="si">%d</span><span class="s1"> bytes'</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">resp</span><span class="p">))</span>
    <span class="kn">from</span> <span class="nn">pprint</span> <span class="k">import</span> <span class="n">pprint</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">b</span><span class="s1">'</span><span class="se">\r\n</span><span class="s1">'</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Got 352 bytes
[b'HTTP/1.1 301 Moved Permanently',
 b'Server: Varnish',
 b'Retry-After: 0',
 b'Location: https://www.python.org/index.html',
 b'Content-Length: 0',
 b'Accept-Ranges: bytes',
 b'Date: Thu, 09 Oct 2014 08:50:53 GMT',
 b'Via: 1.1 varnish',
 b'Connection: close',
 b'X-Served-By: cache-ty66-TYO',
 b'X-Cache: MISS',
 b'X-Cache-Hits: 0',
 b'Strict-Transport-Security: max-age=63072000; includeSubDomains',
 b'',
 b'']
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>콘텍스트 매니저를 작성할 때 중요한 원리는 <strong>with 구문을 사용</strong>하여 <strong>정의된 블록을 감싸는 코드를 작성한다는 것</strong>
</li>
<li>처음으로 with를 만나면 __enter__() 메소드가 호출됨</li>
<li>__enter__()의 반환값은 as로 나타낸 변수에 위치시킴</li>
<li>그 후에 with의 내부 명령어를 실행하고 마지막으로 __exit__() 메소드로 소거 작업</li>
</ul>
<ul>
<li>이 흐름은 with문 내부에서 어떤 일이 발생하는지와 상관없이 일어나고, 예외가 발생한다 해도 변함이 없음</li>
<li>사실 __exit__() 메소드의 3가지 인자에 <strong>예외 타입, 값, 트레이스백</strong>이 들어있다.</li>
<li>__exit__() 메소드는 예외 정보를 고르거나 아무일도 하지 않고 None을 반환하며 무시하는 방식을 선택할 수 있음</li>
<li>만약 __exit__()가 True를 반환하면 에러를 없애고 아무 일도 일어나지 않았던 것처럼 with 블록 다음의 프로그램을 계속해서 실행함</li>
</ul>
<ul>
<li>
<strong>with문을 여러 번 써서 중첩된 연결</strong>을 <strong>LazyConnection 클래스가 허용하는지 여부</strong>가 미묘한 측면</li>
<li>한 번에 하나의 소켓 연결만 허용되고 소켓을 사용 중에 중복된 with문이 나타나면 예외가 발생함</li>
<li>구현법을 조금만 바꾸면 이 제한을 피해 갈 수 있다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [74]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">socket</span> <span class="k">import</span> <span class="n">socket</span><span class="p">,</span> <span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span>

<span class="k">class</span> <span class="nc">LazyConnection</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">family</span><span class="o">=</span><span class="n">AF_INET</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="n">SOCK_STREAM</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">address</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">family</span> <span class="o">=</span> <span class="n">AF_INET</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">SOCK_STREAM</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connections</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">def</span> <span class="nf">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">family</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
        <span class="n">sock</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sock</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sock</span>
    
    <span class="k">def</span> <span class="nf">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_ty</span><span class="p">,</span> <span class="n">exc_val</span><span class="p">,</span> <span class="n">tb</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [75]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 사용 예제</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">partial</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [76]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">conn</span> <span class="o">=</span> <span class="n">LazyConnection</span><span class="p">((</span><span class="s1">'www.python.org'</span><span class="p">,</span> <span class="mi">80</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [77]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">conn</span> <span class="k">as</span> <span class="n">s1</span><span class="p">:</span>
    <span class="n">s1</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">b</span><span class="s1">'GET /index.html HTTP1.0</span><span class="se">\r\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">s1</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">b</span><span class="s1">'Host: www.python.org</span><span class="se">\r\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">s1</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">b</span><span class="s1">'</span><span class="se">\r\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">resp1</span> <span class="o">=</span> <span class="n">b</span><span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">s1</span><span class="o">.</span><span class="n">recv</span><span class="p">,</span> <span class="mi">8192</span><span class="p">),</span> <span class="n">b</span><span class="s1">''</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resp1</span><span class="p">))</span>
    <span class="k">with</span> <span class="n">conn</span> <span class="k">as</span> <span class="n">s2</span><span class="p">:</span>  
        <span class="n">s2</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">b</span><span class="s1">'GET /index.html HTTP1.0</span><span class="se">\r\n</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">s2</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">b</span><span class="s1">'Host: www.python.org</span><span class="se">\r\n</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">s2</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">b</span><span class="s1">'</span><span class="se">\r\n</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">resp2</span> <span class="o">=</span> <span class="n">b</span><span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">partial</span><span class="p">(</span><span class="n">s2</span><span class="o">.</span><span class="n">recv</span><span class="p">,</span> <span class="mi">8192</span><span class="p">),</span> <span class="n">b</span><span class="s1">''</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resp2</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>352
352
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>두번째 버전에서 LazyConnection 클래스는 연결을 위한 factory 역할을 함</li>
<li>내부적으로 스택을 위해 리스트 사용</li>
<li>__enter__()가 실행될 때마다, 새로운 연결을 만들고 스택에 추가함</li>
<li>__exit__() 메소드는 단순히 스택에서 마지막 연결을 꺼내고 닫는다</li>
<li>사소한 문제지만 이로 인해서 중첩 with 구문으로 연결을 여러 개 생성할 수 있음</li>
</ul>
<ul>
<li>콘택스트 매니저는 파일이나 네트워크 연결, 락 등의 자원을 관리할 때 프로그램에서 가장 일반적으로 사용함</li>
<li>이런 자원에서 가장 중요한 부분은 이들의 사용이 끝났을 때 확실히 닫거나 해제해야 한다는 점</li>
<li>
<strong>락을 취득했다면 사용을 마친 후 해제</strong>해야 한다. 이를 잊으면 데드락에 빠질 수 있음</li>
<li>__enter__(), __exit__()를 구현하고 with 문을 사용하면 __exit__() 메소드에서 <strong>뒤처리 코드의 실행을 보장</strong>하므로 <strong>이런 문제를 쉽게 피할</strong> 수 있음</li>
</ul>
<ul>
<li>콘텍스트 매니저의 대안을 contextmanager 모듈에서 찾을 수 있음</li>
<li>레시피 9.22 참고</li>
<li>스레드 환경에 안전한 버전이 필요하다면 레시피 12.6 참고</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="8.4-인스턴스를-많이-생성할-때-메모리-절약">8.4 인스턴스를 많이 생성할 때 메모리 절약<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#8.4-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4%EB%A5%BC-%EB%A7%8E%EC%9D%B4-%EC%83%9D%EC%84%B1%ED%95%A0-%EB%95%8C-%EB%A9%94%EB%AA%A8%EB%A6%AC-%EC%A0%88%EC%95%BD">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>프로그램에서 많은(예: 수백만) 인스턴스를 생성하고 메모리를 많이 소비</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>간단한 자료 구조 역할을 하는 클래스의 경우 __slots__ 속성을 클래스 정의에 추가하면 메모리 사용을 상당히 많이 절약 가능</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [78]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Date</span><span class="p">:</span>
    <span class="n">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'year'</span><span class="p">,</span> <span class="s1">'month'</span><span class="p">,</span> <span class="s1">'day'</span><span class="p">]</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">year</span> <span class="o">=</span> <span class="n">year</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">month</span> <span class="o">=</span> <span class="n">month</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">day</span> <span class="o">=</span> <span class="n">day</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>__slots__을 정의하면 파이썬은 인스턴스에서 <strong>훨씬 더 압축된 내부 표현식 사용</strong>
</li>
<li>인스턴스마다 딕셔너리를 구성하지 않고 튜플이나 리스트 같은 부피가 작은 고정 배열로 인스턴스가 만들어짐</li>
<li>__slots__ 명시자에 리스팅된 속성 이름은 내부적으로 이 배열의 특정 인덱스에 매핑됨</li>
<li>슬롯을 사용하는 데서 발생하는 부작용은 인스턴스에 새로운 속성을 추가할 수 없다는 점</li>
<li>__slots__ 명시자에 나열한 속성만 사용할 수 있다는 제약이 생김</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>슬롯을 사용해서 절약하는 메모리는 속성의 숫자와 타입에 따라 다름</li>
<li>하지만, 일반적으로 그 데이터를 튜플에 저장할 때의 메모리 사용과 비교할만하다.</li>
<li>Date 인스턴스 하나를 슬롯없이 저장하면, 64비트 파이썬에서 428 바이트를 소비함</li>
<li>만약 슬롯을 정의하면 메모리 사용은 156 바이트로 떨어짐</li>
<li>프로그램에서 만은 수의 날짜를 한 번에 다루어야 한다면 메모리를 상당히 많이 절약 가능</li>
</ul>
<ul>
<li>얼핏 생각하기에 슬롯을 사용하는 곳이 많을 것 같지만, 대개의 코드에서 슬롯 사용은 피하는 것이 좋음</li>
<li>파이썬에 일반 딕셔너리 기반 구현에 의존하는 부분이 많음</li>
<li>그리고 슬롯을 정의한 클래스는 다중 상속과 같은 특정 기능을 지원하지 않음</li>
<li>프로그램에서 자주 사용하는 자료 구조에만 슬롯 사용을 고려하는 것이 좋음(예: 특정 클래스에서 수백만 개의 인스턴스를 생성하는 경우)</li>
</ul>
<ul>
<li>__slots__을 인스턴스에 새로운 속성을 추가하지 못하도록 하는 캡슐화 도구로 오해하는 경우가 많음</li>
<li>슬롯을 사용했을 때 이런 현상이 생기기는 하지만 원래 이런 용도로 디자인한 것은 아니다.</li>
<li>__slots__은 항상 최적화 도구로만 사용해야 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="8.5-클래스-이름의-캡슐화">8.5 클래스 이름의 캡슐화<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#8.5-%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%9D%B4%EB%A6%84%EC%9D%98-%EC%BA%A1%EC%8A%90%ED%99%94">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>클래스 인스턴스의 private 데이터를 캡슐화하고 싶지만, 파이썬에는 접근 제어 기능이 부족</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>파이썬 프로그래머들은 언어의 기능에 의존하기보다는 데이터나 메소드의 이름에 특정 규칙을 사용하여서 의도를 나타냄</li>
<li>첫번째 규칙은 <strong>밑줄(_)</strong>로 시작하는 모든 이름은 <strong>내부 구현에서만 사용하도록 가정하는 것</strong>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [79]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># 내부 속성</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_internal</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># 공용 속성</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">public</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="k">def</span> <span class="nf">public_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">'''A public method'''</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">_internal_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>파이썬은 내부 이름에 누군가 접근하는 것을 실제로 막지는 않음</li>
<li>하지만 이런 시도는 무례한 것으로 간주되고 결국 허술한 코드가 됨</li>
<li>또한 이름 앞에 밑줄을 붙이는 것은 모듈 이름과 모듈 레벨 함수에도 사용함</li>
<li>예를 들어, 밑줄로 시작하는 모듈 이름을 발견한다면(예: _socket), 이는 <strong>내부 구현</strong>
</li>
<li>또한 sys._getframe()과 같은 모듈 레벨 함수는 사용할 때 매우 조심해야 함</li>
</ul>
<ul>
<li>클래스 정의에 밑줄 2 개(__)로 시작하는 이름이 나오기도 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [80]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">B</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__private</span> <span class="o">=</span> <span class="mi">0</span>
        
    <span class="k">def</span> <span class="nf">__private_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">public_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__private_method</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이름 앞에 밑줄을 2개 붙이면 이름이 다른 것으로 변한다.</li>
<li>더 구체적으로, 앞에 나온 클래스의 프라이빗 속성은 _B__private과 _B__private_method로 이름이 변함</li>
<li>그렇다면 이러한 이름의 변화는 어떤 의미를 가질까? 답은 바로 <strong>속성</strong>
</li>
<li>이런 속성은 속성을 통해 오버라이드 할 수 없다</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [81]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">B</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="c1"># B.__private를 오버라이드 하지 않는다.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__private</span> <span class="o">=</span> <span class="mi">1</span>
    
    <span class="c1"># B.__private_method()를 오버라이드 하지 않는다.</span>
    <span class="k">def</span> <span class="nf">__private_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>여기서 __private과 __private_method의 이름은 _C__private과 _C__private_method로 변하기 때문에 B 클래스의 이름과 겹치지 않음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>프라이빗 속성에 대한 규칙이 2가지 존재해서(밑줄 1개와 2개), 이 중 어떤 스타일을 써야 할지 의문이 들 수 있음</li>
<li>대개의 경우 공용이 아닌 이름은 밑줄을 하나만 붙여야 한다. 하지만 코드가 서브클래싱을 사용할 것이고 서브클래스에서 숨겨야 할 내부 속성이 있다면 밑줄을 2개 붙인다.</li>
<li>그리고 예약해 둔 단어 이름과 충돌하는 변수를 정의하고 싶을 때가 있음. 이런 경우 이름 뒤에 밑줄을 하나 붙인다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [82]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># lambda 키워드와의 충돌을 피하기 위해 밑줄을 붙인다.</span>
<span class="n">lambda_</span> <span class="o">=</span> <span class="mf">2.0</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>밑줄을 변수 이름 앞에 붙이지 않는 이유는 내부적으로 사용하는 의도와의 혼동을 피하기 위해서임</li>
<li>변수 이름 뒤에 밑줄을 하나 붙여서 이 문제를 해결함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="8.6-관리-속성-만들기">8.6 관리 속성 만들기<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#8.6-%EA%B4%80%EB%A6%AC-%EC%86%8D%EC%84%B1-%EB%A7%8C%EB%93%A4%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>인스턴스 속성을 얻거나 설정할 때 추가적인 처리(타입 체크, 검증 등)를 하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>속성에 대한 접근을 조절하고 싶으면 property로 정의하면 됨</li>
<li>예를 들어 다음 코드는 속성에 간단한 타입 체크를 추가하는 프로퍼티를 정의함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [83]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Person</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_name</span><span class="p">):</span>
        <span class="c1"># 이 속성을 삭제하면 안되네.</span>
        <span class="c1"># 이 속성을 기반으로 메소드를 property로 변경해 사용하는것 같다.</span>
        <span class="c1"># 파이참에서 디버깅 한 결론라고 생각했었다!</span>
        <span class="c1"># self._first_name = first_name 으로 해도 되네. 그런데 이렇게 하면</span>
        <span class="c1"># init 함수에서 바로 클래스 변수 생성되고 돌아가지만 self.first_name 으로 하면</span>
        <span class="c1"># setter 함수가 불려지기 때문에 인스턴스를 만들때도 타입 체크가 가능!!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_name</span> <span class="o">=</span> <span class="n">first_name</span>
    
    <span class="c1"># 게터 함수</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">first_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_name</span>
    
    <span class="c1"># 세터 함수</span>
    <span class="nd">@first_name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">first_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">'Expected a string'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_first_name</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="c1"># 딜리터 함수(옵션)</span>
    <span class="nd">@first_name</span><span class="o">.</span><span class="n">deleter</span>
    <span class="k">def</span> <span class="nf">first_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">"Can't delete attribute"</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>관련 메소드가 3개 있는데, <strong>모두 같은 이름</strong>을 가져야 함</li>
<li>첫번째 메소드: getter 함수, first_name을 프로퍼티로 만듦</li>
<li>다른 2 메소드는 추가적으로 setter와 deleter 함수를 first_name 프로퍼티에 추가함</li>
<li>여기서 @first_name.setter와 @first_name.deleter 데코레이터는 <strong>@property를 사용</strong>해서 <strong>first_name을 만들어 놓지 않으면 정의되지 않는 점이 중요</strong>
</li>
<li>프로퍼티의 중요 기능으로 일반적인 속성으로 보이지 않는다는 점</li>
<li>여기에 접근하면 자동으로 게터, 세터, 딜리터 메소드가 자동으로 실행됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="s1">'Guido'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [85]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Getter</span>
<span class="n">a</span><span class="o">.</span><span class="n">first_name</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[85]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'Guido'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [86]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Setter</span>
<span class="n">a</span><span class="o">.</span><span class="n">first_name</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-86-73dafed1e4ef&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>a<span class="ansi-blue-fg">.</span>first_name <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">42</span>

<span class="ansi-green-fg">&lt;ipython-input-83-46ceb9a1909e&gt;</span> in <span class="ansi-cyan-fg">first_name</span><span class="ansi-blue-fg">(self, value)</span>
<span class="ansi-green-intense-fg ansi-bold">     12</span>     <span class="ansi-green-fg">def</span> first_name<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> value<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> isinstance<span class="ansi-blue-fg">(</span>value<span class="ansi-blue-fg">,</span> str<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 14</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> TypeError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'Expected a string'</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span>         self<span class="ansi-blue-fg">.</span>_first_name <span class="ansi-blue-fg">=</span> value
<span class="ansi-green-intense-fg ansi-bold">     16</span> 

<span class="ansi-red-fg">TypeError</span>: Expected a string</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [87]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">first_name</span> <span class="o">=</span> <span class="s1">'geun young'</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [88]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">first_name</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[88]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'geun young'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [89]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">a</span><span class="o">.</span><span class="n">first_name</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-89-155a1abee7c3&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">del</span> a<span class="ansi-blue-fg">.</span>first_name

<span class="ansi-green-fg">&lt;ipython-input-83-46ceb9a1909e&gt;</span> in <span class="ansi-cyan-fg">first_name</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">     18</span>     <span class="ansi-blue-fg">@</span>first_name<span class="ansi-blue-fg">.</span>deleter
<span class="ansi-green-intense-fg ansi-bold">     19</span>     <span class="ansi-green-fg">def</span> first_name<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 20</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">raise</span> AttributeError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">"Can't delete attribute"</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">AttributeError</span>: Can't delete attribute</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>프로퍼티를 구현할 때, 기반 데이터가 있다면 여전히 어딘가에 저장해야 함</li>
<li>따라서 게터, 세터 메소드에서 _first_name 속성을 직접 다루는 것을 볼 수 있는데, 여기에 실제 데이터가 들어감</li>
<li>그리고 왜 __init__() 에서 self._first_name 이 아닌 self.first_name을 설정하는 이유가 무엇인지 의문이 생길 수 있음</li>
<li>이번 예제에서 프로퍼티의 모든 포인트는 <strong>속성에 type checking을 적용하는 것</strong>에 집중하는 것</li>
<li>따라서 초기화를 할 때도 이것을 확인하고 싶을 확률이 있다.</li>
<li>self.first_name을 설정하면, 설정 연산이 세터 메소드를 사용한다(self._first_name에 접근하여 우회하는 것과는 대조적)</li>
<li>이미 존재하는 get과 set 메소드로 프로퍼티를 정의할 수도 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [121]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Person</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_first_name</span><span class="p">(</span><span class="n">first_name</span><span class="p">)</span>
        
    <span class="c1"># 게터 함수</span>
    <span class="k">def</span> <span class="nf">get_first_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_name</span>
    
    <span class="c1"># 세터 함수</span>
    <span class="k">def</span> <span class="nf">set_first_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">'Expected a string'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_first_name</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="c1"># 딜리터 함수(옵션)</span>
    <span class="k">def</span> <span class="nf">del_first_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">"Can't delete attribute"</span><span class="p">)</span>
        
    <span class="c1"># 기존 게터/세터 메소드로 프로퍼티 만들기</span>
    <span class="c1"># name -&gt; first_name</span>
    <span class="n">first_name</span> <span class="o">=</span> <span class="nb">property</span><span class="p">(</span><span class="n">get_first_name</span><span class="p">,</span> <span class="n">set_first_name</span><span class="p">,</span> <span class="n">del_first_name</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>사실 <strong>프로퍼티 속성</strong>은 <strong>함께 묶여 있는 메소드 컬렉션</strong>
</li>
<li>프로퍼티가 있는 클래스를 조사해 보면 프로퍼티 자체의 fget, fset, fdel 속성에서 raw 메소드를 찾을 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [104]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Person</span><span class="o">.</span><span class="n">first_name</span><span class="o">.</span><span class="n">fget</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[104]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;function __main__.Person.get_first_name&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [106]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Person</span><span class="o">.</span><span class="n">first_name</span><span class="o">.</span><span class="n">fset</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[106]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;function __main__.Person.set_first_name&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [107]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Person</span><span class="o">.</span><span class="n">first_name</span><span class="o">.</span><span class="n">fdel</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[107]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;function __main__.Person.del_first_name&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>일반적으로 fget 이나 fset을 직접 호출하지는 않고, 프로퍼티에 접근할 때 자동으로 실행 됨</li>
<li>프로퍼티는 속성에 추가적인 처리가 필요할 때만 사용해야 함</li>
<li>Java 등에 익숙한 프로그래머는 클래스 속성에 접근할 때 무조건 게터, 세터를 사용해야 한다고 생각하고 다음과 같은 코드를 작성함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [127]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Person2</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_name</span> <span class="o">=</span> <span class="n">first_name</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">first_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_name</span>
    
    <span class="nd">@first_name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">first_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_first_name</span> <span class="o">=</span> <span class="n">value</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<p>하지만 앞에 나온 코드는 좋지 않다.
우선 남들이 보기에 불필요하게 장황하고 이해하기 어렵다.</p>
</li>
<li>
<p>그리고 프로그램의 실행 속도도 떨어짐</p>
</li>
<li>
<p>마지막으로, 디자인 측면에서도 아무런 이득이 없음</p>
</li>
<li>
<p>특히 추후에 속성에 추가적인 처리가 필요하다고 판단했을 때 기존 코들르 수정하지 않고 프로퍼티로 쉽게 변환 가능</p>
</li>
<li>
<p>왜냐하면 속성에 접근하는 코드의 구문을 수정하면 안되기 때문</p>
</li>
<li>
<p>프로퍼티는 계산한 속성을 정의할 때 사용함</p>
</li>
<li>
<p>이런 속성은 실제로 저장하지는 않지만 필요에 따라 계산함</p>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [109]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="k">class</span> <span class="nc">Circle</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">**</span> <span class="mi">2</span>
    
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">perimeter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>앞에 나온 프로퍼티를 사용하면 radius, area, perimeter가 마치 속성인 것처럼 접근 가능</li>
<li>
<strong>속성과 메소드 호출</strong>을 <strong>복합적으로 사용하는 것과는 대조적</strong>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [115]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [116]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">radius</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[116]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>4.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [117]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># ()가 쓰이지 않았다.</span>
<span class="n">c</span><span class="o">.</span><span class="n">area</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[117]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>50.26548245743669</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [119]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">area</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-119-ba17805bb787&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>c<span class="ansi-blue-fg">.</span>area<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">TypeError</span>: 'float' object is not callable</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [118]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># ()가 쓰이지 않았다.</span>
<span class="n">c</span><span class="o">.</span><span class="n">perimeter</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[118]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>25.132741228718345</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>프로퍼티로 우아한 프로그래밍 인터페이스를 얻을 수 있지만, 게터와 세터 함수를 직접 사용하는 것도 가능</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [130]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Person</span><span class="p">(</span><span class="s1">'Guido'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [131]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">get_first_name</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[131]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'Guido'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [132]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">set_first_name</span><span class="p">(</span><span class="s1">'Larry'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [133]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">get_first_name</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[133]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'Larry'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>시스템 프로그램과 같은 거대 구조에 파이썬 코드를 통합할 때 이럴 필요성이 있음</li>
<li>파이썬 클래스를 원격 절차 호출이나 분산 객체에 기반한 방대한 분산 시스템에 넣기도 함</li>
<li>이런 경우 명시적으로 게터/세터 메소드를 일반적인 메소드처럼 직접 호출하는 것이 프로퍼티 사용보다 훨씬 이해하기 쉽다.</li>
</ul>
<ul>
<li>마지막으로, 프로퍼티 정의를 반복적으로 사용하는 파이썬 코드를 작성하지 않도록 주의</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [134]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Person</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">first_name</span><span class="p">,</span> <span class="n">last_name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">first_name</span> <span class="o">=</span> <span class="n">first_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_name</span> <span class="o">=</span> <span class="n">last_name</span>
        
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">first_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_name</span>
    
    <span class="nd">@first_name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">first_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">'Expected a string'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_first_name</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="c1"># 이름이 다른 프로퍼티 코드의 반복(좋지 않다!)</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">last_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_name</span>
    
    <span class="nd">@last_name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">last_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">'Expected a stirng'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_name</span> <span class="o">=</span> <span class="n">value</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>코드를 반복하면 보기 좋지 않고 에러가 발생하기도 쉬움</li>
<li>동일한 동작성은 디스크립터나 클로저로도 얻을 수 있음. 레시피 8.9와 9.21을 참고</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="8.7-부모-클래스의-메소드-호출">8.7 부모 클래스의 메소드 호출<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#8.7-%EB%B6%80%EB%AA%A8-%ED%81%B4%EB%9E%98%EC%8A%A4%EC%9D%98-%EB%A9%94%EC%86%8C%EB%93%9C-%ED%98%B8%EC%B6%9C">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>오버라이드된 서브클래스 메소드가 아닌 부모 클래스에 있는 메소드를 호출하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>부모(혹은 슈퍼클래스)의 메소드를 호출하려면 super() 함수를 사용함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [143]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">spam</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'A.spam'</span><span class="p">)</span>
        
<span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">spam</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'B.spam'</span><span class="p">)</span>
        <span class="c1"># 부모의 spam() 호출</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">spam</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [145]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="p">()</span>
<span class="n">b</span><span class="o">.</span><span class="n">spam</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>B.spam
A.spam
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>super()는 일반적으로 __init__() 메소드에서 부모를 제대로 초기화하기 위해 사용함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [149]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
        
<span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [151]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">B</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>0
0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>그리고 파이썬의 특별 메소드를 오버라이드한 코드에서 super()를 사용하기도 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [152]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Proxy</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_obj</span> <span class="o">=</span> <span class="n">obj</span>
        
    <span class="c1"># 내부 obj를 위해 delegate 속성 찾기</span>
    <span class="k">def</span> <span class="nf">__getattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        
    <span class="c1"># delegate 속성 할당</span>
    <span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">'_'</span><span class="p">):</span>
            <span class="c1"># 원본 __setattr__ 호출</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_obj</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 코드에서, __setattr__() 구현에 이름 확인이 들어있음</li>
<li>만약 이름이 밑줄로 시작하면 super()를 사용해서 __setattr__()의 원래 구현을 호출함</li>
<li>그렇지 않다면 내부 객체인 self._obj를 부른다. 조금 이상하게 보일지도 모르겠지만, 명시적으로 클래스를 표시하지 않아도 super()가 동작함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>super() 함수를 올바르게 사용하기는 무척 어려움</li>
<li>때때로 부모 클래스 메소드를 직접 호출하기 위해 다음과 같이 작성한 코드를 볼 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [157]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Base</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Base.__init__'</span><span class="p">)</span>
        
<span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Base</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'A.__init__'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [158]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Base.__init__
A.__init__
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>앞에 나오는 코드가 대부분의 경우 '동작하기'는 하지만, 다중 상속과 같은 상황에서 문제가 발생</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [161]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Base</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Base.__init__'</span><span class="p">)</span>
        
<span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Base</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'A.__init__'</span><span class="p">)</span>
        
<span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Base</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'B.__init__'</span><span class="p">)</span>
        
<span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">A</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">B</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'C.__init__'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 코드를 실행하면 Base.__init__() 메소드가 2번 호출됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [162]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Base.__init__
A.__init__
Base.__init__
B.__init__
C.__init__
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Base.__init__()을 2 번 호출하는 것이 문제가 없을 수도 있지만, 항상 그렇지만은 않다.</li>
<li>하지만 super()를 사용하여 코들르 수정한다면 올바르게 동작함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [173]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Base</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Base.__init__'</span><span class="p">)</span>
        
<span class="k">class</span> <span class="nc">A</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'A.__init__'</span><span class="p">)</span>
        
<span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'B.__init__'</span><span class="p">)</span>
        
<span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># super()로 실행해서 상위 클래스 한 번 찾아주고</span>
        <span class="c1"># __init__()로 초기화 진행</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">()</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'C.__init__'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이번 버전을 사용하면 모든 __init__() 메소드가 한 번씩만 호출됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [175]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Base.__init__
B.__init__
A.__init__
C.__init__
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>
<strong>왜 이런 차이점이 생기는지 이해</strong>하려면, <strong>파이썬의 상속 구현</strong>을 먼저 <strong>이해</strong>해야 한다.</li>
<li>클래스를 정의할 때마다 파이썬읜 <strong>method resolution order</strong>, MRO 리스트를 계산한다.</li>
<li>MRO 리스트는 <strong>모든 베이스 클래스를 단순히 순차적으로 나열한 리스트</strong>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [176]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">C</span><span class="o">.</span><span class="n">__mro__</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[176]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>(__main__.C, __main__.A, __main__.B, __main__.Base, object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>상속 구현을 위해 파이썬은 가장 왼쪽에 있는 클래스에서 시작해서 MRO 리스트의 오른쪽으로 이동하며 일차하는 속성을 찾아냄</li>
<li>MRO 리스트 자체를 실제로 결정할 때는 C3 선형화(C3 Linearization)라는 기술을 사용함</li>
<li>너무 계산이 복잡해지지 않도록 부모 클래스의 MRO를 다음 3가지 제약 조건 하에서 merge sort 한다.</li>
</ul>
<ol>
<li>자식 클래스를 부모보다 먼저 확인한다.</li>
<li>부모 클래스가 2 이상이면 리스팅한 순서대로 확인한다.</li>
<li>유효한 후보가 2가지 있으면, 첫번째 부모 클래스부터 선택한다.</li>
</ol>
<ul>
<li>사실 정말로 알고 있어야 하는 것은 MRO 리스트의 클래스 순서가 정의하려는 거의 모든 클래스 구조에 <strong>의미가 통해야</strong> 한다는 점</li>
<li>super() 함수를 사용할 때, 파이썬은 MRO의 다음 클래스에서 검색을 시작함</li>
<li>재정의한 모든 메소드가 모두 super()를 사용하고 한 번만 호출하지만, <strong>시스템은 MRO 리스트 전체에 동작하고 모든 메소드는 한 번만 호출</strong>된다. 바로 이 때문에 <strong>2번째 예제의 Base.__init__이 2번 호출되지 않는 것</strong>
</li>
<li>super()의 놀라운 측면 중 하나는 이 함수가 MRO의 바로 위에 있는 부모에 직접 접근하지 않을 때도 있고, 직접적인 부모 클래스가 없을 때도 super()를 사용할 수 있다는 점</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [177]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">spam</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'A.spam'</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">spam</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>앞에 나온 클래스를 사용하면 다음과 같이 에러 메시지가 발생</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [178]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [179]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">spam</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>A.spam
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-179-dae5826e83b9&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>a<span class="ansi-blue-fg">.</span>spam<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-177-66ac0b602197&gt;</span> in <span class="ansi-cyan-fg">spam</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span>     <span class="ansi-green-fg">def</span> spam<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span>         print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'A.spam'</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 4</span><span class="ansi-red-fg">         </span>super<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>spam<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">AttributeError</span>: 'super' object has no attribute 'spam'</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 클래스를 다중 상속에 사용하면 어떻게 되는지 확인해 보자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [181]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">B</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">spam</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'B.spam'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">C</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [182]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>
<span class="n">c</span><span class="o">.</span><span class="n">spam</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>A.spam
B.spam
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>A 클래스의 super().spam()이 실제로 A와는 전혀 관련없는 B 클래스의 spam()을 호출했다.</li>
<li>C 클래스의 MRO를 보면 이를 이해할 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [183]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">C</span><span class="o">.</span><span class="n">__mro__</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[183]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>(__main__.C, __main__.A, __main__.B, object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이런식으로 super()를 사용하는 것은 클래스를 복합적으로 사용할 때 일반적인 모습. 레시피 8.13과 8.18을 참고한다.</li>
</ul>
<ul>
<li>하지만, super()로 인해 원치않는 메소드가 호출되는 현상이 발생할 수도 있어 필자의 경험상 다음 규칙을 따르는 것이 좋다.</li>
</ul>
<ol>
<li>첫째로, 상속 관계에서 이름이 같은 모든 메소드는 동일한 구조를 가지도록 한다.(예: 같은 인자수, 같은 인자 이름). 이렇게 하면 super()가 직접적으로 부모가 아닌 클래스 메소드를 호출할 때 발생하는 실수를 방지할 수 있음</li>
<li>가장 상위에 있는 클래스에서 메소드 구현을 제공해서 MRO에서 검색을 할 때 결국은 실제 메소드 위에서 멈추도록 하는 것이 좋음</li>
</ol>
<ul>
<li>super()를 사용하는 것의 장단점은 파이썬 커뮤니티에서 종종 토론거리가 되곤 함</li>
<li>하지만 다른 모든 조건이 그대로라면, <strong>현대적인 코드</strong>에서 <strong>사용</strong>해야 한다.</li>
<li>Raymond Hettinger가 쓴 블로그 포스팅 <a href="http://rhettinger.wordpress.com/2011/05/26/super-considered-super/">Python's super() Considered Super!</a>에 더많은 예제와 super()가 왜 훌륭한지 자세한 설명이 나오니 참고</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="8.8-서브클래스에서-프로퍼티-확장">8.8 서브클래스에서 프로퍼티 확장<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#8.8-%EC%84%9C%EB%B8%8C%ED%81%B4%EB%9E%98%EC%8A%A4%EC%97%90%EC%84%9C-%ED%94%84%EB%A1%9C%ED%8D%BC%ED%8B%B0-%ED%99%95%EC%9E%A5">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>서브클래스에서, 부모 클래스에서 정의한 프로퍼티의 기능을 확장하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>프로퍼티 정의 코드</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [197]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Person</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        
    <span class="c1"># 게터 함수</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_name</span>
    
    <span class="c1"># 세터 함수</span>
    <span class="nd">@name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">'Expected a string'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="c1"># 딜리터 함수</span>
    <span class="nd">@name</span><span class="o">.</span><span class="n">deleter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">"Can't delete attribute"</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>다음 코드는 Person을 상속 받아 name 프로퍼티에 새로운 기능을 넣어 클래스를 확장함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [185]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">SubPerson</span><span class="p">(</span><span class="n">Person</span><span class="p">):</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Getting name'</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">name</span>
    
    <span class="nd">@name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Setting name to'</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SubPerson</span><span class="p">,</span> <span class="n">SubPerson</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        
    <span class="nd">@name</span><span class="o">.</span><span class="n">deleter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Deleting name'</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SubPerson</span><span class="p">,</span> <span class="n">SubPerson</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">__delete__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>다음은 새로운 클래스를 사용하는 예제</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [186]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">SubPerson</span><span class="p">(</span><span class="s1">'Guido'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Setting name to Guido
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [187]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">name</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Getting name
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt output_prompt">Out[187]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'Guido'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [189]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'Larry'</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Setting name to Larry
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [190]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Setting name to 42
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-190-507a39ad0510&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>s<span class="ansi-blue-fg">.</span>name <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">42</span>

<span class="ansi-green-fg">&lt;ipython-input-185-58c6329a9892&gt;</span> in <span class="ansi-cyan-fg">name</span><span class="ansi-blue-fg">(self, value)</span>
<span class="ansi-green-intense-fg ansi-bold">      8</span>     <span class="ansi-green-fg">def</span> name<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> value<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      9</span>         print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'Setting name to'</span><span class="ansi-blue-fg">,</span> value<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 10</span><span class="ansi-red-fg">         </span>super<span class="ansi-blue-fg">(</span>SubPerson<span class="ansi-blue-fg">,</span> SubPerson<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>name<span class="ansi-blue-fg">.</span>__set__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> value<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     11</span> 
<span class="ansi-green-intense-fg ansi-bold">     12</span>     <span class="ansi-blue-fg">@</span>name<span class="ansi-blue-fg">.</span>deleter

<span class="ansi-green-fg">&lt;ipython-input-184-d7db69b108a2&gt;</span> in <span class="ansi-cyan-fg">name</span><span class="ansi-blue-fg">(self, value)</span>
<span class="ansi-green-intense-fg ansi-bold">     12</span>     <span class="ansi-green-fg">def</span> name<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> value<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> isinstance<span class="ansi-blue-fg">(</span>value<span class="ansi-blue-fg">,</span> str<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 14</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> TypeError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'Expected a string'</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span>         self<span class="ansi-blue-fg">.</span>_name <span class="ansi-blue-fg">=</span> value
<span class="ansi-green-intense-fg ansi-bold">     16</span> 

<span class="ansi-red-fg">TypeError</span>: Expected a string</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>프로퍼티의 메소드 하나를 확장하고 싶으면 다음과 같은 코드를 사용</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [191]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">SubPerson</span><span class="p">(</span><span class="n">Person</span><span class="p">):</span>
    <span class="nd">@Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">getter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Getting name'</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">name</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>혹은 setter 하나만 확장하려면 다음과 같이 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [192]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">SubPerson</span><span class="p">(</span><span class="n">Person</span><span class="p">):</span>
    <span class="nd">@Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Setting name to'</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SubPerson</span><span class="p">,</span> <span class="n">SubPerson</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [193]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="nb">super</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Help on class super in module builtins:

class super(object)
 |  super() -&gt; same as super(__class__, &lt;first argument&gt;)
 |  super(type) -&gt; unbound super object
 |  super(type, obj) -&gt; bound super object; requires isinstance(obj, type)
 |  super(type, type2) -&gt; bound super object; requires issubclass(type2, type)
 |  Typical use to call a cooperative superclass method:
 |  class C(B):
 |      def meth(self, arg):
 |          super().meth(arg)
 |  This works for class methods too:
 |  class C(B):
 |      @classmethod
 |      def cmeth(cls, arg):
 |          super().cmeth(arg)
 |  
 |  Methods defined here:
 |  
 |  __get__(self, instance, owner, /)
 |      Return an attribute of instance, which is of type owner.
 |  
 |  __getattribute__(self, name, /)
 |      Return getattr(self, name).
 |  
 |  __init__(self, /, *args, **kwargs)
 |      Initialize self.  See help(type(self)) for accurate signature.
 |  
 |  __new__(*args, **kwargs) from builtins.type
 |      Create and return a new object.  See help(type) for accurate signature.
 |  
 |  __repr__(self, /)
 |      Return repr(self).
 |  
 |  ----------------------------------------------------------------------
 |  Data descriptors defined here:
 |  
 |  __self__
 |      the instance invoking super(); may be None
 |  
 |  __self_class__
 |      the type of the instance invoking super(); may be None
 |  
 |  __thisclass__
 |      the class invoking super()

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>서브클래스의 프로퍼티를 확장하면 프로퍼티가 하나의 메소드가 아닌 게터, 세터, 딜리터 메소드의 컬렉션으로 정의되었다는 사실로 인해 자잘한 문제가 발생한다. 따라서 프로퍼티를 확장할 때 <strong>모든 메서드를 다시 정의</strong>할지, <strong>메소드 하나만 다시 정의</strong>할지 결정해야 함</li>
<li>첫번째 예제에서는 모든 메서드를 재정의했다. 모든 메소드에서 기존 구현을 호출하기 위해 super()를 사용했다. </li>
<li>세터 함수에서 사용한 super(SubPerson, SubPerson).name.__set__(self, value)는 실수가 아니다.</li>
<li>세터의 기존 구현으로 delegate 하기 위해서, 컨트롤은 기존에 구현한 name 프로퍼티의 __set__() 메소드로 전달해야 함</li>
<li>하지만, 이 메소드에 도달하기 위한 유일한 방법은 인스턴스 변수가 아닌 <strong>클래스 변수로 접근하는 것</strong>
</li>
<li>바로 이 내용이 super(SubPerson, SubPerson)에서 수행된 것</li>
<li>메소드 중 하나만 재정의하려면 @property 자체만 사용하는 것으로는 충분하지 않다. 예를 들어 다음 코드는 동작하지 않음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [194]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">SubPerson</span><span class="p">(</span><span class="n">Person</span><span class="p">):</span>
    <span class="nd">@property</span> <span class="c1"># 동작하지 않음</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Getting name'</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">name</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 코드를 사용하려고 하면 세터 함수가 모두 사라진 것을 확인하게 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [195]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">SubPerson</span><span class="p">(</span><span class="s1">'Guido'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-195-076a286300e8&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>s <span class="ansi-blue-fg">=</span> SubPerson<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'Guido'</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-184-d7db69b108a2&gt;</span> in <span class="ansi-cyan-fg">__init__</span><span class="ansi-blue-fg">(self, name)</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-green-fg">class</span> Person<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span>     <span class="ansi-green-fg">def</span> __init__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">----&gt; 3</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>name <span class="ansi-blue-fg">=</span> name
<span class="ansi-green-intense-fg ansi-bold">      4</span> 
<span class="ansi-green-intense-fg ansi-bold">      5</span>     <span class="ansi-red-fg"># 게터 함수</span>

<span class="ansi-red-fg">AttributeError</span>: can't set attribute</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>코드에 나왔던 것처럼 수정해야 한다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [199]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">SubPerson</span><span class="p">(</span><span class="n">Person</span><span class="p">):</span>
    <span class="c1"># 책에 .name. 이 빠져있다.</span>
    <span class="nd">@Person</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">getter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Getting name'</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">name</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이렇게 하면, <strong>기존에 정의한 모든 프로퍼티 메소드가 복사</strong>되고 <strong>게터 함수가 치환</strong>됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [200]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">SubPerson</span><span class="p">(</span><span class="s1">'Guido'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [201]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">name</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Getting name
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt output_prompt">Out[201]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'Guido'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [202]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'Larry'</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [204]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">name</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Getting name
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt output_prompt">Out[204]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'Larry'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [205]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-205-507a39ad0510&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>s<span class="ansi-blue-fg">.</span>name <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">42</span>

<span class="ansi-green-fg">&lt;ipython-input-197-d7db69b108a2&gt;</span> in <span class="ansi-cyan-fg">name</span><span class="ansi-blue-fg">(self, value)</span>
<span class="ansi-green-intense-fg ansi-bold">     12</span>     <span class="ansi-green-fg">def</span> name<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> value<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> isinstance<span class="ansi-blue-fg">(</span>value<span class="ansi-blue-fg">,</span> str<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 14</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> TypeError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'Expected a string'</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span>         self<span class="ansi-blue-fg">.</span>_name <span class="ansi-blue-fg">=</span> value
<span class="ansi-green-intense-fg ansi-bold">     16</span> 

<span class="ansi-red-fg">TypeError</span>: Expected a string</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 해결책으로는 하드코딩된 클래스 이름 Person을 좀 더 generic 한 것으로 치환할 방법이 없음</li>
<li>어떤 베이스 클래스가 프로퍼티를 정의했는지 모른다면 모든 프로퍼티 메소드를 재정의하고 super()로 기존 구현에 컨트롤을 전달하는 방식을 사용해야 함</li>
<li>레시피 8.9에 나온 것처럼 이번 레시피에 나온 첫 번째 기술을 디스크립터를 확장하는 데 사용할 수도 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [206]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 디스크립터</span>
<span class="k">class</span> <span class="nc">String</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        
    <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">cls</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">return</span> <span class="n">instance</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
    
    <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">'Expected a string'</span><span class="p">)</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        
<span class="c1"># 디스크립터를 가진 클래스</span>
<span class="k">class</span> <span class="nc">Person</span><span class="p">:</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">String</span><span class="p">(</span><span class="s1">'name'</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        
<span class="c1"># 디스크립터에 프로퍼티를 넣어 확장</span>
<span class="k">class</span> <span class="nc">SubPerson</span><span class="p">(</span><span class="n">Person</span><span class="p">):</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Getting name'</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">name</span>
    
    <span class="nd">@name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Setting name to'</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SubPerson</span><span class="p">,</span> <span class="n">SubPerson</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        
    <span class="nd">@name</span><span class="o">.</span><span class="n">deleter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Deleting name'</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SubPerson</span><span class="p">,</span> <span class="n">SubPerson</span><span class="p">)</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">__delete__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [207]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">SubPerson</span><span class="p">(</span><span class="s1">'Guido'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Setting name to Guido
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [208]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">name</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Getting name
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt output_prompt">Out[208]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'Guido'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [209]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">'Larry'</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Setting name to Larry
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [210]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">name</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Getting name
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt output_prompt">Out[210]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'Larry'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [211]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Setting name to 42
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-211-507a39ad0510&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>s<span class="ansi-blue-fg">.</span>name <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">42</span>

<span class="ansi-green-fg">&lt;ipython-input-206-7bba40ec712b&gt;</span> in <span class="ansi-cyan-fg">name</span><span class="ansi-blue-fg">(self, value)</span>
<span class="ansi-green-intense-fg ansi-bold">     30</span>     <span class="ansi-green-fg">def</span> name<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> value<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     31</span>         print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'Setting name to'</span><span class="ansi-blue-fg">,</span> value<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 32</span><span class="ansi-red-fg">         </span>super<span class="ansi-blue-fg">(</span>SubPerson<span class="ansi-blue-fg">,</span> SubPerson<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>name<span class="ansi-blue-fg">.</span>__set__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> value<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     33</span> 
<span class="ansi-green-intense-fg ansi-bold">     34</span>     <span class="ansi-blue-fg">@</span>name<span class="ansi-blue-fg">.</span>deleter

<span class="ansi-green-fg">&lt;ipython-input-206-7bba40ec712b&gt;</span> in <span class="ansi-cyan-fg">__set__</span><span class="ansi-blue-fg">(self, instance, value)</span>
<span class="ansi-green-intense-fg ansi-bold">     11</span>     <span class="ansi-green-fg">def</span> __set__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> instance<span class="ansi-blue-fg">,</span> value<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     12</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> isinstance<span class="ansi-blue-fg">(</span>value<span class="ansi-blue-fg">,</span> str<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 13</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> TypeError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'Expected a string'</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     14</span>         instance<span class="ansi-blue-fg">.</span>__dict__<span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>name<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> value
<span class="ansi-green-intense-fg ansi-bold">     15</span> 

<span class="ansi-red-fg">TypeError</span>: Expected a string</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>마지막으로, 독자가 이 글을 읽고 있을 때쯤이면 세터와 딜리터 메소드를 서크를래싱하는 과정이 단순화되었을 수도 있다.</li>
<li>앞에 나온 해결책은 여전히 잘 동작할 테지만, 파이썬의 이슈 페이지에 보고된 버그가 최신 파이썬 버전에서 수정되었을지도 모른다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="8.9-새로운-클래스나-인스턴스-속성-만들기">8.9 새로운 클래스나 인스턴스 속성 만들기<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#8.9-%EC%83%88%EB%A1%9C%EC%9A%B4-%ED%81%B4%EB%9E%98%EC%8A%A4%EB%82%98-%EC%9D%B8%EC%8A%A4%ED%84%B4%EC%8A%A4-%EC%86%8D%EC%84%B1-%EB%A7%8C%EB%93%A4%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>타입 호가인 등과 같이 추가적 기능을 가진 새로운 종류의 인스턴스 속성을 만들고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>완전히 새로운 종류의 인스턴스 속성을 만들려면, 그 기능을 디스크립터 클래스 형태로 정의해야 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [221]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 타입을 확인하는 정수형 디스크립터 속성</span>
<span class="k">class</span> <span class="nc">Integer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        
    <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">cls</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">instance</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        
    <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">'Expected an int'</span><span class="p">)</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="k">def</span> <span class="nf">__delete__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
        <span class="k">del</span> <span class="n">instance</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>디스크립터는 3가지 중요한 속성 접근 명령(get, set, delete)을 특별 메소드 __get__(), __set__(), __delete__() 형식으로 구현한 클래스</li>
<li>이 메소드는 인스턴스를 입력으로 받는다. 그리고 인스턴스 기반 딕셔너리는 속성으로 만들어짐</li>
<li>디스크립터를 사용하려면, 디스크립터의 인스턴스는 클래스 정의에 클래스 변수로 들어가야 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [222]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="s1">'x'</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="s1">'y'</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이렇게 할 때, 디스크립터에 대한 모든 접근(예:x 또는 y)은 __get__(), __set__(), __delete__() 메소드를 사용</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [214]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [215]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Point.x.__get__(p, Point) 호출</span>
<span class="n">p</span><span class="o">.</span><span class="n">x</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[215]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [216]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Point.y.__set__(p, 5) 호출</span>
<span class="n">p</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="mi">5</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [217]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Point.x.__set__(p, 2.3) 호출</span>
<span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mf">2.3</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-217-ead4f2e85597&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># Point.x.__set__(p, 2.3) 호출</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>p<span class="ansi-blue-fg">.</span>x <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">2.3</span>

<span class="ansi-green-fg">&lt;ipython-input-212-9364f87214f7&gt;</span> in <span class="ansi-cyan-fg">__set__</span><span class="ansi-blue-fg">(self, instance, value)</span>
<span class="ansi-green-intense-fg ansi-bold">     12</span>     <span class="ansi-green-fg">def</span> __set__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> instance<span class="ansi-blue-fg">,</span> value<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     13</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> isinstance<span class="ansi-blue-fg">(</span>value<span class="ansi-blue-fg">,</span> int<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 14</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> TypeError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'Expected an int'</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span>         instance<span class="ansi-blue-fg">.</span>__dict__<span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>name<span class="ansi-blue-fg">]</span> <span class="ansi-blue-fg">=</span> value
<span class="ansi-green-intense-fg ansi-bold">     16</span> 

<span class="ansi-red-fg">TypeError</span>: Expected an int</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>입력으로, 디스크립터의 모든 메소드는 가공중인 인스턴스를 받음</li>
<li>요청받은 작업을 수행하기 위해서, 인스턴스 딕셔너리(__dict__ 속성) 역시 적절히 처리됨</li>
<li>디스크립터의 self.name 속성은 실제 데이터를 인스턴스 딕셔너리에 저장할 때 사용하는 딕셔너리 키를 가지고 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>디스크립터는 파이썬 클래스 기능에 __slots__, @classmethod, @staticmethod, @property 와 멋진 도구를 제공</li>
<li>디스크립터를 정의하면 get, set, delete 와 같이 중요한 인스턴스 연산을 아주 하위 레벨에서 얻고 어떻게 동작할지도 입맛대로 바꿀 수 있음</li>
<li>따라서 고급 라이브러리와 프레임워크를 작성하는 프로그래머에게 매우 중요한 도구가 됨</li>
<li>디스크립터에 대한 한 가지 헷갈리는 부분은 인스턴스 기반이 아닌 클래스 레벨에서만 정의가 가능하다는 것</li>
<li>따라서 다음과 같은 코드는 동작하지 않음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [218]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 동작하지 않음</span>
<span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="c1"># 안 된다. 반드시 클래스 변수여야 한다.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="s1">'x'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">Integer</span><span class="p">(</span><span class="s1">'y'</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>또한 __get__() 메소드를 구현하는 것도 보기보다 간단하지 않음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [219]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 타입을 확인하는 정수형 디스크립터 속성</span>
<span class="k">class</span> <span class="nc">Integer</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">cls</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">instance</span><span class="o">.</span><span class="n">__idct__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>__get__()이 조금 복잡해 보이는 이유는 인스턴스 변수와 클래스 변수를 구분해야 하기 때문</li>
<li>만약 디스크립터를 클래스 변수로 접근하면 instance 인자가 None이 됨</li>
<li>이 경우에는 디스크립터 자신을 반환하는 것이 일반적(물론 다른 처리를 해도 무방하다)</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [223]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [224]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Point.x.__get__(p, Point) 호출</span>
<span class="n">p</span><span class="o">.</span><span class="n">x</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[224]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [225]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Point.x__get__(None, Point) 호출</span>
<span class="n">Point</span><span class="o">.</span><span class="n">x</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[225]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;__main__.Integer at 0x104eadeb8&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>디스크립터는 데코레이터나 메타클래스가 들어가는 거대한 프로그래밍 프레임워크의 한 가지 요소가 되곤 함</li>
<li>보통 디스크립터의 사용은 겉으로 드러나지 않아 사용자에게 보이지 않음</li>
<li>다음은 클래스 데코레이터를 사용하는 디스크립터 기반의 고급 코드</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [227]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 속성 타입을 확인하는 디스크립터</span>
<span class="k">class</span> <span class="nc">Typed</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">expected_type</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expected_type</span> <span class="o">=</span> <span class="n">expected_type</span>
        
    <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">cls</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">instance</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        
    <span class="k">def</span> <span class="nf">__set__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">expected_type</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">'Expected '</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">expected_type</span><span class="p">))</span>
        <span class="n">instance</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        
    <span class="k">def</span> <span class="nf">__delete__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">):</span>
        <span class="k">del</span> <span class="n">instance</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">]</span>
        
    
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [228]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 선택한 속성에 적용되는 클래스 데코레이터(decorator)</span>
<span class="k">def</span> <span class="nf">typeassert</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">decorate</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">expected_type</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># 클래스에 Typed 디스크립터 설정</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">Typed</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">expected_type</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">cls</span>
    <span class="k">return</span> <span class="n">decorate</span>

<span class="c1"># 사용 예</span>
<span class="nd">@typeassert</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">shares</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">price</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Stock</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">shares</span><span class="p">,</span> <span class="n">price</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shares</span> <span class="o">=</span> <span class="n">shares</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">price</span> <span class="o">=</span> <span class="n">price</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [230]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="nb">setattr</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Help on built-in function setattr in module builtins:

setattr(...)
    setattr(object, name, value)
    
    Set a named attribute on an object; setattr(x, 'y', v) is equivalent to
    ``x.y = v''.

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>마지막으로, <strong>특정 클래스의 한 속성에 대한 접근을 제어</strong>하기 위해서 <strong>디스크립터를 사용하지 말아야 한다는 점</strong>이 중요</li>
<li>이런 경우에는 레시피 8.6에 나왔던 것처럼 프로퍼티를 사용해야 함</li>
<li>디스크립터는 코드 재사용이 빈번히 발생하는 상황에 더 유용(예: 디스크립터가 제공하는 기능을 수백군데에서 사용해야 한다거나 라이브러리 기능으로 제공해야 하는 경우)</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="8.10-게으른-계산을-하는-프로퍼티-사용">8.10 게으른 계산을 하는 프로퍼티 사용<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#8.10-%EA%B2%8C%EC%9C%BC%EB%A5%B8-%EA%B3%84%EC%82%B0%EC%9D%84-%ED%95%98%EB%8A%94-%ED%94%84%EB%A1%9C%ED%8D%BC%ED%8B%B0-%EC%82%AC%EC%9A%A9">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>읽기 전용 속성을 프로퍼티로 정의하고, 이 속성에 접근할 때만 계산하도록 하고 싶음</li>
<li>하지만 한 번 접근하고 나면 이 값을 캐시해 놓고 다음 번에 접근할 때에는 다시 계산하지 않도록 하고 싶음</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>게으른 속성을 효율적으로 정의하기 위해서는 다음과 같이 디스크립터 클래스를 사용하면 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [229]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">lazyproperty</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>
        
    <span class="k">def</span> <span class="nf">__get__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">cls</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">instance</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">func</span><span class="o">.</span><span class="n">__name__</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 코드를 활용하기 위해서는 다음과 같이 클래스 내부에서 사용한다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [272]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>

<span class="k">class</span> <span class="nc">Circle</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">radius</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">=</span> <span class="n">radius</span>
        
    <span class="nd">@lazyproperty</span>
    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Computing area'</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span> <span class="o">**</span> <span class="mi">2</span>
    
    <span class="nd">@lazyproperty</span>
    <span class="k">def</span> <span class="nf">perimeter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'Computing perimeter'</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [232]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [233]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">radius</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[233]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>4.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [234]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">area</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Computing area
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt output_prompt">Out[234]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>50.26548245743669</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [235]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">area</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[235]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>50.26548245743669</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [236]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">perimeter</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Computing perimeter
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt output_prompt">Out[236]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>25.132741228718345</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [237]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">perimeter</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[237]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>25.132741228718345</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>'Computing arean'와 'Computing perimeter' 메시지가 한 번씩만 나타나는 점 주목</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch08-01/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>대개의 경우 게으르게 계산한 속성은 성능 향상을 위해 사용</li>
<li>예를 들어 실제로 특정값을 사용하기 전까지 계산하지 않도록 하는 것</li>
<li>제시한 해결책은 단지 이것만 하지만, 아주 효율적인 방식으로 이를 실행하기 위해 디스크립터의 미묘한 기능을 활용</li>
<li>다른 레시피(예: 레시피 8.9ㅖ에 나온 것처럼, 클래스에 디스크립터가 들어가면 속성 접근 시 __get__(), __set__(), __delete__() 메소드를 호출</li>
<li>하지만 디스크립터가 __get__() 메소드만 정의하면 평소보다 약한 바인딩을 갖게 됨</li>
<li>특히 __get__() 메소드는 접근하는 속성이 인스턴스 딕셔너리에 없을 때만 실행됨</li>
<li>lazyproperty 클래스는 프로퍼티 자체와 동일한 이름을 사용해서 인스턴스 __get__() 메소드에 계산한 값을 저장하는 식으로 이를 활용함</li>
<li>이렇게 하면 그 값은 인스턴스 딕셔너리에 저장되고 추후 프로퍼티의 계산을 하지 않도록 함</li>
<li>동작성을 호가인해 보자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [238]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [239]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 인스턴스 변수 구하기</span>
<span class="nb">vars</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[239]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>{'radius': 4.0}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [240]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 면적을 계산하고 추후 변수 확인</span>
<span class="n">c</span><span class="o">.</span><span class="n">area</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Computing area
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt output_prompt">Out[240]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>50.26548245743669</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [241]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">vars</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[241]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>{'radius': 4.0, 'area': 50.26548245743669}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [242]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 속성에 접근해도 더 이상 프로퍼티를 실행하지 않는다.</span>
<span class="n">c</span><span class="o">.</span><span class="n">area</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[242]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>50.26548245743669</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [243]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 변수를 삭제하고 프로퍼티가 다시 실행됨을 확인</span>
<span class="k">del</span> <span class="n">c</span><span class="o">.</span><span class="n">area</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [244]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">vars</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[244]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>{'radius': 4.0}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [245]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">area</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Computing area
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt output_prompt">Out[245]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>50.26548245743669</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이번 레시피에서 불리한 점 한가지는 계산한 값을 생성한 후에 수정할 수 있다는 것</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [246]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">area</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[246]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>50.26548245743669</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [247]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="mi">25</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [248]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">area</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[248]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>25</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 부분이 걱정된다면 조금 덜 효율적인 구현을 할 수 있다</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [273]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">lazyproperty</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">'_lazy_'</span> <span class="o">+</span> <span class="n">func</span><span class="o">.</span><span class="n">__name__</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lazy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
            <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">lazy</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 버전을 사용하면 값 설정이 불가능하게 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [274]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [275]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">area</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Computing area
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt output_prompt">Out[275]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>50.26548245743669</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [276]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">area</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[276]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>50.26548245743669</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [277]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">area</span> <span class="o">=</span> <span class="mi">25</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-277-dbe51952d3fb&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>c<span class="ansi-blue-fg">.</span>area <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">25</span>

<span class="ansi-red-fg">AttributeError</span>: can't set attribute</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [278]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">area</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[278]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>50.26548245743669</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>하지만 값을 얻기 위해서 항상 프로퍼티의 getter 함수를 사용해야 한다는 불편함이 생김</li>
<li>이 방식은 원래 해결책에 나왔던 것처럼 단순히 인스턴스 딕셔너리에서 값을 찾는 것보다 비효율적</li>
<li>프로퍼티와 관리 속성에 대해 더 많은 정보를 얻고 싶다면 레시피 8.6 참고</li>
<li>디스크립터는 레시피 8.9</li>
</ul>
</div>
</div>
</div>
    </div>
  </div>

            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/books/python_cookbook/ch07/">ch07</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-06-15T19:51:40-09:00">2016-06-15 19:51</time>
</div>
                <div class="stats">
                    
                </div>
                
            </div>
            <div class="body">
                <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="7.-함수">7. 함수<a class="anchor-link" href="posts/books/python_cookbook/ch07/#7.-%ED%95%A8%EC%88%98">¶</a>
</h2>
<ul>
<li>def 구문으로 함수를 정의하는 것은 모든 프로그램의 기초</li>
<li>이번 장에서는 좀 더 고급 기능과 잘 사용하지 않는 함수 정의, 사용 패턴에 대해 알아봄</li>
<li>기본 인자, 인자 수에 구애 받지 않는 함수, 키워드 인자, 주석, closure 등이 주제에 포함</li>
<li>또한 복잡한 control flow와 callback 함수를 사용한 데이터 전달 문제 등도 다룸</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7.1-매개변수-개수에-구애-받지-않는-함수-작성">7.1 매개변수 개수에 구애 받지 않는 함수 작성<a class="anchor-link" href="posts/books/python_cookbook/ch07/#7.1-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98-%EA%B0%9C%EC%88%98%EC%97%90-%EA%B5%AC%EC%95%A0-%EB%B0%9B%EC%A7%80-%EC%95%8A%EB%8A%94-%ED%95%A8%EC%88%98-%EC%9E%91%EC%84%B1">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>입력 매개변수 개수에 제한이 없는 함수를 작성하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>위치 매개변수의 개수에 제한이 없는 함수를 작성하려면 * 인자를 사용</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">avg</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">first</span> <span class="o">+</span> <span class="nb">sum</span><span class="p">(</span><span class="n">rest</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">rest</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">avg</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[2]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>1.5</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">avg</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[3]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>2.5</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[9]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>4</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 예제에서 rest에 추가적 위치 매개변수가 튜플로 들어감</li>
<li>코드는 추후 작업에서 하나의 시퀀스로 다룸</li>
<li>키워드 매개변수 수에 제한이 없는 함수를 작성하려면 **로 시작하는 인자 사용</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">html</span>

<span class="k">def</span> <span class="nf">make_element</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="o">**</span><span class="n">attrs</span><span class="p">):</span>
    <span class="n">keyvals</span> <span class="o">=</span> <span class="p">[</span><span class="s1">' </span><span class="si">%s</span><span class="s1">="</span><span class="si">%s</span><span class="s1">"'</span> <span class="o">%</span> <span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
    <span class="n">attr_str</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">keyvals</span><span class="p">)</span>
    <span class="n">element</span> <span class="o">=</span> <span class="s1">'&lt;</span><span class="si">{name}{attrs}</span><span class="s1">&gt;</span><span class="si">{value}</span><span class="s1">&lt;/</span><span class="si">{name}</span><span class="s1">&gt;'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                <span class="n">attrs</span><span class="o">=</span><span class="n">attr_str</span><span class="p">,</span>
                <span class="n">value</span><span class="o">=</span><span class="n">html</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">element</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 예제</span>
<span class="c1"># '&lt;item size="large" quantity="6"&gt;Albatross&lt;/item&gt;' 생성</span>
<span class="n">make_element</span><span class="p">(</span><span class="s1">'item'</span><span class="p">,</span> <span class="s1">'Albatross'</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s1">'alrge'</span><span class="p">,</span> <span class="n">quantity</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[11]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'&lt;item size="alrge" quantity="6"&gt;Albatross&lt;/item&gt;'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># '&lt;p&gt;&amp;lt;spam&amp;gt;&lt;/p&gt;' 생성</span>
<span class="n">make_element</span><span class="p">(</span><span class="s1">'p'</span><span class="p">,</span> <span class="s1">'&lt;spam&gt;'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[12]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'&lt;p&gt;&amp;lt;spam&amp;gt;&lt;/p&gt;'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>attrs은 전달 받은 키워드 매개변수(있다면)를 저장하는 딕셔너리</li>
<li>위치 매개변수와 키워드 매개변수를 동시에 받는 함수를 작성하려면, *와 **를 함께 사용하면 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">anyargs</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="c1"># 튜플</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="c1"># 딕셔너리</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">anyargs</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'tuple'</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="s1">'dictionary'</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="s1">'nice'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>(1, 2, 'tuple')
{'k': 'nice', 'd': 'dictionary'}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 함수에서 모든 위치 매개변수는 튜플 args</li>
<li>모든 키워드 매개변수는 딕셔너리 kwargs</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>*는 함수 정의의 마지막 위치 매개변수 자리에만 올 수 있다.</li>
<li>**는 마지막 매개변수 자리에만 올 수 있다.</li>
<li>그리고 * 뒤에도 매개변수가 또 나올 수 있다는 거싱 함수 정의의 미묘한 점</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">a</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">b</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이런 매개변수는 키워드로만 넣을 수 있는(keyword-only) 인자로 부르고 레시피 7.2에서 자세히 다룸</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7.2-키워드-매개변수만-받는-함수-작성">7.2 키워드 매개변수만 받는 함수 작성<a class="anchor-link" href="posts/books/python_cookbook/ch07/#7.2-%ED%82%A4%EC%9B%8C%EB%93%9C-%EB%A7%A4%EA%B0%9C%EB%B3%80%EC%88%98%EB%A7%8C-%EB%B0%9B%EB%8A%94-%ED%95%A8%EC%88%98-%EC%9E%91%EC%84%B1">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>키워드로 지정한 특정 매개변수만 받는 함수가 필요하다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>이 기능은 키워드 매개변수를 * 뒤에 넣거나 이름없이 *만 사용하면 간단히 구현 가능</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">recv</span><span class="p">(</span><span class="n">maxsize</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">block</span><span class="p">):</span>
    <span class="s1">'Receives a message'</span>
    <span class="k">pass</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># TypeError</span>
<span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-19-8e61db2ef94b&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>recv<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1024</span><span class="ansi-blue-fg">,</span> <span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">TypeError</span>: recv() takes 1 positional argument but 2 were given</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Ok</span>
<span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-24-e9138eed21fe&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>recv<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1024</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">TypeError</span>: recv() takes 1 positional argument but 3 were given</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-25-4b60b7ba2ae5&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>recv<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1024</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> block<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">TypeError</span>: recv() takes 1 positional argument but 2 positional arguments (and 1 keyword-only argument) were given</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">block</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-26-58ee6ac1bb7e&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>recv<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">1024</span><span class="ansi-blue-fg">,</span> a<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">,</span> block<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">TypeError</span>: recv() got an unexpected keyword argument 'a'</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 기술로 숫자가 다른 위치 매개변수를 받는 함수에 키워드 매개변수를 명시할 때 사용 가능</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">minimum</span><span class="p">(</span><span class="o">*</span><span class="n">values</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">clip</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">clip</span> <span class="k">if</span> <span class="n">clip</span> <span class="o">&gt;</span> <span class="n">m</span> <span class="k">else</span> <span class="n">m</span>
    <span class="k">return</span> <span class="n">m</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># -5 반환</span>
<span class="n">minimum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[22]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>-5</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 0 반환</span>
<span class="n">minimum</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">clip</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[23]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>keyword-only 인자는 추가적 함수 인자를 명시할 때 코드의 가독성을 높이는 좋은 수단</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># msg = recv(1024, False)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>recv()가 어떻게 동작하는지 잘 모르는 사람이 있다면 <strong>False 인자</strong>가 <strong>무엇을 의미하는지 모를 것</strong>
</li>
<li>따라서 호출하는 측에서 다음과 같은 식으로 표시해 준다면 이해하기 훨씬 쉽다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># msg = recv(1024, block=False)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>키워드만 넣을 수 있는 인자는 **kwargs와 관련된 것에 사용자가 도움을 요청하면 도움말 화면에 나타남</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">recv</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Help on function recv in module __main__:

recv(maxsize, *, block)
    Receives a message

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>키워드로만 넣을 수 있는 인자는 더 고급 기능도 가지고 있다.</li>
<li>예를 들어, *args와 **kwargs 방식을 활용하는 함수에 인자를 넣을 때 활용 가능</li>
<li>예제는 레시피 9.11에 나옴</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7.3-함수-인자에-메타데이터-넣기">7.3 함수 인자에 메타데이터 넣기<a class="anchor-link" href="posts/books/python_cookbook/ch07/#7.3-%ED%95%A8%EC%88%98-%EC%9D%B8%EC%9E%90%EC%97%90-%EB%A9%94%ED%83%80%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%84%A3%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>함수를 작성했다.</li>
<li>이때 인자에 정보를 추가해서 다른 사람이 함수를 어떻게 사용해야 하는지 알 수 있도록 하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>함수 인자 주석(function argument annotation)으로 프로그래머에게 이 함수를 어떻게 사용해야 할지 정보를 줄 수 있다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>파이썬 인터프리터는 주석에 어떠한 의미도 부여하지 않음</li>
<li>타입을 확인하지도 않고, 파이썬의 실행 방식이 달라지지도 않는다.</li>
<li>단지 소스콛르르 읽는 사람이 이해하기 쉽도록 설명할 뿐</li>
<li>서드파티 도구와 프레임워크에도 주석이 들어가고는 한다. 그리고 문서에도 나타난다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">add</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Help on function add in module __main__:

add(x:int, y:int) -&gt; int

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>함수 주석은 함수의 __annotations__ 속성에 저장됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add</span><span class="o">.</span><span class="n">__annotations__</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[33]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>{'x': int, 'return': int, 'y': int}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>주석을 활용할 수 있는 방법은 많지만, 기본적으로 <strong>문서화</strong>에 <strong>도움</strong>을 주기 위해 사용</li>
<li>파이썬이 타입 선언을 지원하지 않아서 소스코드만 읽어서는 함수에 어떤 타입을 넣어야 할지 알기 어렵다. 이때 주석이 도움</li>
<li>레시피 9.20에 주석을 활용한 고급 구현법 예제가 나옴(함수 오버로드 등)</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7.4-함수에서-여러값을-반환">7.4 함수에서 여러값을 반환<a class="anchor-link" href="posts/books/python_cookbook/ch07/#7.4-%ED%95%A8%EC%88%98%EC%97%90%EC%84%9C-%EC%97%AC%EB%9F%AC%EA%B0%92%EC%9D%84-%EB%B0%98%ED%99%98">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>함수에 값을 여러 개 반환하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>함수에서 값을 여러 개 반환하고 싶다면 간단히 튜플을 사용하면 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">myfun</span><span class="p">():</span>
    <span class="k">return</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">myfun</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[36]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>1</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[37]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [38]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">c</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[38]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>3</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>myfun()이 값을 여러 개 반환하는 것처럼 보이지만, 사실은 튜플 하나를 반환한 것</li>
<li>조금 이상해 보이지만, 실제로 튜플을 생성하는 것은 쉼표지 괄호가 아니다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 괄호 사용</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [40]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[40]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>(1, 2)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 괄호 미사용</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [42]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[42]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>(1, 2)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>튜플을 반환하는 함수를 호출할 때, 결과 값을 여러 개의 변수에 넣는 것이 일반적</li>
<li>이는 레시피 1.1에 나왔던 튜플 언패킹이다.</li>
<li>반환값을 변수 하나에 할당할 수도 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [43]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">myfun</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [44]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[44]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>(1, 2, 3)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sub</span><span class="p">(</span><span class="n">a</span><span class="p">:</span><span class="nb">int</span><span class="p">,</span> <span class="n">b</span><span class="p">:</span><span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [47]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sub</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[47]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>4</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">sub</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Help on function sub in module __main__:

sub(a:int, b:int) -&gt; int

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7.5-기본-인자를-사용하는-함수-정의">7.5 기본 인자를 사용하는 함수 정의<a class="anchor-link" href="posts/books/python_cookbook/ch07/#7.5-%EA%B8%B0%EB%B3%B8-%EC%9D%B8%EC%9E%90%EB%A5%BC-%EC%82%AC%EC%9A%A9%ED%95%98%EB%8A%94-%ED%95%A8%EC%88%98-%EC%A0%95%EC%9D%98">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>함수나 메소드를 정의할 때 하나 혹은 그 이상 인자에 기본값을 넣어 선택적으로 사용할 수 있도록 하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>표면적으로 선택적 인자를 사용하는 함수를 정의하기는 쉽다.</li>
<li>함수 정의부에 값을 할당하고 가장 뒤에 이를 위치시키기만 하면 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">spam</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">42</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spam</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1 42
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spam</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1 2
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>기본값이 리스트, 세트, 딕셔너리 등 수정 가능한 컨테이너여야 한다면 None을 사용해 다음과 같은 코드 작성</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [58]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 기본 값으로 리스트 사용</span>
<span class="k">def</span> <span class="nf">spam</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>기본값을 제공하는 대신 함수가 받은 값이 특정값인지 아닌지 확인하려면</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [59]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_no_value</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [60]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">spam</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">_no_value</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="n">_no_value</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'No b value supplied'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [61]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spam</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>No b value supplied
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [62]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># b = 2</span>
<span class="n">spam</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [63]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># b = None</span>
<span class="n">spam</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>앞의 나온 예제에서 아무런 값을 전달하지 않았을 때와 None 값을 전달했을 때의 차이점에 주목하자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>기본 인자를 가지는 함수를 정의하기는 간단하지만, 눈에 보이는 것 외에 신경써야 할 부분이 조금 있음</li>
<li>첫째로, 할당하는 기본값은 함수를 정의할 때 한번만 정해지고 그 이후에는 변하지 않음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [64]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">42</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [65]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">spam</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="n">x</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [66]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spam</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1 42
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [67]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">23</span> <span class="c1"># 효과 없음</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [68]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spam</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1 42
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>변수 x(기본 값으로 사용했다)의 값을 바꾸어도 그 이후에 기본값이 변하지 않음</li>
<li>기본값은 함수를 정의할 때 정해지기 때문</li>
<li>2번째로 기본값으로 사용하는 값은 None, True, False, 숫자, 문자열 같이 항상 변하지 않는 객체를 사용해야 함</li>
<li>특히 다음과 같은 코드는 절대 사용하지 않는다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [69]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># No!</span>
<span class="c1"># def spam(a, b=[]):</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이렇게 하면 기본값이 함수를 벗어나서 수정되는 순간 많은 문제가 발생</li>
<li>값이 변하면 기본값이 변하게 되고 추후 함수 호출에 영향을 줌</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [70]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">spam</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="p">[]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">b</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [71]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">spam</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[]
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [72]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[72]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [73]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">99</span><span class="p">)</span>
<span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'Yow!'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [74]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[74]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[99, 'Yow!']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [75]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spam</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[99, 'Yow!']
</pre>
</div>
</div>

<div class="output_area">
<div class="prompt output_prompt">Out[75]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[99, 'Yow!']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이런 부작용을 피하려면 앞의 예제에 나왔듯이 기본값으로 None을 할당하고 함수 내부에서 이를 확인하는 것이 좋음</li>
<li>
<strong>None을 확인</strong>할 때 <strong>is 연산자</strong>를 사용하는 것이 <strong>매우 중요</strong>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [76]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">spam</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">b</span><span class="p">:</span> <span class="c1"># 주의! 'b is None"을 사용해야 한다.</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>여기서 문제는 None이 False로 평가되지만, 그 외에 다른 객체(예: 길이가 0인 문자열, 리스트, 튜플, 딕셔너리 등)도 False로 평가된다는 점</li>
<li>따라서 특정 입력을 없다고 판단하게 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [77]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 올바름</span>
<span class="n">spam</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [78]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [79]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 에러. x값이 기본으로 덮어 씌여진다.</span>
<span class="n">spam</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [80]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 에러. 0이 무시된다.</span>
<span class="n">spam</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [81]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 에러. ''이 무시된다.</span>
<span class="n">spam</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이번 레시피의 마지막 부분은 어쩌면 사소한 것인데, 함수가 추가적 매개변수 위치에 있는지 없는지 판단하는 것</li>
<li>여기서 쉽지 않은 점은 사용자가 인자를 넣었는지 확인할 때 기본 값으로 None, 0 또는 False를 사용할 수 없다는 점</li>
<li>왜냐하면 사용자가 바로 이값을 인자로 넣을 수도 있기 때문. 따라서 다른 방법으로 확인을 해야 함</li>
</ul>
<ul>
<li>이 문제를 해결하기 위해서는 앞의 예제(_no_value 변수)에 나온 것처럼 object의 유일한 인스턴스를 만들어야 한다.</li>
<li>그리고함수에서 이 특별한 값과 들어온 이낮를 비교해서 인자가 있는지 없는지 알 수 있다.</li>
<li>이때 사용자가 _no_value 인스턴스를 입력값으로 전달할 확률이 지극히 적다. 따라서 값이 있는지 없는지 확인하는 데 이 인스턴스를 사용해도 안전하다.</li>
</ul>
<ul>
<li>
<strong>object()</strong>를 사용하는 것이 일반적이지 않아 보인다. object는 파이썬에서 거의 모든 객체의 베이스 클래스 역할을 한다.</li>
<li>object의 인스턴스를 만들 수 있지만, 여기에는 어떤 메소드나 인스턴스 데이터가 없어서 그대로 사용하지는 않는다(인스턴스 딕셔너리가 없어서 속성을 설정할 수도 없다)</li>
<li>이것을 가지고는 <strong>동일성을 확인하는 것</strong> 외에는 할 수 있는 것이 없어서 앞의 예제에 나온 것처럼 <strong>특별값을 만들 때 유용</strong>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7.6-이름없는-함수와-인라인-함수-정의">7.6 이름없는 함수와 인라인 함수 정의<a class="anchor-link" href="posts/books/python_cookbook/ch07/#7.6-%EC%9D%B4%EB%A6%84%EC%97%86%EB%8A%94-%ED%95%A8%EC%88%98%EC%99%80-%EC%9D%B8%EB%9D%BC%EC%9D%B8-%ED%95%A8%EC%88%98-%EC%A0%95%EC%9D%98">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>sort() 등에 사용할 짧은 콜백 함수를 만들어야 하는데, 한줄짜리 함수를 만들면서 def 구문까지 사용하고 싶지는 않음</li>
<li>그 대신 in line 이라 불리는 짧은 함수를 만들고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>표현식 계산 외에 아무 일도 하지 않는 간단한 함수는 lambda로 치환 가능</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [82]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [83]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[83]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>5</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">,</span> <span class="s1">'world'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[84]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'helloworld'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>앞에 나온 lambda는 다음의 예제 코드와 완전히 동일</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [85]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [86]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">add</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[86]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>5</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>일반적으로 lambda는 정렬이나 데이터 줄이기 등 다른 작업에 사용할 때 많이 씀</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [87]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'David Beazley'</span><span class="p">,</span> <span class="s1">'Brian Jones'</span><span class="p">,</span> 
         <span class="s1">'Raymond Hettinger'</span><span class="p">,</span> <span class="s1">'Ned Batchelder'</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [88]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">name</span><span class="p">:</span> <span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[88]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>['Ned Batchelder', 'David Beazley', 'Raymond Hettinger', 'Brian Jones']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [90]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[90]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'Beazley'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>lambda를 사용해서 간단한 함수를 정의할 수 있지만, 제약이 아주 많음</li>
<li>우선 표현식을 하나만 사용해야 하고 그 결과가 반환 값이 된다. 따라서 명령문을 여러 개 쓴다거나 조건문, 순환문, 에러 처리 등을 넣을 수 없다.</li>
<li>파이썬 코드를 작성하면서 lambda를 사용하지 않아도 아무 상관이 없지만, 여러 가지 표현식을 계산하는 작은 함수를 많이 사용하거나 콜백 함수를 사용하는 프로그램에서 종종 lambda를 발견하게 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7.7-이름없는-함수에서-변수-고정">7.7 이름없는 함수에서 변수 고정<a class="anchor-link" href="posts/books/python_cookbook/ch07/#7.7-%EC%9D%B4%EB%A6%84%EC%97%86%EB%8A%94-%ED%95%A8%EC%88%98%EC%97%90%EC%84%9C-%EB%B3%80%EC%88%98-%EA%B3%A0%EC%A0%95">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>lambda를 사용해서 이름없는 함수를 정의했는데, 정의할 때 특정 변수의 값을 고정하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>다음 코드의 동작성 고려</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [91]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [92]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [93]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">20</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [94]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이제 스스로 질문을 던져보자.</li>
<li>a(10)과 b(10)의 값은 무엇이 될까?</li>
<li>아마도 20, 30일 생각했을지 모르겠지만 옳지 않다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [95]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[95]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>30</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [96]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[96]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>30</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>여기서 문제는 lambda에서 사용한 x값이 실행 시간에 달라지는 변수라는 점</li>
<li>따라서 람다 표현식의 x의 값은 그 함수를 실행할 때의 값이 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [97]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">15</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [98]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[98]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>25</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [99]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">3</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [100]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[100]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>13</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이름없는 함수를 정의할 때 특정값을 고정하고 싶으면 그 값을 기본값으로 지정하면 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [101]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">10</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [102]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [103]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">20</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [104]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [105]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[105]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>20</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [106]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[106]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>30</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>이번 레시피에 나온 문제는, 람다 함수를 조금 더 현명하게 사용하려다가 발생하는 경우가 많음</li>
<li>예를 들어 list comprehension 이나 반복문에서 람다 표현식을 생성하고 람다 함수가 순환 변수를 기억하려고 할 때 발생하기 쉬움</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [107]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [108]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 저번이랑 똑같은 경우네..</span>
<span class="c1"># n이 4까지 증가한 상황에서 f를 호출하니 n은 4가 될 수 밖에..</span>
<span class="c1"># n = 0</span>
<span class="c1"># n = 1</span>
<span class="c1"># n = 2</span>
<span class="c1"># n = 3</span>
<span class="c1"># n = 4</span>
<span class="c1"># 이렇게 된다!</span>
<span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>4
4
4
4
4
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>프로그래머는 n값이 변할 것이라고 기대헀느지만 람다 함수는 가장 마지막 값을 사용했음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [109]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># n을 처음부터 할당하고 시작하자</span>
<span class="c1"># 그렇게 되면 나중에 함수를 호출하더라도 n값은 이미 설정되었기 때문에 바뀌지 않는다.</span>
<span class="n">funcs</span> <span class="o">=</span> <span class="p">[</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">:</span> <span class="n">x</span><span class="o">+</span><span class="n">n</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [110]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">funcs</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>0
1
2
3
4
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이제 <strong>n값을 함수를 정의하는 시점의 값</strong>으로 <strong>고정</strong>해 놓고 사용한다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7.8-인자를-N개-받는-함수를-더-적은-인자로-사용">7.8 인자를 N개 받는 함수를 더 적은 인자로 사용<a class="anchor-link" href="posts/books/python_cookbook/ch07/#7.8-%EC%9D%B8%EC%9E%90%EB%A5%BC-N%EA%B0%9C-%EB%B0%9B%EB%8A%94-%ED%95%A8%EC%88%98%EB%A5%BC-%EB%8D%94-%EC%A0%81%EC%9D%80-%EC%9D%B8%EC%9E%90%EB%A1%9C-%EC%82%AC%EC%9A%A9">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>파이썬 코드에 콜백 함수나 핸들러로 사용할 호출체가 있음</li>
<li>하지만 함수의 인자가 너무 많고 호출했을 때 예외가 발생함</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>함수의 인자 개수를 줄이려면 functools.partial()을 사용해야 함</li>
<li>partial() 함수를 사용하면 함수의 인자에 고정값을 할당할 수 있고, 따라서 호출할 때 넣어야 하는 인자수를 줄일 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">spam</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이제 partial()로 특정값을 고정</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">partial</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">partial</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Help on class partial in module functools:

class partial(builtins.object)
 |  partial(func, *args, **keywords) - new function with partial application
 |  of the given arguments and keywords.
 |  
 |  Methods defined here:
 |  
 |  __call__(self, /, *args, **kwargs)
 |      Call self as a function.
 |  
 |  __delattr__(self, name, /)
 |      Implement delattr(self, name).
 |  
 |  __getattribute__(self, name, /)
 |      Return getattr(self, name).
 |  
 |  __new__(*args, **kwargs) from builtins.type
 |      Create and return a new object.  See help(type) for accurate signature.
 |  
 |  __reduce__(...)
 |  
 |  __repr__(self, /)
 |      Return repr(self).
 |  
 |  __setattr__(self, name, value, /)
 |      Implement setattr(self, name, value).
 |  
 |  __setstate__(...)
 |  
 |  ----------------------------------------------------------------------
 |  Data descriptors defined here:
 |  
 |  __dict__
 |  
 |  args
 |      tuple of arguments to future partial calls
 |  
 |  func
 |      function object to use in future partial calls
 |  
 |  keywords
 |      dictionary of keyword arguments to future partial calls

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># a = 1</span>
<span class="c1"># partial(함수, 함수에 보낼 인자값)</span>
<span class="n">s1</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">spam</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> 
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s1</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1 2 3 4
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s1</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1 4 5 6
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># d = 42</span>
<span class="n">s2</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">spam</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span> 
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s2</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1 2 3 42
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s2</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>4 5 5 42
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># d는 이미 할당이 됐다는 건가?</span>
<span class="c1"># 4개 인자만 받아야 되며, 이미 d 1개는 할당이 된 상태</span>
<span class="n">s2</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-30-4872ae172b17&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-red-fg"># d는 이미 할당이 됐다는 건가?</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-red-fg"># 4개 인자만 받아야 되며, 이미 d 1개는 할당이 된 상태</span>
<span class="ansi-green-fg">----&gt; 3</span><span class="ansi-red-fg"> </span>s2<span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">4</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">5</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">5</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">5</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">TypeError</span>: spam() got multiple values for argument 'd'</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># a = 1, b = 2, d = 42</span>
<span class="n">s3</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">spam</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="mi">42</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s3</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1 2 3 42
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s3</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1 2 4 42
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s3</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>1 2 5 42
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>partial()이 특정 인자의 값을 고정하고 새로운 호출체를 반환함</li>
<li>이 새로운 호출체는 할당하지 않은 인잘르 받고, partial()에 주어진 인자와 합친 후 원본 함수에 전달함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>이번 레시피는 겉으로 보기에 호환되지 않을 것 같은 코드를 함께 동작하도록 하는 문제와 관련</li>
<li>우선 (x, y) 튜플로 나타낸 좌표 리스트</li>
<li>다음 함수를 사용해서 두 점 사이의 거리를 구할 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">points</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">)]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">math</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">distance</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="n">p2</span><span class="p">):</span>
    <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span> <span class="o">=</span> <span class="n">p1</span>
    <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span> <span class="o">=</span> <span class="n">p2</span>
    <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">x2</span><span class="o">-</span><span class="n">x1</span><span class="p">,</span> <span class="n">y2</span><span class="o">-</span><span class="n">y1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># hypot 뭐의 약자냐?!</span>
<span class="n">help</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">hypot</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Help on built-in function hypot in module math:

hypot(...)
    hypot(x, y)
    
    Return the Euclidean distance, sqrt(x*x + y*y).

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이제 어떤 점에서부터 이 점까지의 거리에 따라 정렬을 해야 한다면 어떻게 할까?</li>
<li>리스트의 sort() 메소드는 key 인자를 받아서 정렬에 사용하지만 인자가 하나인 함수에만 동작한다(따라서 distance()는 적당하지 않다)</li>
<li>이때 partial()로 이 문제를 해결한다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pt</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># distance 함수, pt=(4,3)을 넣어 sort를 한다.</span>
<span class="c1"># ponits의 list값들이 선회하며 pt=(4,3)과 차이나는 순서대로 정렬됨</span>
<span class="n">points</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">distance</span><span class="p">,</span> <span class="n">pt</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">distance</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[18]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>1.4142135623730951</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">distance</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[19]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>3.1622776601683795</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">distance</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[20]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>3.1622776601683795</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">distance</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[21]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>5.830951894845301</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">points</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[22]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[(3, 4), (1, 2), (5, 6), (7, 8)]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 발상을 확장해서, 다른 라이브러리에서 사용하는 콜백 함수의 매개변수 설명을 변경하는데 partial()을 사용할 수도 있음</li>
<li>예를 들어 multiprocessing을 사용해서 비동기식으로 결과를 계산하고, 결과값과 로깅 인자를 받는 콜백 함수에 그 결과를 전달하는 코드가 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">output_result</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">log</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">'Got: </span><span class="si">%r</span><span class="s1">'</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
        
<span class="c1"># 샘플 함수</span>
<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">logging</span>
    <span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="k">import</span> <span class="n">Pool</span>
    <span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">partial</span>

    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">DEBUG</span><span class="p">)</span>
    <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">'test'</span><span class="p">)</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">Pool</span><span class="p">()</span>
    <span class="n">p</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">output_result</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="n">log</span><span class="p">))</span>
    <span class="n">p</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">p</span><span class="o">.</span><span class="n">join</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>apply_async()로 콜백 함수를 지원할 때, partial()을 사용해서 추가적인 로깅 인자를 넣었다.</li>
<li>multiprocessing은 하나의 값으로 콜백 함수를 호출하게 되는 것</li>
</ul>
<ul>
<li>유사한 예제로 네트워크 서버를 작성한다고 생각해 보자.</li>
<li>socketserver 모듈을 사용하면 상대적으로 편하게 작업할 수 있음</li>
<li>예를 들어 다음 코드는 간단한 에코 서버를 구현함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">socketserver</span> <span class="k">import</span> <span class="n">StreamRequestHandler</span><span class="p">,</span> <span class="n">TCPServer</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">EchoHandler</span><span class="p">(</span><span class="n">StreamRequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rfile</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="s1">'GOT:'</span> <span class="o">+</span> <span class="n">line</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">serv</span> <span class="o">=</span> <span class="n">TCPServer</span><span class="p">((</span><span class="s1">''</span><span class="p">,</span> <span class="mi">15000</span><span class="p">),</span> <span class="n">EchoHandler</span><span class="p">)</span>
<span class="n">serv</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-4-91fb7158f643&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> serv <span class="ansi-blue-fg">=</span> TCPServer<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">''</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">15000</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> EchoHandler<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>serv<span class="ansi-blue-fg">.</span>serve_forever<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4/socketserver.py</span> in <span class="ansi-cyan-fg">serve_forever</span><span class="ansi-blue-fg">(self, poll_interval)</span>
<span class="ansi-green-intense-fg ansi-bold">    234</span>                 <span class="ansi-red-fg"># shutdown request and wastes cpu at all other times.</span>
<span class="ansi-green-intense-fg ansi-bold">    235</span>                 r, w, e = _eintr_retry(select.select, [self], [], [],
<span class="ansi-green-fg">--&gt; 236</span><span class="ansi-red-fg">                                        poll_interval)
</span><span class="ansi-green-intense-fg ansi-bold">    237</span>                 <span class="ansi-green-fg">if</span> self <span class="ansi-green-fg">in</span> r<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    238</span>                     self<span class="ansi-blue-fg">.</span>_handle_request_noblock<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4/socketserver.py</span> in <span class="ansi-cyan-fg">_eintr_retry</span><span class="ansi-blue-fg">(func, *args)</span>
<span class="ansi-green-intense-fg ansi-bold">    152</span>     <span class="ansi-green-fg">while</span> <span class="ansi-green-fg">True</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    153</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 154</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> func<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    155</span>         <span class="ansi-green-fg">except</span> OSError <span class="ansi-green-fg">as</span> e<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    156</span>             <span class="ansi-green-fg">if</span> e<span class="ansi-blue-fg">.</span>errno <span class="ansi-blue-fg">!=</span> errno<span class="ansi-blue-fg">.</span>EINTR<span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">EchoHandler</span><span class="p">(</span><span class="n">StreamRequestHandler</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">ack</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ack</span> <span class="o">=</span> <span class="n">ack</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rfile</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="s1">'GOT:'</span> <span class="o">+</span> <span class="n">line</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이렇게 수정하면 TCPServer 클래스에 넣을 수 있는 뚜렷한 방법이 사라짐</li>
<li>이제 코드를 실행하면 다음과 같은 예외가 발생함</li>
<li>얼핏 보기에 socketserver를 수정하거나 이상한 해결책을 사용하지 않는 한 이 코드를 고치기가 불가능할 것처럼 느껴진다. 하지만 partial()을 사용해서 ack 인자에 값을 넣어주면 간단히 해결됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">partial</span>
<span class="n">serv</span> <span class="o">=</span> <span class="n">TCPServer</span><span class="p">((</span><span class="s1">''</span><span class="p">,</span> <span class="mi">15000</span><span class="p">),</span> <span class="n">partial</span><span class="p">(</span><span class="n">EchoHandler</span><span class="p">,</span> <span class="n">ack</span><span class="o">=</span><span class="n">b</span><span class="s1">'RECEIVED:'</span><span class="p">))</span>
<span class="n">serv</span><span class="o">.</span><span class="n">serve_forever</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-3-cdc61449f80f&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-green-fg">from</span> functools <span class="ansi-green-fg">import</span> partial
<span class="ansi-green-intense-fg ansi-bold">      2</span> serv <span class="ansi-blue-fg">=</span> TCPServer<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">''</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">15000</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> partial<span class="ansi-blue-fg">(</span>EchoHandler<span class="ansi-blue-fg">,</span> ack<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">b'RECEIVED:'</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 3</span><span class="ansi-red-fg"> </span>serv<span class="ansi-blue-fg">.</span>serve_forever<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4/socketserver.py</span> in <span class="ansi-cyan-fg">serve_forever</span><span class="ansi-blue-fg">(self, poll_interval)</span>
<span class="ansi-green-intense-fg ansi-bold">    234</span>                 <span class="ansi-red-fg"># shutdown request and wastes cpu at all other times.</span>
<span class="ansi-green-intense-fg ansi-bold">    235</span>                 r, w, e = _eintr_retry(select.select, [self], [], [],
<span class="ansi-green-fg">--&gt; 236</span><span class="ansi-red-fg">                                        poll_interval)
</span><span class="ansi-green-intense-fg ansi-bold">    237</span>                 <span class="ansi-green-fg">if</span> self <span class="ansi-green-fg">in</span> r<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    238</span>                     self<span class="ansi-blue-fg">.</span>_handle_request_noblock<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4/socketserver.py</span> in <span class="ansi-cyan-fg">_eintr_retry</span><span class="ansi-blue-fg">(func, *args)</span>
<span class="ansi-green-intense-fg ansi-bold">    152</span>     <span class="ansi-green-fg">while</span> <span class="ansi-green-fg">True</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    153</span>         <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 154</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> func<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    155</span>         <span class="ansi-green-fg">except</span> OSError <span class="ansi-green-fg">as</span> e<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    156</span>             <span class="ansi-green-fg">if</span> e<span class="ansi-blue-fg">.</span>errno <span class="ansi-blue-fg">!=</span> errno<span class="ansi-blue-fg">.</span>EINTR<span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 예제에서 __init__ 메소드에 <strong>ack 인자를 명시</strong>하는 것이 <strong>우습게</strong> 보일 수 있지만, 키워드로만 넣을 수 있는 인자라서 그렇다. 자세한 내용은 레시피 7.2에서 다룸</li>
<li>partial()의 기능을 lambda 표현식으로 대신하기도 함</li>
<li>예를 들어 앞에 나온 예제를 다음과 같이 작성할 수 있다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">points</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="n">distance</span><span class="p">(</span><span class="n">pt</span><span class="p">,</span> <span class="n">p</span><span class="p">))</span>
<span class="n">p</span><span class="o">.</span><span class="n">apply_async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">result</span><span class="p">:</span> <span class="n">output_result</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">log</span><span class="p">))</span>
<span class="n">serv</span> <span class="o">=</span> <span class="n">TCPServer</span><span class="p">((</span><span class="s1">''</span><span class="p">,</span> <span class="mi">15000</span><span class="p">),</span>
                 <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">EchoHandler</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span>
                                                     <span class="n">ack</span><span class="o">=</span><span class="n">b</span><span class="s1">'RECEIVED:'</span><span class="p">,</span>
                                                     <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-27-442db0cdae08&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> points<span class="ansi-blue-fg">.</span>sort<span class="ansi-blue-fg">(</span>key<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">lambda</span> p<span class="ansi-blue-fg">:</span> distance<span class="ansi-blue-fg">(</span>pt<span class="ansi-blue-fg">,</span> p<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg"> </span>p<span class="ansi-blue-fg">.</span>apply_async<span class="ansi-blue-fg">(</span>add<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">(</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">4</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> callback<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">lambda</span> result<span class="ansi-blue-fg">:</span> output_result<span class="ansi-blue-fg">(</span>result<span class="ansi-blue-fg">,</span> log<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> serv = TCPServer(('', 15000),
<span class="ansi-green-intense-fg ansi-bold">      4</span>                  lambda *args, **kwargs: EchoHandler(*args,
<span class="ansi-green-intense-fg ansi-bold">      5</span>                                                      ack<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">b'RECEIVED:'</span><span class="ansi-blue-fg">,</span>

<span class="ansi-green-fg">/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4/multiprocessing/pool.py</span> in <span class="ansi-cyan-fg">apply_async</span><span class="ansi-blue-fg">(self, func, args, kwds, callback, error_callback)</span>
<span class="ansi-green-intense-fg ansi-bold">    320</span>         '''
<span class="ansi-green-intense-fg ansi-bold">    321</span>         <span class="ansi-green-fg">if</span> self<span class="ansi-blue-fg">.</span>_state <span class="ansi-blue-fg">!=</span> RUN<span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 322</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> ValueError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">"Pool not running"</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    323</span>         result <span class="ansi-blue-fg">=</span> ApplyResult<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>_cache<span class="ansi-blue-fg">,</span> callback<span class="ansi-blue-fg">,</span> error_callback<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    324</span>         self<span class="ansi-blue-fg">.</span>_taskqueue<span class="ansi-blue-fg">.</span>put<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">(</span>result<span class="ansi-blue-fg">.</span>_job<span class="ansi-blue-fg">,</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> func<span class="ansi-blue-fg">,</span> args<span class="ansi-blue-fg">,</span> kwds<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">ValueError</span>: Pool not running</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 코드도 동작하기는 하지만, 가독성이 떨어지고 나중에 소스 코드를 읽는 사람이 헷갈릴 확률이 더 크다.</li>
<li>partial()을 사용하면 조금 더 작성자의 의도를 파악하기 쉽다.(몇몇 매개변수에 값을 넣는다)</li>
</ul>
<h4 id="잘-안된다...-이건-나중에-다시-한-번-확인해-봐야-할듯">잘 안된다... 이건 나중에 다시 한 번 확인해 봐야 할듯<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%EC%9E%98-%EC%95%88%EB%90%9C%EB%8B%A4...-%EC%9D%B4%EA%B1%B4-%EB%82%98%EC%A4%91%EC%97%90-%EB%8B%A4%EC%8B%9C-%ED%95%9C-%EB%B2%88-%ED%99%95%EC%9D%B8%ED%95%B4-%EB%B4%90%EC%95%BC-%ED%95%A0%EB%93%AF">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7.9-메소드가-하나인-클래스를-함수로-치환">7.9 메소드가 하나인 클래스를 함수로 치환<a class="anchor-link" href="posts/books/python_cookbook/ch07/#7.9-%EB%A9%94%EC%86%8C%EB%93%9C%EA%B0%80-%ED%95%98%EB%82%98%EC%9D%B8-%ED%81%B4%EB%9E%98%EC%8A%A4%EB%A5%BC-%ED%95%A8%EC%88%98%EB%A1%9C-%EC%B9%98%ED%99%98">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>__init__() 외에 메소드가 하나뿐인 클래스가 있는데, 코드를 간결하게 만들기 위해 이를 하나의 함수로 바꾸고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>많은 경우 메소드가 하나뿐인 클래스는 closure를 사용해서 함수로 바꿀 수 있음</li>
<li>템플릿 스킴을 사용해서 URL을 추출하는, 다음 클래스를 예로 들어보자.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="k">import</span> <span class="n">urlopen</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">UrlTemplate</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="n">template</span>
    
    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">urlopen</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">template</span><span class="o">.</span><span class="n">format_map</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 사용법. 야후에서 주식 데이터를 받는다.</span>
<span class="n">yahoo</span> <span class="o">=</span> <span class="n">UrlTemplate</span><span class="p">(</span><span class="s1">'http://finance.yahoo.com/d/quotes.csv?s=</span><span class="si">{names}</span><span class="s1">&amp;f=</span><span class="si">{fields}</span><span class="s1">'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">yahoo</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">'IBM,AAPL,FB'</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="s1">'sl1c1v'</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>"IBM",185.71,-3.33,2994065

"AAPL",98.75,-0.87,42094184

"FB",76.29,-1.265,25317488

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>클래스를 훨씬 간단한 함수로 치환할 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">urltemplate</span><span class="p">(</span><span class="n">template</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">opener</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">format_map</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">opener</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 사용법</span>
<span class="n">yahoo</span> <span class="o">=</span> <span class="n">urltemplate</span><span class="p">(</span><span class="s1">'http://finance.yahoo.com/d/quotes.csv?s=</span><span class="si">{names}</span><span class="s1">&amp;f=</span><span class="si">{fields}</span><span class="s1">'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">yahoo</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">'IBM,AAPL,FB'</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="s1">'sl1c1v'</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>"IBM",185.71,-3.33,2994065

"AAPL",98.75,-0.87,42094184

"FB",76.29,-1.265,25317488

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">template</span> <span class="o">=</span> <span class="s1">'http://finance.yahoo.com/d/quotes.csv?s=</span><span class="si">{names}</span><span class="s1">&amp;f=</span><span class="si">{fields}</span><span class="s1">'</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [55]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 생각없이 그냥 대충 끼워넣으려고 하지 말자</span>
<span class="c1"># 생각을 해보면 dictionary 일거라고 충분히 예상할 수 있잖아.</span>
<span class="c1"># 왜 튜플 형식, keyword 인자 형식으로 생각했지? 좀 더 고민해 보자.</span>
<span class="n">template</span><span class="o">.</span><span class="n">format_map</span><span class="p">({</span><span class="s1">'names'</span><span class="p">:</span> <span class="s1">'Guido'</span><span class="p">,</span> <span class="s1">'fields'</span><span class="p">:</span><span class="s1">'ok'</span><span class="p">})</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[55]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'http://finance.yahoo.com/d/quotes.csv?s=Guido&amp;f=ok'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>대개의 경우 메소드가 하나뿐인 클래스가 필요할 때는 추가적인 상태를 메소드에 저장할 때뿐이다.</li>
<li>예를 들어 <strong>UrlTemplate 클래스의 목적</strong>은 open() 메소드에서 사용하기 위해 <strong>template 값을 저장해 놓으려는 것뿐</strong>
</li>
</ul>
<ul>
<li>내부 함수나 클로저를 사용하면 좀 더 보기 좋게 코드를 작성할 수 있음</li>
<li>단순히 생각해서 클로저는 함수라고 말할 수 있지만 함수 내부에서 사용하는 변수의 추가적인 환경이 있다.</li>
<li>클로저의 주요 기능은 <strong>정의할 때의 환경을 기억한다</strong>는 것이다. 따라서 앞의 예제에서 opener() 함수가 <strong>template 인자의 값을 기억</strong>하고 <strong>추후 호출에 사용</strong>한다.</li>
<li>코드를 작성하다가 <strong>함수에 추가적인 상태를 첨부</strong>해야 하는 문제가 발생하면 클로저를 고려해 보자.</li>
<li>
<strong>클로저</strong>는 클래스를 사용하는 것보다 <strong>훨씬 우아</strong>하게 문제를 해결하는 경우가 많다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [64]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Url</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">template</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">template</span> <span class="o">=</span> <span class="n">template</span>
        
    <span class="k">def</span> <span class="nf">open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">format_map</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [65]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">yahoo</span> <span class="o">=</span> <span class="n">Url</span><span class="p">(</span><span class="s1">'http://finance.yahoo.com/d/quotes.csv?s=</span><span class="si">{names}</span><span class="s1">&amp;f=</span><span class="si">{fields}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [70]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">yahoo</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">'ibm'</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="s1">'sl1c1v'</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[70]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[b'"IBM",185.71,-3.33,2994065\r\n']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [73]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">yahoo</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">'IBM,AAPL,FB'</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="s1">'sl1c1v'</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">''</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>"IBM",185.71,-3.33,2994065
"AAPL",98.75,-0.87,42094184
"FB",76.29,-1.265,25317488
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">url2</span><span class="p">(</span><span class="n">template</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">format_map</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">inner</span>
    
<span class="k">def</span> <span class="nf">url3</span><span class="p">(</span><span class="n">template</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">template</span><span class="o">.</span><span class="n">format_map</span><span class="p">(</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">inner</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [85]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">yahoo</span> <span class="o">=</span> <span class="n">url3</span><span class="p">(</span><span class="s1">'http://finance.yahoo.com/d/quotes.csv?s=</span><span class="si">{names}</span><span class="s1">&amp;f=</span><span class="si">{fields}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [87]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">yahoo</span><span class="p">(</span><span class="n">names</span><span class="o">=</span><span class="s1">'IBM'</span><span class="p">,</span> <span class="n">fields</span><span class="o">=</span><span class="s1">'sl1c1v'</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[87]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[b'"IBM",185.71,-3.33,2994065\r\n']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7.10-콜백-함수에-추가적-상태-넣기">7.10 콜백 함수에 추가적 상태 넣기<a class="anchor-link" href="posts/books/python_cookbook/ch07/#7.10-%EC%BD%9C%EB%B0%B1-%ED%95%A8%EC%88%98%EC%97%90-%EC%B6%94%EA%B0%80%EC%A0%81-%EC%83%81%ED%83%9C-%EB%84%A3%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>콜백 함수를 사용하는 코드를 작성 중이다(이벤트 핸들러, 완료 콜백 등).</li>
<li>이때 콜백 함수에 추가 상태를 넣고 내부 호출에 사용하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>이 레시피는 <strong>많은 라이브러리</strong>와 <strong>프레임워크</strong>(특히 <strong>비동기 처리</strong>에 관련있는)에서 찾을 수 있는 <strong>콜백 함수의 활용</strong>을 알아본다. 예제를 위해 콜백 함수를 호출하는 다음 함수를 정의한다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [88]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">apply_async</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
    <span class="c1"># 결과 계산</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    <span class="c1"># 결과 값으로 콜백 함수 호출</span>
    <span class="n">callback</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>실제 애플리케이션이라면 이런 코드에서는 쓰레드, 프로세스, 타이머 등과 관련있는 고급 동작을 구현하겠지만, 여기서는 그런 것이 중요하지 않으므로 건너뛰고, <strong>콜백 호출 자체</strong>에만 집중한다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [89]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">print_result</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Got:'</span><span class="p">,</span> <span class="n">result</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [90]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [91]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">apply_async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">print_result</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Got: 5
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [92]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">apply_async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="s1">'hello'</span><span class="p">,</span> <span class="s1">'world'</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">print_result</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Got: helloworld
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>print_result() 함수는 결과값만 하나의 인자로 받는다. 다른 어떠한 정보도 전달받지 않는다.</li>
<li>이렇게 부족한 정보로 인해 콜백 함수가 다른 변수나 호나경 등과 통신할 때 문제가 발생하기도 함</li>
<li>콜백 함수에 추가 정보를 넣는 한 가지 방법은 하나의 함수 대신 bound-method를 사용하는 것</li>
<li>예를 들어 이 클래스는 결과값을 받을 때마다 늘어나는 내부 시퀀스 숫자를 가지고 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [93]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">ResultHandler</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'[</span><span class="si">{}</span><span class="s1">] Got: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sequence</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [94]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">ResultHandler</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [95]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">apply_async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">handler</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] Got: 5
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [96]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">apply_async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="s1">'hello'</span><span class="p">,</span> <span class="s1">'world'</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">r</span><span class="o">.</span><span class="n">handler</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[2] Got: helloworld
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>클래스의 대안으로 클로저를 사용해서 상태를 저장해도 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [100]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_handler</span><span class="p">():</span>
    <span class="n">sequence</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">result</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">sequence</span>
        <span class="n">sequence</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'[</span><span class="si">{}</span><span class="s1">] Got: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">handler</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 방법의 예제는 다음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [101]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">handler</span> <span class="o">=</span> <span class="n">make_handler</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [102]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">apply_async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">handler</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] Got: 5
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [103]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">apply_async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="s1">'hello'</span><span class="p">,</span> <span class="s1">'world'</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">handler</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[2] Got: helloworld
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이번 테마와는 다르지만, coroutine 을 사용할 수도 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [108]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">make_handler</span><span class="p">():</span>
    <span class="n">sequence</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="k">yield</span>
        <span class="n">sequence</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'[</span><span class="si">{}</span><span class="s1">] Got: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [109]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">handler</span> <span class="o">=</span> <span class="n">make_handler</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [110]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">next</span><span class="p">(</span><span class="n">handler</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [111]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">apply_async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">handler</span><span class="o">.</span><span class="n">send</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] Got: 5
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [112]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">apply_async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="s1">'hello'</span><span class="p">,</span> <span class="s1">'world'</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">handler</span><span class="o">.</span><span class="n">send</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[2] Got: helloworld
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>마지막으로, 추가적인 인자와 partial function 애플리케이션으로 콜백에 상태를 넣을 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [113]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">SequenceNo</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [114]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">seq</span><span class="p">):</span>
    <span class="n">seq</span><span class="o">.</span><span class="n">sequence</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'[</span><span class="si">{}</span><span class="s1">] Got: </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">seq</span><span class="o">.</span><span class="n">sequence</span><span class="p">,</span> <span class="n">result</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [115]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seq</span> <span class="o">=</span> <span class="n">SequenceNo</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [116]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">partial</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [117]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">apply_async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">handler</span><span class="p">,</span> <span class="n">seq</span><span class="o">=</span><span class="n">seq</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[1] Got: 5
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [118]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">apply_async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="s1">'hello'</span><span class="p">,</span> <span class="s1">'world'</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="n">partial</span><span class="p">(</span><span class="n">handler</span><span class="p">,</span> <span class="n">seq</span><span class="o">=</span><span class="n">seq</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[2] Got: helloworld
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>콜백 함수를 사용하는 프로그램은 엉망으로 망가질 위험 요소를 안고 있음</li>
<li>한가지 문제점은 콜백 실행으로 이끄는 초기 요청 코드와 콜백 함수가 끊어진다는 점</li>
<li>결과적으로 요청을 한 곳과 처리하는 곳이 서로를 찾지 못하게 됨</li>
<li>콜백 함수가 여러 단계에 걸쳐 실행을 계속하도록 만들기 위해서는 어떻게 관련 상태를 저장하고 불러올지 정해야 함</li>
</ul>
<ul>
<li>상태를 고정 시키고 저장하는 방식에는 크게 2가지</li>
<li>인스턴스에 상태를 저장하거나(아마도 바운스 메소드로 첨부되었을 것) 혹은 클로저에 저장한다(내부 함수)</li>
<li>2가지 기술 중에서는 함수에 기반해서 만드는 클로저가 조금 더 가볍고 자연스러움</li>
<li>클로저는 자동으로 사용하는 변수를 고정시키기 때문에, 저장해야 하는 정확한 상태를 걱정하지 않아도 됨(코드에서 자동으로 결정됨)</li>
<li>클로저를 사용하면 수정 가능한 변수를 조심해서 사용</li>
<li>nonlocal 선언은 sequence 변수가 콜백 내부에서 수정됨을 가리킴</li>
<li>이 선언이 없으면 에러가 발생</li>
<li>콜백 핸들러로 코루틴을 사용하는 것은 클로저 방식과 밀접한 관련이 있음</li>
<li>코루틴은 단순히 하나의 함수로 이루어져 있기 때문에 더 깔끔하다고 볼 수 있음</li>
<li>게다가 nonlocal 선언 없이도 자유롭게 변수를 수정할 수 있음</li>
<li>코루틴의 잠재적 단점은 파이썬의 기능으로 받아들여지지 않을 때가 있다는 것</li>
<li>또한 코루틴을 사용하기 전에 next()를 호출해야 한다는 점도 있음. 이를 망각하기 쉽다.</li>
<li>그렇기는 하지만, 인라인 콜백의 정의와 같이 코루틴을 사용하기 좋은 경우도 있음</li>
<li>partial() 관련 마지막 기술은, 해야 하는 작업이 추가적인 값을 콜백에 전달하는 것뿐일 때 유용</li>
<li>partial()을 사용하지 않으면 동일한 작업을 lambda로 해결</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [119]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">apply_async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">callback</span><span class="o">=</span><span class="k">lambda</span> <span class="n">r</span><span class="p">:</span> <span class="n">handler</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">seq</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[3] Got: 5
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>partial()로 매개변수를 바꾸는 더 많은 예제는 레시피 7.8에 나옴</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7.11-인라인-콜백-함수">7.11 인라인 콜백 함수<a class="anchor-link" href="posts/books/python_cookbook/ch07/#7.11-%EC%9D%B8%EB%9D%BC%EC%9D%B8-%EC%BD%9C%EB%B0%B1-%ED%95%A8%EC%88%98">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>콜백 함수를 사용하는 코드를 작성하느넫, 크기가 작은 함수를 너무 많이 만들어 낼까 걱정이 됨</li>
<li>코드가 좀 더 정상적인 절차적 단계를 거치도록 하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>generator와 coroutine을 사용하면 콜백 함수를 함수 내부에 넣을 수 있음</li>
<li>예를 들어 어떤 작업을 하고 콜백을 호출하는 다음 코드를 보자(레시피 7.10)</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [120]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">apply_async</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">callback</span><span class="p">):</span>
    <span class="c1"># 결과 계산</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
    
    <span class="c1"># 결과값으로 콜백 함수 호출</span>
    <span class="n">callback</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이제 Async 클래스와 inlined_async 데코레이터를 포함하고 있는 지원 코드를 보자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [121]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">queue</span> <span class="k">import</span> <span class="n">Queue</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">wraps</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [125]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Async</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">func</span> <span class="o">=</span> <span class="n">func</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="n">args</span>
        
<span class="k">def</span> <span class="nf">inlined_async</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="nd">@wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="n">result_queue</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
        <span class="n">result_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="n">result_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
                <span class="n">apply_async</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">func</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">args</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">result_queue</span><span class="o">.</span><span class="n">put</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">break</span>
    <span class="c1"># return wrapper만 하기 때문에 ()를 연 후에 인자값을 넣어주면 wrapper의 인자로</span>
    <span class="c1"># 전달됨..</span>
    <span class="c1"># 그렇게 해서 closure 함수가 인자를 받으 수 있게 되는 거다!!!</span>
    <span class="k">return</span> <span class="n">wrapper</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h5 id="closure-함수가-인자를-받는-방법">closure 함수가 인자를 받는 방법<a class="anchor-link" href="posts/books/python_cookbook/ch07/#closure-%ED%95%A8%EC%88%98%EA%B0%80-%EC%9D%B8%EC%9E%90%EB%A5%BC-%EB%B0%9B%EB%8A%94-%EB%B0%A9%EB%B2%95">¶</a>
</h5>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>2개의 코드 조각이 있으면 yield 구문으로 콜백 단계를 inline 할 수 있다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [126]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [127]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nd">@inlined_async</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="n">r</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">Async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">Async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="s1">'hello'</span><span class="p">,</span> <span class="s1">'world'</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">r</span> <span class="o">=</span> <span class="k">yield</span> <span class="n">Async</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Goodbye'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [128]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5
helloworld
0
2
4
6
8
10
12
14
16
18
Goodbye
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>특별 데코레이터와 yield를 제외하고는 아무런 콜백 함수가 나타나지 않았음을 확인할 수 있다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>이번 레시피를 통해 콜백 함수, 제너레이터, 컨트롤 플로우를 얼마나 잘 이해하고 있는지 알 수 있음</li>
<li>첫째로, 콜백과 관련있는 코드에서 현재 연산이 모두 연기되고 특정 포인트에서 재시작한다는 점(예: 비동기식)이 포인트</li>
<li>연산이 재시작하면 프로세싱을 위해 콜백이 실행된다.</li>
<li>apply_async() 함수는 콜백 실행의 필수 부위를 보여주는데, 사실 실제 프로그램에서는 스레드, 프로세스, 이벤트 핸들러 등이 연관되면서 훨씬 복잡</li>
<li>프로그램 실행이 연기되고 재시작하는 발상은 자연스럽게 제너레이터 함수의 실행 모델과 매핑됨</li>
<li>특히 yield 연산은 제너레이터 함수가 값을 분출하고 연기하도록 함</li>
<li>뒤이어 __next__()나 send() 메소드를 호출하면서 다시 실행됨</li>
</ul>
<ul>
<li>이 부분을 명심하고, 이번 레시피의 핵심은 inline_async() 데코레이터 함수에 있음</li>
<li>키포인트는 데코레이터가 yield 구문을 통해 제너레이터 함수를 하나씩 돈다는 것</li>
<li>이를 위해 겨로가 큐를 만들고 최소로 None을 넣는다.</li>
<li>그리고 순환문을 돌며 결과를 큐에서 꺼내 제너레이터로 보낸다.</li>
<li>여기서 다음 생성으로 넘어가고 Async 인스턴스를 받는다.</li>
<li>순환문은 함수와 인자를 보고 비동기 계산인 apply_async()를 시작함</li>
<li>하지만 여기서 가장 주의해야 할 부분은 이 동작이 일반적인 콜백 함수를 사용해서 이루어진 것이 아니라, 콜백이 큐 put() 메소드에 설정되었다는 것</li>
</ul>
<ul>
<li>이제 정확히 어떤 일이 벌어졌는지는 어느 정도 열린 상태이다.</li>
<li>메인 루프는 즉시 최상단으로 돌아가고 큐의 get()을 실행함</li>
<li>데이터가 있으면 put() 콜백이 넣은 결과일 것</li>
<li>아무것도 없다면 연산이 멈추었고, 결과값이 도착하길 기다리고 있는 것</li>
<li>실행 결과는 apply_async() 함수의 정확한 구현에 따라 달라짐</li>
<li>정말 이 코드가 잘 동작할지 의문이 든다면, 멀티프로세싱 라이브러리와 비도익 연산을 사용해 여러 프로세스에서 실행해 보면 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [129]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">multiprocessing</span>
    <span class="n">pool</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">()</span>
    <span class="n">apply_async</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">apply_async</span>
    
    <span class="c1"># 테스트 함수 실행</span>
    <span class="n">test</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>5
helloworld
0
2
4
6
8
10
12
14
16
18
Goodbye
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>결국 동작하는 것을 확인했는데, control flow가 어떻게 되는지 이해가 잘 되지 않는다면 조금 더 고민의 시간을 가져야 한다.</li>
<li>
<strong>복잡한 컨트롤 플로우</strong>를 <strong>제너레이터 함수에 숨기는 것</strong>은 표준 라이브러리와 서드파티 패키지에서 쉽게 찾을 수 있음</li>
<li>예를 들어 <strong>contextlib의 @contextmanager 데코레이터</strong>는 <strong>yield 구문을 통해 시작점과 종료점을 하나로 합치는 트릭을 수행</strong>
</li>
<li>유명한 패키지인 Twisted package 에도 유사한 콜백이 포함되어 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="7.12-클로저-내부에서-정의한-변수에-접근">7.12 클로저 내부에서 정의한 변수에 접근<a class="anchor-link" href="posts/books/python_cookbook/ch07/#7.12-%ED%81%B4%EB%A1%9C%EC%A0%80-%EB%82%B4%EB%B6%80%EC%97%90%EC%84%9C-%EC%A0%95%EC%9D%98%ED%95%9C-%EB%B3%80%EC%88%98%EC%97%90-%EC%A0%91%EA%B7%BC">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>클로저는 확장해서 내부 변수에 접근하고 수정하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>일반적으로 클로저 내부 변수는 외부와 완전히 단절되어 있음</li>
<li>하지만 접근 함수를 만들고 클로저에 함수 속성으로 붙이면 내부 변수에 접근 가능</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [148]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">sample</span><span class="p">():</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># 클로저 함수</span>
    <span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'n='</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        
    <span class="c1"># n에 대한 접근 메소드</span>
    <span class="k">def</span> <span class="nf">get_n</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">n</span>

    <span class="k">def</span> <span class="nf">set_n</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="k">nonlocal</span> <span class="n">n</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">value</span>

    <span class="c1"># 함수 속성으로 클로저에 붙임</span>
    <span class="n">func</span><span class="o">.</span><span class="n">get_n</span> <span class="o">=</span> <span class="n">get_n</span>
    <span class="n">func</span><span class="o">.</span><span class="n">set_n</span> <span class="o">=</span> <span class="n">set_n</span>
    <span class="k">return</span> <span class="n">func</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [149]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">sample</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [150]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>n= 0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [151]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">set_n</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [152]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>n= 10
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [153]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">get_n</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[153]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>10</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [154]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>n= 10
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch07/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>이번 레시피를 이루는 2가지 주요 기능</li>
<li>첫번째는 nonlocal 선언으로 내부 변수를 수정하는 함수를 작성하는 것</li>
<li>두번째는 접근 메소드를 클로저 함수에 붙여 마치 인스턴스 메소드인 것처럼 동작하는 것(클래스와는 아무런 연관이 없다)</li>
<li>이번 레시피를 조금 확장해서 클로저는 마치 클래스의 인스턴스인 것처럼 동작하게 만들 수 있음</li>
<li>내부 함수를 인스턴스 딕셔너리에 복사하고 반환하기만 하면 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [156]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>

<span class="k">class</span> <span class="nc">ClosureInstance</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">locals</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">locals</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">locals</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">_getframe</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">f_locals</span>
            
        <span class="c1"># 인스턴스 딕셔너리를 호출체로 갱신</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">locals</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                             <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
        
    <span class="c1"># 특별 메소드 리다이렉트(redirect)</span>
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s1">'__len__'</span><span class="p">]()</span>
    
<span class="c1"># 사용 예제</span>
<span class="k">def</span> <span class="nf">Stack</span><span class="p">():</span>
    <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">pop</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">items</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">():</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ClosureInstance</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [157]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">Stack</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [158]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[158]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;__main__.ClosureInstance at 0x108314748&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [159]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [160]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [161]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">push</span><span class="p">(</span><span class="s1">'Hello'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [162]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[162]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>3</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [163]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[163]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'Hello'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [164]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[164]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>20</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [165]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[165]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>10</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>흥미롭게도 이 코드는 일반 클래스 정의보다 실행 속도가 더 빠름</li>
<li>이 클래스와 속도를 비교해 볼 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [166]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Stack2</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
        
    <span class="k">def</span> <span class="nf">push</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">items</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [167]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">timeit</span> <span class="k">import</span> <span class="n">timeit</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [168]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 클로저</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Stack</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [169]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">'s.push(1);s.pop()'</span><span class="p">,</span> <span class="s1">'from __main__ import s'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[169]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>0.7697624979991815</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [172]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 클래스</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Stack2</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [173]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">timeit</span><span class="p">(</span><span class="s1">'s.push(1);s.pop()'</span><span class="p">,</span> <span class="s1">'from __main__ import s'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[173]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>0.8331443809984194</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>앞에 나온대로 클로저의 실행 속도가 약 8% 더 빠르다. 인스턴스 변수에 접근하는 속도가 빠르기 때문에 이와 같은 결과가 나옴</li>
<li>추가적인 self 변수를 사용하지 않아서 클로저의 실행 속도가 더 빠름</li>
<li>Raymond Hettinger는 이보다 더 극단적인 발상을 창안</li>
<li>하지만 정상적인 클래스를 두고 이런 요상한 코드를 실제 프로그래밍 과정에 사용할 사람이 얼마나 될까?</li>
<li>예를 들어 상속, 프로퍼티, 디스크립터, 클래스 메소드와 같은 주요 기능을 사용할 수도 없다.</li>
<li>또 몇몇 특별 메소드를 사용하기 위해서 비정상적인 코드를 작성할 필요도 생긴다.(ClosureInstance의 __len__() 구현 참고)</li>
<li>마지막으로, 코드를 읽는 다른 사람들이 이 괴상한 클래스가 무엇인지 혼란에 빠질 위험성도 있다.(그리고 도대체 왜 이 코드가 빠른지도 궁금해 할 것)</li>
<li>그렇지만 클로저의 내부에 접근하기 위해서 어떤 작업을 해야 하는지 자체가 흥미로운 예제</li>
<li>전체적으로 보면, 내부 상태 재설정, 버퍼 플러시, 캐시 삭제, 피드백 메커니즘 제공 등의 작업을 하고 싶을때 클로저에 메소드를 추가하면 더 많은 기능 제공</li>
</ul>
</div>
</div>
</div>
    </div>
  </div>

            </div>
        </div>
        <div class="post">
            <h1 class="title"><a href="posts/books/python_cookbook/ch06/">ch06</a></h1>
            <div class="meta">
                <div class="authordate">
                    <time class="timeago" datetime="2016-06-15T19:51:40-09:00">2016-06-15 19:51</time>
</div>
                <div class="stats">
                    
                </div>
                
            </div>
            <div class="body">
                <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="6.-데이터-인코딩과-프로세싱">6. 데이터 인코딩과 프로세싱<a class="anchor-link" href="posts/books/python_cookbook/ch06/#6.-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%9D%B8%EC%BD%94%EB%94%A9%EA%B3%BC-%ED%94%84%EB%A1%9C%EC%84%B8%EC%8B%B1">¶</a>
</h2>
<ul>
<li>start: 2014-10-07</li>
<li>end: 2014-10</li>
</ul>
<ul>
<li>CSV, JSON, XML, 바이너리 레코드 등으로 표현된 데이터를 다루는 방법을 알아봄</li>
<li>특정 알고리즘이 아닌 프로그램에 데이터를 넣고 빼는 방법에 집중</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6.1-CSV-데이터-읽고-쓰기">6.1 CSV 데이터 읽고 쓰기<a class="anchor-link" href="posts/books/python_cookbook/ch06/#6.1-CSV-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%9D%BD%EA%B3%A0-%EC%93%B0%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>CSV 파일로 인코딩된 데이터를 읽거나 쓰고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>대부분의 CSV 데이터는 csv 라이브러리를 사용</li>
<li>shocks.csv 파일에 담겨있는 주식 시장 정보가 있다고 가정</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>cat 06/reading_and_writing_csv_data/stocks.csv
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Symbol,Price,Date,Time,Change,Volume
"AA",39.48,"6/11/2007","9:36am",-0.18,181800
"AIG",71.38,"6/11/2007","9:36am",-0.15,195500
"AXP",62.58,"6/11/2007","9:36am",-0.46,935000
"BA",98.31,"6/11/2007","9:36am",+0.12,104800
"C",53.08,"6/11/2007","9:36am",-0.25,360900
"CAT",78.29,"6/11/2007","9:36am",-0.23,225400
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">csv</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/reading_and_writing_csv_data/stocks.csv'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f_csv</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">f_csv</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">f_csv</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>['Symbol', 'Price', 'Date', 'Time', 'Change', 'Volume']
['AA', '39.48', '6/11/2007', '9:36am', '-0.18', '181800']
['AIG', '71.38', '6/11/2007', '9:36am', '-0.15', '195500']
['AXP', '62.58', '6/11/2007', '9:36am', '-0.46', '935000']
['BA', '98.31', '6/11/2007', '9:36am', '+0.12', '104800']
['C', '53.08', '6/11/2007', '9:36am', '-0.25', '360900']
['CAT', '78.29', '6/11/2007', '9:36am', '-0.23', '225400']
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul><li>
</li></ul>
<p>앞에 나온 코드에서 row는 튜플이 됨</p>
<ul>
<li>따라서 특정 필드에 접근하려면 row[0](Symbol), row[4](Change)와 같이 인덱스를 사용해야 함</li>
</ul>
<ul>
<li>인덱스 사용이 떄때로 헷갈리기 때문에 named tuple을 고려</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">namedtuple</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/reading_and_writing_csv_data/stocks.csv'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f_csv</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">headings</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">f_csv</span><span class="p">)</span>
    <span class="n">Row</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'Row'</span><span class="p">,</span> <span class="n">headings</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Row</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">Row</span><span class="p">(</span><span class="o">*</span><span class="n">r</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class '__main__.Row'&gt;
Row(Symbol='CAT', Price='78.29', Date='6/11/2007', Time='9:36am', Change='-0.23', Volume='225400')
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">namedtuple</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/reading_and_writing_csv_data/stocks.csv'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f_csv</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">headings</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">f_csv</span><span class="p">)</span>
    <span class="n">Row</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'Row'</span><span class="p">,</span> <span class="n">headings</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">f_csv</span><span class="p">:</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">Row</span><span class="p">(</span><span class="o">*</span><span class="n">r</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="o">.</span><span class="n">Symbol</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">Price</span><span class="p">,</span> <span class="n">row</span><span class="o">.</span><span class="n">Date</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Row(Symbol='AA', Price='39.48', Date='6/11/2007', Time='9:36am', Change='-0.18', Volume='181800')
AA 39.48 6/11/2007

Row(Symbol='AIG', Price='71.38', Date='6/11/2007', Time='9:36am', Change='-0.15', Volume='195500')
AIG 71.38 6/11/2007

Row(Symbol='AXP', Price='62.58', Date='6/11/2007', Time='9:36am', Change='-0.46', Volume='935000')
AXP 62.58 6/11/2007

Row(Symbol='BA', Price='98.31', Date='6/11/2007', Time='9:36am', Change='+0.12', Volume='104800')
BA 98.31 6/11/2007

Row(Symbol='C', Price='53.08', Date='6/11/2007', Time='9:36am', Change='-0.25', Volume='360900')
C 53.08 6/11/2007

Row(Symbol='CAT', Price='78.29', Date='6/11/2007', Time='9:36am', Change='-0.23', Volume='225400')
CAT 78.29 6/11/2007

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이렇게 하면 row.Symbol 이나 row.Change와 같이 열 헤더를 사용할 수 있음</li>
<li>다만 열 헤더가 유효한 파이썬 식별자여야 한다.</li>
<li>그렇지 않으면 initial heading에 메시지를 보내서 식별자가 아닌 문자를 밑줄이나 유사한 것으로 변경해야 할지도 모름</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">csv</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/reading_and_writing_csv_data/stocks.csv'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="c1"># Dictionary Reader</span>
    <span class="n">f_csv</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">f_csv</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>{'Date': '6/11/2007', 'Change': '-0.18', 'Volume': '181800', 'Price': '39.48', 'Symbol': 'AA', 'Time': '9:36am'}
{'Date': '6/11/2007', 'Change': '-0.15', 'Volume': '195500', 'Price': '71.38', 'Symbol': 'AIG', 'Time': '9:36am'}
{'Date': '6/11/2007', 'Change': '-0.46', 'Volume': '935000', 'Price': '62.58', 'Symbol': 'AXP', 'Time': '9:36am'}
{'Date': '6/11/2007', 'Change': '+0.12', 'Volume': '104800', 'Price': '98.31', 'Symbol': 'BA', 'Time': '9:36am'}
{'Date': '6/11/2007', 'Change': '-0.25', 'Volume': '360900', 'Price': '53.08', 'Symbol': 'C', 'Time': '9:36am'}
{'Date': '6/11/2007', 'Change': '-0.23', 'Volume': '225400', 'Price': '78.29', 'Symbol': 'CAT', 'Time': '9:36am'}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 버전의 경우, 각 행의 요소에 접근하기 위해서 행 헤더를 사용함</li>
<li>예를 들어 row['Symbol'] 또는 row['Change'] 등과 같이 함</li>
<li>CSV 데이터를 쓰려면, csv 모듈을 사용해서 쓰기 객체를 생성함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Symbol'</span><span class="p">,</span> <span class="s1">'Price'</span><span class="p">,</span> <span class="s1">'Date'</span><span class="p">,</span> <span class="s1">'Time'</span><span class="p">,</span> <span class="s1">'Change'</span><span class="p">,</span> <span class="s1">'Volume'</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rows</span> <span class="o">=</span> <span class="p">[</span>
<span class="p">(</span><span class="s1">'AA'</span><span class="p">,</span> <span class="s1">'39.48'</span><span class="p">,</span> <span class="s1">'6/11/2007'</span><span class="p">,</span> <span class="s1">'9:36am'</span><span class="p">,</span> <span class="s1">'-0.18'</span><span class="p">,</span> <span class="s1">'181800'</span><span class="p">),</span>
<span class="p">(</span><span class="s1">'AIG'</span><span class="p">,</span> <span class="s1">'71.38'</span><span class="p">,</span> <span class="s1">'6/11/2007'</span><span class="p">,</span> <span class="s1">'9:36am'</span><span class="p">,</span> <span class="s1">'-0.15'</span><span class="p">,</span> <span class="s1">'195500'</span><span class="p">),</span>
<span class="p">(</span><span class="s1">'AXP'</span><span class="p">,</span> <span class="s1">'62.58'</span><span class="p">,</span> <span class="s1">'6/11/2007'</span><span class="p">,</span> <span class="s1">'9:36am'</span><span class="p">,</span> <span class="s1">'-0.46'</span><span class="p">,</span> <span class="s1">'935000'</span><span class="p">),</span>
<span class="p">(</span><span class="s1">'BA'</span><span class="p">,</span> <span class="s1">'98.31'</span><span class="p">,</span> <span class="s1">'6/11/2007'</span><span class="p">,</span> <span class="s1">'9:36am'</span><span class="p">,</span> <span class="s1">'+0.12'</span><span class="p">,</span> <span class="s1">'104800'</span><span class="p">),</span>
<span class="p">(</span><span class="s1">'C'</span><span class="p">,</span> <span class="s1">'53.08'</span><span class="p">,</span> <span class="s1">'6/11/2007'</span><span class="p">,</span> <span class="s1">'9:36am'</span><span class="p">,</span> <span class="s1">'-0.25'</span><span class="p">,</span> <span class="s1">'360900'</span><span class="p">),</span>
<span class="p">(</span><span class="s1">'CAT'</span><span class="p">,</span> <span class="s1">'78.29'</span><span class="p">,</span> <span class="s1">'6/11/2007'</span><span class="p">,</span> <span class="s1">'9:36am'</span><span class="p">,</span> <span class="s1">'-0.23'</span><span class="p">,</span> <span class="s1">'225400'</span><span class="p">),</span>
<span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/reading_and_writing_csv_data/stocks_mytuple.csv'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f_csv</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">f_csv</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
    <span class="n">f_csv</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>cat 06/reading_and_writing_csv_data/stocks_mytuple.csv
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>






</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rows</span> <span class="o">=</span> <span class="p">[</span>
<span class="p">{</span><span class="s1">'Date'</span><span class="p">:</span> <span class="s1">'6/11/2007'</span><span class="p">,</span> <span class="s1">'Change'</span><span class="p">:</span> <span class="s1">'-0.18'</span><span class="p">,</span> <span class="s1">'Volume'</span><span class="p">:</span> <span class="s1">'181800'</span><span class="p">,</span> 
 <span class="s1">'Price'</span><span class="p">:</span> <span class="s1">'39.48'</span><span class="p">,</span> <span class="s1">'Symbol'</span><span class="p">:</span> <span class="s1">'AA'</span><span class="p">,</span> <span class="s1">'Time'</span><span class="p">:</span> <span class="s1">'9:36am'</span><span class="p">},</span>
<span class="p">{</span><span class="s1">'Date'</span><span class="p">:</span> <span class="s1">'6/11/2007'</span><span class="p">,</span> <span class="s1">'Change'</span><span class="p">:</span> <span class="s1">'-0.15'</span><span class="p">,</span> <span class="s1">'Volume'</span><span class="p">:</span> <span class="s1">'195500'</span><span class="p">,</span> 
 <span class="s1">'Price'</span><span class="p">:</span> <span class="s1">'71.38'</span><span class="p">,</span> <span class="s1">'Symbol'</span><span class="p">:</span> <span class="s1">'AIG'</span><span class="p">,</span> <span class="s1">'Time'</span><span class="p">:</span> <span class="s1">'9:36am'</span><span class="p">},</span>
<span class="p">{</span><span class="s1">'Date'</span><span class="p">:</span> <span class="s1">'6/11/2007'</span><span class="p">,</span> <span class="s1">'Change'</span><span class="p">:</span> <span class="s1">'-0.46'</span><span class="p">,</span> <span class="s1">'Volume'</span><span class="p">:</span> <span class="s1">'935000'</span><span class="p">,</span> 
 <span class="s1">'Price'</span><span class="p">:</span> <span class="s1">'62.58'</span><span class="p">,</span> <span class="s1">'Symbol'</span><span class="p">:</span> <span class="s1">'AXP'</span><span class="p">,</span> <span class="s1">'Time'</span><span class="p">:</span> <span class="s1">'9:36am'</span><span class="p">},</span>
<span class="p">{</span><span class="s1">'Date'</span><span class="p">:</span> <span class="s1">'6/11/2007'</span><span class="p">,</span> <span class="s1">'Change'</span><span class="p">:</span> <span class="s1">'+0.12'</span><span class="p">,</span> <span class="s1">'Volume'</span><span class="p">:</span> <span class="s1">'104800'</span><span class="p">,</span> 
 <span class="s1">'Price'</span><span class="p">:</span> <span class="s1">'98.31'</span><span class="p">,</span> <span class="s1">'Symbol'</span><span class="p">:</span> <span class="s1">'BA'</span><span class="p">,</span> <span class="s1">'Time'</span><span class="p">:</span> <span class="s1">'9:36am'</span><span class="p">},</span>
<span class="p">{</span><span class="s1">'Date'</span><span class="p">:</span> <span class="s1">'6/11/2007'</span><span class="p">,</span> <span class="s1">'Change'</span><span class="p">:</span> <span class="s1">'-0.25'</span><span class="p">,</span> <span class="s1">'Volume'</span><span class="p">:</span> <span class="s1">'360900'</span><span class="p">,</span> 
 <span class="s1">'Price'</span><span class="p">:</span> <span class="s1">'53.08'</span><span class="p">,</span> <span class="s1">'Symbol'</span><span class="p">:</span> <span class="s1">'C'</span><span class="p">,</span> <span class="s1">'Time'</span><span class="p">:</span> <span class="s1">'9:36am'</span><span class="p">},</span>
<span class="p">{</span><span class="s1">'Date'</span><span class="p">:</span> <span class="s1">'6/11/2007'</span><span class="p">,</span> <span class="s1">'Change'</span><span class="p">:</span> <span class="s1">'-0.23'</span><span class="p">,</span> <span class="s1">'Volume'</span><span class="p">:</span> <span class="s1">'225400'</span><span class="p">,</span> 
 <span class="s1">'Price'</span><span class="p">:</span> <span class="s1">'78.29'</span><span class="p">,</span> <span class="s1">'Symbol'</span><span class="p">:</span> <span class="s1">'CAT'</span><span class="p">,</span> <span class="s1">'Time'</span><span class="p">:</span> <span class="s1">'9:36am'</span><span class="p">}]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/reading_and_writing_csv_data/stocks_mydict.csv'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f_csv</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictWriter</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">headers</span><span class="p">)</span>
    <span class="n">f_csv</span><span class="o">.</span><span class="n">writeheader</span><span class="p">()</span>
    <span class="n">f_csv</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>cat 06/reading_and_writing_csv_data/stocks_mydict.csv
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>






</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>csv 데이터를 수동으로 다루는 프로그램을 작성하기보다는 csv 모듈을 사용하는 것이 훨씬 나은 선택</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 이렇게 하면 프로그래머가 일일이 처리해야 할 점이 많아진다.</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/reading_and_writing_csv_data/stocks.csv'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">','</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>['Symbol', 'Price', 'Date', 'Time', 'Change', 'Volume\n']
['"AA"', '39.48', '"6/11/2007"', '"9:36am"', '-0.18', '181800\n']
['"AIG"', '71.38', '"6/11/2007"', '"9:36am"', '-0.15', '195500\n']
['"AXP"', '62.58', '"6/11/2007"', '"9:36am"', '-0.46', '935000\n']
['"BA"', '98.31', '"6/11/2007"', '"9:36am"', '+0.12', '104800\n']
['"C"', '53.08', '"6/11/2007"', '"9:36am"', '-0.25', '360900\n']
['"CAT"', '78.29', '"6/11/2007"', '"9:36am"', '-0.23', '225400\n']
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>예를 들어 필드가 따옴표로 둘러싸인 경우 이 따옴표를 잘라내야 한다.</li>
<li>또한 인용 필드에 쉼표가 있으면 행 크기를 잘못 인식해서 코드가 망가짐</li>
<li>기본적으로 csv 라이브러리는 Microsoft Excel 에서 사용하는 CSV 인코딩 규칙을 이해하도록 프로그램되어 있다.</li>
<li>이 방식이 가장 일반적이고 이식성도 가장 좋다. 하지만 csv의 문서를 보면 인코딩을 다른 형식으로 바꾸는 방법(구분자를 다른 문자로 바꾸는 등)이 나와 있음</li>
<li>예를 들어 탭으로 나누어진 데이터를 읽고 싶으면 다음과 같이 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>cat 06/reading_and_writing_csv_data/stocks.tsv
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Symbol	Price	Date	Time	Change	Volume
"AA"	39.48	"6/11/2007"	"9:36am"	-0.18	181800
"AIG"	71.38	"6/11/2007"	"9:36am"	-0.15	195500
"AXP"	62.58	"6/11/2007"	"9:36am"	-0.46	935000
"BA"	98.31	"6/11/2007"	"9:36am"	+0.12	104800
"C"	53.08	"6/11/2007"	"9:36am"	-0.25	360900
"CAT"	78.29	"6/11/2007"	"9:36am"	-0.23	225400
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 탭으로 구분한 값 읽기 예제</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/reading_and_writing_csv_data/stocks.tsv'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f_tsv</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">'</span><span class="se">\t</span><span class="s1">'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">f_tsv</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>['Symbol', 'Price', 'Date', 'Time', 'Change', 'Volume']
['AA', '39.48', '6/11/2007', '9:36am', '-0.18', '181800']
['AIG', '71.38', '6/11/2007', '9:36am', '-0.15', '195500']
['AXP', '62.58', '6/11/2007', '9:36am', '-0.46', '935000']
['BA', '98.31', '6/11/2007', '9:36am', '+0.12', '104800']
['C', '53.08', '6/11/2007', '9:36am', '-0.25', '360900']
['CAT', '78.29', '6/11/2007', '9:36am', '-0.23', '225400']
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>CSV 데이터를 읽고 네임드 튜플로 변환한다면 열 헤더를 검증할 때 주의해야 함</li>
<li>예를 들어 CSV 파일에 다음과 같이 유효하지 않은 식별 문자가 들어 있을 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">writefile</span> 06/reading_and_writing_csv_data/stocks_re.csv
Street Address, Num-Premises, Latitude, Longitude
5412 N CLARK, 10, 41.980262, -87.668452
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Writing 06/reading_and_writing_csv_data/stocks_re.csv
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>실제로 앞에 나온 데이터로 namedtuple을 만들 때 ValueError 예외가 발생함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">namedtuple</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/reading_and_writing_csv_data/stocks_re.csv'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f_csv</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">headings</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">f_csv</span><span class="p">)</span>
    <span class="n">Row</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'Row'</span><span class="p">,</span> <span class="n">headings</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">f_csv</span><span class="p">:</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">Row</span><span class="p">(</span><span class="o">*</span><span class="n">r</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-41-1421d40babee&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span>     f_csv <span class="ansi-blue-fg">=</span> csv<span class="ansi-blue-fg">.</span>reader<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span>     headings <span class="ansi-blue-fg">=</span> next<span class="ansi-blue-fg">(</span>f_csv<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">----&gt; 5</span><span class="ansi-red-fg">     </span>Row <span class="ansi-blue-fg">=</span> namedtuple<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'Row'</span><span class="ansi-blue-fg">,</span> headings<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span>     <span class="ansi-green-fg">for</span> r <span class="ansi-green-fg">in</span> f_csv<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">      7</span>         row <span class="ansi-blue-fg">=</span> Row<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>r<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/collections/__init__.py</span> in <span class="ansi-cyan-fg">namedtuple</span><span class="ansi-blue-fg">(typename, field_names, verbose, rename)</span>
<span class="ansi-green-intense-fg ansi-bold">    336</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> name<span class="ansi-blue-fg">.</span>isidentifier<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    337</span>             raise ValueError('Type names and field names must be valid '
<span class="ansi-green-fg">--&gt; 338</span><span class="ansi-red-fg">                              'identifiers: %r' % name)
</span><span class="ansi-green-intense-fg ansi-bold">    339</span>         <span class="ansi-green-fg">if</span> _iskeyword<span class="ansi-blue-fg">(</span>name<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    340</span>             raise ValueError('Type names and field names cannot be a '

<span class="ansi-red-fg">ValueError</span>: Type names and field names must be valid identifiers: 'Street Address'</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>---------------------------------------------------------------------------
ValueError                                Traceback (most recent call last)
&lt;ipython-input-41-1421d40babee&gt; in &lt;module&gt;()
      3     f_csv = csv.reader(f)
      4     headings = next(f_csv)
----&gt; 5     Row = namedtuple('Row', headings)
      6     for r in f_csv:
      7         row = Row(*r)

/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/collections/__init__.py in namedtuple(typename, field_names, verbose, rename)
    336         if not name.isidentifier():
    337             raise ValueError('Type names and field names must be valid '
--&gt; 338                              'identifiers: %r' % name)
    339         if _iskeyword(name):
    340             raise ValueError('Type names and field names cannot be a '

ValueError: Type names and field names must be valid identifiers: 'Street Address'</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [65]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">namedtuple</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Help on function namedtuple in module collections:

namedtuple(typename, field_names, verbose=False, rename=False)
    Returns a new subclass of tuple with named fields.
    
    &gt;&gt;&gt; Point = namedtuple('Point', ['x', 'y'])
    &gt;&gt;&gt; Point.__doc__                   # docstring for the new class
    'Point(x, y)'
    &gt;&gt;&gt; p = Point(11, y=22)             # instantiate with positional args or keywords
    &gt;&gt;&gt; p[0] + p[1]                     # indexable like a plain tuple
    33
    &gt;&gt;&gt; x, y = p                        # unpack like a regular tuple
    &gt;&gt;&gt; x, y
    (11, 22)
    &gt;&gt;&gt; p.x + p.y                       # fields also accessable by name
    33
    &gt;&gt;&gt; d = p._asdict()                 # convert to a dictionary
    &gt;&gt;&gt; d['x']
    11
    &gt;&gt;&gt; Point(**d)                      # convert from a dictionary
    Point(x=11, y=22)
    &gt;&gt;&gt; p._replace(x=100)               # _replace() is like str.replace() but targets named fields
    Point(x=100, y=22)

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [71]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">namedtuple</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/reading_and_writing_csv_data/stocks_re.csv'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f_csv</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="c1"># h.strip()을 해준 상태로 정규표현식 적용이 되야 공백이 _로 바뀌지 않는다.</span>
    <span class="c1"># 책에는 공백이 없이 나왔는데 내가 임의로 넣어서 그렇네.</span>
    <span class="n">headings</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s1">'[^a-zA-Z_]'</span><span class="p">,</span> <span class="s1">'_'</span><span class="p">,</span> <span class="n">h</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span> <span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="nb">next</span><span class="p">(</span><span class="n">f_csv</span><span class="p">)]</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">headings</span><span class="p">)</span>
    <span class="n">Row</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'Row112'</span><span class="p">,</span> <span class="n">headings</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">f_csv</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>
            <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">Row</span><span class="p">(</span><span class="o">*</span><span class="n">r</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>['Street_Address', 'Num_Premises', 'Latitude', 'Longitude']
['5412 N CLARK', ' 10', ' 41.980262', ' -87.668452']
Row112(Street_Address='5412 N CLARK', Num_Premises='10', Latitude='41.980262', Longitude='-87.668452')

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [76]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [79]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [85]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 원소 하나씩 각 자리에 매칭</span>
<span class="c1"># 0, 1, 2, 3, 4</span>
<span class="n">test</span><span class="p">(</span><span class="o">*</span><span class="n">l</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[85]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>10</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [86]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-86-7fe4e9895749&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>test<span class="ansi-blue-fg">(</span>l<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">&lt;ipython-input-79-dec58629daf7&gt;</span> in <span class="ansi-cyan-fg">test</span><span class="ansi-blue-fg">(*args)</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-green-fg">def</span> test<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">----&gt; 2</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> sum<span class="ansi-blue-fg">(</span>args<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">TypeError</span>: unsupported operand type(s) for +: 'int' and 'range'</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>또한 csv는 데이터를 해석하려 하거나 문자열이 아닌 형식으로 변환하려 하지 않는다는 점이 중요</li>
<li>그런 변환이 중요하다면 프로그래머가 스스로 해야함</li>
<li>CSV 데이터에 대해서 추가적인 형식 변환을 하는 예제</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [56]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">col_types</span> <span class="o">=</span> <span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [58]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/reading_and_writing_csv_data/stocks.csv'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f_csv</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">f_csv</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">f_csv</span><span class="p">:</span>
        <span class="c1"># 행 아이템에 변환 적용</span>
        <span class="n">row</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">convert</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">convert</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">col_types</span><span class="p">,</span> <span class="n">row</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>('AA', 39.48, '6/11/2007', '9:36am', -0.18, 181800)
('AIG', 71.38, '6/11/2007', '9:36am', -0.15, 195500)
('AXP', 62.58, '6/11/2007', '9:36am', -0.46, 935000)
('BA', 98.31, '6/11/2007', '9:36am', 0.12, 104800)
('C', 53.08, '6/11/2007', '9:36am', -0.25, 360900)
('CAT', 78.29, '6/11/2007', '9:36am', -0.23, 225400)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>딕셔너리에서 선택한 필드만 변환하는 예제</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [87]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'Reading as dicts with type conversion'</span><span class="p">)</span>
<span class="n">field_types</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">'Price'</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
               <span class="p">(</span><span class="s1">'Change'</span><span class="p">,</span> <span class="nb">float</span><span class="p">),</span>
               <span class="p">(</span><span class="s1">'Volume'</span><span class="p">,</span> <span class="nb">int</span><span class="p">)]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Reading as dicts with type conversion
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [88]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/reading_and_writing_csv_data/stocks.csv'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">csv</span><span class="o">.</span><span class="n">DictReader</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
        <span class="n">row</span><span class="o">.</span><span class="n">update</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="n">conversion</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>
                   <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">conversion</span> <span class="ow">in</span> <span class="n">field_types</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>{'Date': '6/11/2007', 'Change': -0.18, 'Volume': 181800, 'Price': 39.48, 'Symbol': 'AA', 'Time': '9:36am'}
{'Date': '6/11/2007', 'Change': -0.15, 'Volume': 195500, 'Price': 71.38, 'Symbol': 'AIG', 'Time': '9:36am'}
{'Date': '6/11/2007', 'Change': -0.46, 'Volume': 935000, 'Price': 62.58, 'Symbol': 'AXP', 'Time': '9:36am'}
{'Date': '6/11/2007', 'Change': 0.12, 'Volume': 104800, 'Price': 98.31, 'Symbol': 'BA', 'Time': '9:36am'}
{'Date': '6/11/2007', 'Change': -0.25, 'Volume': 360900, 'Price': 53.08, 'Symbol': 'C', 'Time': '9:36am'}
{'Date': '6/11/2007', 'Change': -0.23, 'Volume': 225400, 'Price': 78.29, 'Symbol': 'CAT', 'Time': '9:36am'}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이런 변환을 할 때는 주의를 기울여야 함</li>
<li>실제 프로그램을 작성할 때 CSV 파일에 값이 빠지거나 데이터가 망가져 있는 등 <strong>타입 변환에서 문제가 될 만한 이슈</strong>가 많다.</li>
<li>따라서 데이터에 에러가 없다고 보장하지 않는 이상은 항상 이 부분을 고려해야 한다.(<strong>적절한 예외처리 코드</strong>를 넣는 것이 좋다.)</li>
<li>마지막으로, CSV 데이터를 읽어 데이터 분석이나 통계에 활용하려는 경우 pandas 패키지 사용 고려</li>
<li>pandas의 pandas.read_csv() 함수르 사용하면 CSV 데이터를 DataFrame 객체에 불러올 수 있음</li>
<li>그 후에 데이터를 걸러내거나 통계 요약을 보는 등 상위 레벨 작업을 수행할 수 있음. 예제는 레시피 6.13 참고</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6.2-JSON-데이터-읽고-쓰기">6.2 JSON 데이터 읽고 쓰기<a class="anchor-link" href="posts/books/python_cookbook/ch06/#6.2-JSON-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%9D%BD%EA%B3%A0-%EC%93%B0%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>JSON(JavaScript Object Notation)으로 인코딩된 데이터를 읽거나 쓰고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>JSON으로 데이터를 인코딩, 디코딩하는 쉬운 방법은 json 모듈을 사용하는 것</li>
<li>주요 함수는 json.dumps()와 json.loads()이고, pickle과 같은 직렬화 라이브러리에서 사용한 것과 인터페이스는 동일</li>
<li>파이썬 데이터를 JSON으로 변환하는 코드를 보자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [89]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
<span class="s1">'name'</span><span class="p">:</span> <span class="s1">'ACME'</span><span class="p">,</span>
<span class="s1">'shares'</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
<span class="s1">'price'</span><span class="p">:</span> <span class="mf">542.23</span>
<span class="p">}</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>다음은 JSON 인코딩된 문자열을 파이썬 자료 구조로 돌리는 방법</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [91]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">json_str</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">json_str</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[91]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'{"name": "ACME", "shares": 100, "price": 542.23}'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>문자열이 아닌 파일로 작업한다면 json.dump()와 json.load()를 사용해서 JSON 데이터를 인코딩/디코딩 한다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [92]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># JSON 데이터 쓰기</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/data.json'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [93]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>cat 06/data.json
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>{"name": "ACME", "shares": 100, "price": 542.23}</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [94]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 데이터 다시 읽기</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/data.json'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[94]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>{'name': 'ACME', 'shares': 100, 'price': 542.23}</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>JSON 인코딩은 None, bool, int, float, str과 같은 기본 타입과 함께 리스트, 튜플, 딕셔너리와 같은 컨테이너 타입을 지원</li>
<li>딕셔너리의 경우 키는 문자열로 가정(문자열이 아닌 키는 인코딩 과정에서 문자열로 변환됨)</li>
<li>JSON 스펙을 따르기 위해서 파이썬 리스트와 딕셔너리만 인코딩해야 함</li>
<li>웹 애플리케이션의 경우에는 상위 레벨 객체는 딕셔너리로 하는 것이 표준</li>
<li>JSON 인코딩 포맷은 약간의 차이점을 제외하고는 파이썬 문법과 거의 동일</li>
<li>True는 true로 False는 false로 None은 null로 매핑됨</li>
<li>어떤 식으로 인코딩되는지 다음 코드를 참고</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [95]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[95]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'false'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [96]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'a'</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
     <span class="s1">'b'</span><span class="p">:</span> <span class="s1">'Hello'</span><span class="p">,</span>
     <span class="s1">'c'</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [97]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[97]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'{"c": null, "a": true, "b": "Hello"}'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>JSON에서 디코딩한 데이터를 조사해야 한다면, 단순히 출력해서 구조를 알아내기는 쉽지 않음</li>
<li>특히 데이터에 중첩이 심하게 된 구조체가 포함되어 있거나 필드가 많다면 더 어렵다</li>
<li>pprint 모듈의 pprint() 함수를 사용해 보자</li>
<li>이 함수는 키를 알파벳 순으로 나열하고 딕셔너리를 좀 더 보기 좋게 출력함</li>
<li>다음 코드를 통해 트위터의 검색 결과를 더 예쁘게 출력하는 방법을 보자</li>
<li>pprint 사용하면 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>일반적으로 JSON 디코딩은 제공받은 데이터로부터 딕셔너리나 리스트를 생성</li>
<li>다른 종류의 객체를 만들고 싶다면 json.loads()에 object pairs hook나 object hook를 넣음</li>
<li>OrderedDict의 순서를 지키면서 JSON 데이터를 디코딩하려면?</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [109]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># JSON은 "만 큰따옴표로 인식한다.</span>
<span class="c1"># string이다. </span>
<span class="n">s</span> <span class="o">=</span> <span class="s1">'{"name": "ACME", "shares": 50, "price": 490.1}'</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [110]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [111]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[111]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'{"name": "ACME", "shares": 50, "price": 490.1}'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [113]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">object_pairs_hook</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[113]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>OrderedDict([('name', 'ACME'), ('shares', 50), ('price', 490.1)])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>다음은 JSON 딕셔너리를 파이썬 객체로 바꾸는 예시</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [114]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">JSONObject</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span> <span class="o">=</span> <span class="n">d</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [117]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">object_hook</span><span class="o">=</span><span class="n">JSONObject</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[117]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;__main__.JSONObject at 0x10c73bf60&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [118]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">name</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[118]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'ACME'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [119]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shares</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[119]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>50</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [120]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">price</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[120]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>490.1</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>마지막 예제에서, JSON 데이터를 디코딩하여 생성한 딕셔너리를 __init__()에 인자로 전달</li>
<li>여기부터는 객체의 딕셔너리 인스턴스인 것처럼 자유롭게 사용해도 좋음</li>
<li>JSON을 인코딩할 때 유용한 옵션</li>
<li>출력을 더 보기 좋게 하려면 json.dumps()에 indent 인자를 사용</li>
<li>그렇게 하면 pprint() 함수를 사용한 것처럼 보기 좋게 들여쓰기 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [122]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">object_pairs_hook</span><span class="o">=</span><span class="n">OrderedDict</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[122]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>OrderedDict([('name', 'ACME'), ('shares', 50), ('price', 490.1)])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [123]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>{"name": "ACME", "shares": 50, "price": 490.1}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [124]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>{
    "name": "ACME",
    "shares": 50,
    "price": 490.1
}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>출력에서 키를 정렬하고 싶다면 sort_keys 인자 사용</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [126]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>{"name": "ACME", "price": 490.1, "shares": 50}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [128]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>{
    "name": "ACME",
    "price": 490.1,
    "shares": 50
}
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>인스턴스는 일반적으로 JSON으로 직렬화하지 않음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [171]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Point</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [172]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [173]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-173-d449655131f5&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>json<span class="ansi-blue-fg">.</span>dumps<span class="ansi-blue-fg">(</span>p<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4/json/__init__.py</span> in <span class="ansi-cyan-fg">dumps</span><span class="ansi-blue-fg">(obj, skipkeys, ensure_ascii, check_circular, allow_nan, cls, indent, separators, default, sort_keys, **kw)</span>
<span class="ansi-green-intense-fg ansi-bold">    228</span>         cls <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">and</span> indent <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">and</span> separators <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span> <span class="ansi-green-fg">and</span>
<span class="ansi-green-intense-fg ansi-bold">    229</span>         default is None and not sort_keys and not kw):
<span class="ansi-green-fg">--&gt; 230</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> _default_encoder<span class="ansi-blue-fg">.</span>encode<span class="ansi-blue-fg">(</span>obj<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    231</span>     <span class="ansi-green-fg">if</span> cls <span class="ansi-green-fg">is</span> <span class="ansi-green-fg">None</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    232</span>         cls <span class="ansi-blue-fg">=</span> JSONEncoder

<span class="ansi-green-fg">/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4/json/encoder.py</span> in <span class="ansi-cyan-fg">encode</span><span class="ansi-blue-fg">(self, o)</span>
<span class="ansi-green-intense-fg ansi-bold">    190</span>         <span class="ansi-red-fg"># exceptions aren't as detailed.  The list call should be roughly</span>
<span class="ansi-green-intense-fg ansi-bold">    191</span>         <span class="ansi-red-fg"># equivalent to the PySequence_Fast that ''.join() would do.</span>
<span class="ansi-green-fg">--&gt; 192</span><span class="ansi-red-fg">         </span>chunks <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>iterencode<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">,</span> _one_shot<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    193</span>         <span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> isinstance<span class="ansi-blue-fg">(</span>chunks<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">(</span>list<span class="ansi-blue-fg">,</span> tuple<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    194</span>             chunks <span class="ansi-blue-fg">=</span> list<span class="ansi-blue-fg">(</span>chunks<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4/json/encoder.py</span> in <span class="ansi-cyan-fg">iterencode</span><span class="ansi-blue-fg">(self, o, _one_shot)</span>
<span class="ansi-green-intense-fg ansi-bold">    248</span>                 self<span class="ansi-blue-fg">.</span>key_separator<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>item_separator<span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>sort_keys<span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">    249</span>                 self.skipkeys, _one_shot)
<span class="ansi-green-fg">--&gt; 250</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> _iterencode<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    251</span> 
<span class="ansi-green-intense-fg ansi-bold">    252</span> def _make_iterencode(markers, _default, _encoder, _indent, _floatstr,

<span class="ansi-green-fg">/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4/json/encoder.py</span> in <span class="ansi-cyan-fg">default</span><span class="ansi-blue-fg">(self, o)</span>
<span class="ansi-green-intense-fg ansi-bold">    171</span> 
<span class="ansi-green-intense-fg ansi-bold">    172</span>         """
<span class="ansi-green-fg">--&gt; 173</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">raise</span> TypeError<span class="ansi-blue-fg">(</span>repr<span class="ansi-blue-fg">(</span>o<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">+</span> <span class="ansi-blue-fg">" is not JSON serializable"</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    174</span> 
<span class="ansi-green-intense-fg ansi-bold">    175</span>     <span class="ansi-green-fg">def</span> encode<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> o<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">TypeError</span>: &lt;__main__.Point object at 0x10c7a70f0&gt; is not JSON serializable</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>인터페이스를 직렬화하고 싶다면 인스턴스를 입력으로 받아 직렬화 가능한 딕셔너리를 반환하는 함수 제공</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [174]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">serialize_instance</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">'__classname__'</span><span class="p">:</span> <span class="nb">type</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span><span class="o">.</span><span class="n">__name__</span> <span class="p">}</span>
    <span class="n">d</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">vars</span><span class="p">(</span><span class="n">obj</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">d</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>인스턴스를 돌려받고 싶다면 다음과 같은 코드 작성</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [175]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 알려지지 않은 클래스에 이름을 매핑하는 딕셔너리</span>
<span class="n">classes</span> <span class="o">=</span> <span class="p">{</span>
<span class="s1">'Point'</span><span class="p">:</span> <span class="n">Point</span>
<span class="p">}</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [192]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">unserialize_object</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
    <span class="n">clsname</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">'__classname__'</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">clsname</span><span class="p">:</span>
        <span class="n">cls</span> <span class="o">=</span> <span class="n">classes</span><span class="p">[</span><span class="n">clsname</span><span class="p">]</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span> <span class="c1"># __init__을 호출하지 않고 인스턴스 만들기</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="c1"># 아 이 줄 찾아 삼만리 했잖아. 책에는 들여쓰기가 되어있었다..</span>
        <span class="c1"># 그러니 x만 setting하고 obj를 돌려주니 y가 있을 수가 있나...</span>
        <span class="k">return</span> <span class="n">obj</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">d</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [193]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [194]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">serialize_instance</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [195]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> 
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[195]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'{"x": 2, "y": 3, "__classname__": "Point"}'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [196]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">object_hook</span><span class="o">=</span><span class="n">unserialize_object</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [197]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[197]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;__main__.Point at 0x10c744860&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [198]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">x</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[198]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>2</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [199]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">y</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[199]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>3</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>json 모듈에는 숫자, NaN과 같은 특별값 등 하위 레벨 조절을 위한 많은 옵션이 있음</li>
<li>자세한 내용은 공식 문서 참고</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6.3-단순한-XML-데이터-파싱">6.3 단순한 XML 데이터 파싱<a class="anchor-link" href="posts/books/python_cookbook/ch06/#6.3-%EB%8B%A8%EC%88%9C%ED%95%9C-XML-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%8C%8C%EC%8B%B1">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>단순한 XML 문서에서 데이터를 얻고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>단순한 XML 문서에서 데이터를 얻기 위해 xml.etree.ElementTree 모듈을 사용하면 됨</li>
<li>Planet Python에서 RSS 피드를 받아 파싱을 해야 한다고 가정</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [210]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">urllib.request</span> <span class="k">import</span> <span class="n">urlopen</span>
<span class="kn">from</span> <span class="nn">xml.etree.ElementTree</span> <span class="k">import</span> <span class="n">parse</span>
<span class="kn">import</span> <span class="nn">copy</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [221]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># RSS 피드를 다운로드하고 파싱한다.</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="s1">'http://planet.python.org/rss20.xml'</span><span class="p">)</span>
<span class="n">doc</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>

<span class="c1"># 관심있는 태그를 뽑아서 출력한다.</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">doc</span><span class="o">.</span><span class="n">iterfind</span><span class="p">(</span><span class="s1">'channel/item'</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s1">'title'</span><span class="p">)</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s1">'pubDate'</span><span class="p">)</span>
    <span class="n">link</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">findtext</span><span class="p">(</span><span class="s1">'link'</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">link</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Vasudev Ram: New: The Hacker News API (with Python support)
Tue, 07 Oct 2014 21:45:56 +0000
http://jugad2.blogspot.com/2014/10/new-hacker-news-api-with-python-support.html

Martin Fitzpatrick: Pathomx v3.0.0 Release Candidate 2
Tue, 07 Oct 2014 19:47:24 +0000
http://martinfitzpatrick.name/article/pathomx-v3.0.0rc2-for-windows-and-mac/

Machinalis: Embedding Interactive Maps into an IPython Notebook
Tue, 07 Oct 2014 16:07:31 +0000
http://www.machinalis.com/blog/embedding-interactive-maps-into-an-ipython-nb/

Calvin Spealman: The Lessons of Vim
Tue, 07 Oct 2014 13:00:00 +0000
http://techblog.ironfroggy.com/2014/10/the-lessons-of-vim.html

Catalin George Festila: Windows all modules for python 3.4
Tue, 07 Oct 2014 08:53:23 +0000
http://python-catalin.blogspot.com/2014/10/windows-all-modules-for-python-34.html

Glyph Lefkowitz: Thank You Lennart
Tue, 07 Oct 2014 08:32:00 +0000
https://glyph.twistedmatrix.com/2014/10/thanks-lennart.html

PyCon PL Conference: Attendees registration on PyCon PL 2014 is closed!
Tue, 07 Oct 2014 08:18:00 +0000
http://pl.pycon.org/2014/en/aktualnosci,Attendees-registration-on-PyCon-PL-2014-is-closed-,31

Denis Kurov: Django Authentication Workflow
Tue, 07 Oct 2014 00:49:46 +0000
http://makkalot-opensource.blogspot.com/2014/10/django-authentication-workflow.html

Stefan Behnel: Faster Fractions
Mon, 06 Oct 2014 18:46:28 +0000
http://blog.behnel.de/posts/faster-fractions.html

Mike C. Fletcher: Back to React Learning
Mon, 06 Oct 2014 17:45:54 +0000
http://blog.vrplumber.com/b/2014/10/06/back-react-learning/

A. Jesse Jiryu Davis: reStructured Text With Chrome And LiveReload
Mon, 06 Oct 2014 15:41:12 +0000
http://emptysqua.re/blog/restructured-text-chrome-livereload/

Calvin Spealman: The Year I Didn't Attend A Conference
Mon, 06 Oct 2014 15:00:00 +0000
http://techblog.ironfroggy.com/2014/10/the-year-i-didnt-attend-conference.html

Carl Trachte: Event report:  pycon.za
Mon, 06 Oct 2014 10:24:00 +0000
http://pyright.blogspot.com/2014/10/event-report-pyconza.html

Kay Hayen: Nuitka Release 0.5.5
Sun, 05 Oct 2014 21:15:00 +0000
http://nuitka.net/posts/nuitka-release-055.html

Julien Tayon: An opinionated versioning system based on mapping versions string to numbers in weird base
Sun, 05 Oct 2014 20:52:23 +0000
http://beauty-of-imagination.blogspot.com/2014/10/an-opinionated-versioning-system-based.html

Chris Moffitt: Using Sets for Data Analysis
Sun, 05 Oct 2014 17:15:00 +0000
http://pbpython.com/data-analysis-with-sets.html

Paul Everitt: Recent work with RelStorage
Sun, 05 Oct 2014 16:19:09 +0000
http://pauleveritt.wordpress.com/2014/10/05/recent-work-with-relstorage/

Vasudev Ram: Flattening an arbitrarily nested list in Python
Sun, 05 Oct 2014 04:53:42 +0000
http://jugad2.blogspot.com/2014/10/flattening-arbitrarily-nested-list-in.html

Calvin Spealman: The Uselessness of HTML Imports
Sun, 05 Oct 2014 02:23:00 +0000
http://techblog.ironfroggy.com/2014/10/the-uselessness-of-html-imports.html

Calvin Spealman: Duckling, A Date-Parsing Library That Makes Me Rethink About Parsing
Sun, 05 Oct 2014 01:45:00 +0000
http://techblog.ironfroggy.com/2014/10/ducking-date-parsing-library-that-makes.html

A. Jesse Jiryu Davis: Motor 0.3.3 Released
Sun, 05 Oct 2014 00:47:26 +0000
http://emptysqua.re/blog/motor-0-3-3-released/

Django Weblog: Update to Django Community Code of Conduct
Sat, 04 Oct 2014 12:45:00 +0000
https://www.djangoproject.com/weblog/2014/oct/04/update-django-community-code-conduct/

Malthe Borch: DIY Background Tasks on EC2
Sat, 04 Oct 2014 09:30:00 +0000
https://maltheborch.com/2014/10/diy-background-tasks-on-ec2.html

Kushal Das: Event report: PyCon India 2014
Fri, 03 Oct 2014 18:26:00 +0000
http://kushaldas.in/posts/event-report-pycon-india-2014.html

PyCharm: Feature Spotlight: Tracking code changes with Local History
Fri, 03 Oct 2014 16:45:21 +0000
http://feedproxy.google.com/~r/Pycharm/~3/5ntDdUJaeoc/

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>더 많은 작업을 원한다면 print()문을 더 흥미로운 것으로 바꾸보자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>많은 애플리케이션에서 XML로 인코딩된 데이터를 다룸</li>
<li>인터넷 상에서 데이터를 주고 받을 때 XML을 사용하는 곳이 많기도 하지만, 애플리케이션 데이터(워드 프로세싱, 음악 라이브러리 등)를 저장할 때도 일반적으로 사용하는 형식</li>
<li>많은 경우, XML이 데이터를 저장할 때 사용되면 문서 구조는 단순하고 이해하기 쉬움</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [250]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">xml.etree.ElementTree</span> <span class="k">import</span> <span class="n">dump</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="k">import</span> <span class="n">unquote</span>
<span class="kn">import</span> <span class="nn">html</span>
<span class="c1"># d = str(dump(doc))</span>
<span class="c1"># d[:100]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [241]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 이건 되는데..</span>
<span class="n">s</span> <span class="o">=</span> <span class="s1">'''&lt;description&gt;&amp;lt;br /&amp;gt;&amp;lt;p&amp;gt;&amp;lt;/p&amp;gt;By &amp;lt;a href="http://www.dancingbison.com"&amp;gt;Vasudev Ram&amp;lt;/a&amp;gt;&amp;lt;br /&amp;gt;&amp;lt;br /&amp;gt;&amp;lt;div class="separator"&amp;gt;&amp;lt;a href='''</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [242]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">html</span><span class="o">.</span><span class="n">unescape</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[242]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'&lt;description&gt;&lt;br /&gt;&lt;p&gt;&lt;/p&gt;By &lt;a href="http://www.dancingbison.com"&gt;Vasudev Ram&lt;/a&gt;&lt;br /&gt;&lt;br /&gt;&lt;div class="separator"&gt;&lt;a href='</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>xml.etree.ElementTree.parse() 함수가 XML 문서를 파싱하고 문서 객체로 만ㄷ름</li>
<li>여기서부터 특정 XML 요소를 찾기 위해 find(), iterfind(), findtext()와 같은 함수를 사용한다.</li>
<li>함수에서 사용하는 인자는 channel/item 또는 title과 같이 특정 태그의 이름을 사용함</li>
</ul>
<ul>
<li>태그를 명시할 때, 전체 문서 구조체를 고려해야 함</li>
<li>모든 찾기 작업은 시작 요소에 상대적으로 발생함</li>
<li>마찬가지로 함수에 전달하는 태그 이름 역시 시작에 상대적</li>
<li>예를 들어, doc.iterfind('channel/item') 호출은 'channel' 요소의 'item' 요소를 찾는다.</li>
<li>doc은 문서의 상단을 나타냄(상위 레벨 "rss" 요소). 그 이후 item.findtext() 호출은 "item" 요소를 찾은 곳에서 상대적으로 발생</li>
<li>ElementTree 모듈이 나타내는 모든 요소는 파싱에 유용한 요소와 메소드를 약간 가지고 있음</li>
<li>tag요소에는 태그의 이름, text 요소에는 담겨있는 텍스트가 포함되어 있고, 필요한 경우 get() 메소드로 요소를 얻을 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [251]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">doc</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[251]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;xml.etree.ElementTree.ElementTree at 0x10caaf518&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [252]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">e</span> <span class="o">=</span> <span class="n">doc</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'channel/title'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [253]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">e</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[253]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;Element 'title' at 0x10cc65138&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [254]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">tag</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[254]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'title'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [255]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">text</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[255]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'Planet Python'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [256]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">e</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'some_attribute'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>XML 파싱에 xml.etree.ElementTree 말고 다른 것을 사용할 수 있음</li>
<li>좀 더 고급 애플리케이션을 개발중이라면 lxml 사용 고려</li>
<li>ElementTree와 동일한 인터페이스를 사용하기 때문에 이번 레시피에 사용한 예제를 동일하게 사용 가능</li>
<li>단순히 처음 임포트 구문만 from xml.etree import parse로 바꾸면 됨</li>
<li>lxml은 XML 표준과 완벽히 동일한 헤택을 제공</li>
<li>또한 매우 빠르고 검증, XSLT, XPath와 같은 모든 기능 제공</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6.4-매우-큰-XML-파일-증분-파싱하기">6.4 매우 큰 XML 파일 증분 파싱하기<a class="anchor-link" href="posts/books/python_cookbook/ch06/#6.4-%EB%A7%A4%EC%9A%B0-%ED%81%B0-XML-%ED%8C%8C%EC%9D%BC-%EC%A6%9D%EB%B6%84-%ED%8C%8C%EC%8B%B1%ED%95%98%EA%B8%B0">¶</a>
</h3>
<ul>
<li>Pass</li>
<li>현재 내가 하고자 하는것과 어울리지 않음</li>
<li>그리고 재미가 없음..</li>
<li>나중에 다시 한 번 찾아보겠음</li>
</ul>
<h3 id="6.5-딕셔너리를-XML로-바꾸기">6.5 딕셔너리를 XML로 바꾸기<a class="anchor-link" href="posts/books/python_cookbook/ch06/#6.5-%EB%94%95%EC%85%94%EB%84%88%EB%A6%AC%EB%A5%BC-XML%EB%A1%9C-%EB%B0%94%EA%BE%B8%EA%B8%B0">¶</a>
</h3>
<h3 id="6.6-XML-파싱,-수정,-저장">6.6 XML 파싱, 수정, 저장<a class="anchor-link" href="posts/books/python_cookbook/ch06/#6.6-XML-%ED%8C%8C%EC%8B%B1,-%EC%88%98%EC%A0%95,-%EC%A0%80%EC%9E%A5">¶</a>
</h3>
<h3 id="6.7-네임스페이스로-XML-문서-파싱">6.7 네임스페이스로 XML 문서 파싱<a class="anchor-link" href="posts/books/python_cookbook/ch06/#6.7-%EB%84%A4%EC%9E%84%EC%8A%A4%ED%8E%98%EC%9D%B4%EC%8A%A4%EB%A1%9C-XML-%EB%AC%B8%EC%84%9C-%ED%8C%8C%EC%8B%B1">¶</a>
</h3>
<h3 id="6.8-관계형-데이터베이스-작업">6.8 관계형 데이터베이스 작업<a class="anchor-link" href="posts/books/python_cookbook/ch06/#6.8-%EA%B4%80%EA%B3%84%ED%98%95-%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%EC%9E%91%EC%97%85">¶</a>
</h3>
<h3 id="6.9-16진수-인코딩,-디코딩">6.9 16진수 인코딩, 디코딩<a class="anchor-link" href="posts/books/python_cookbook/ch06/#6.9-16%EC%A7%84%EC%88%98-%EC%9D%B8%EC%BD%94%EB%94%A9,-%EB%94%94%EC%BD%94%EB%94%A9">¶</a>
</h3>
<h3 id="6.10-Base64-인코딩,-디코딩">6.10 Base64 인코딩, 디코딩<a class="anchor-link" href="posts/books/python_cookbook/ch06/#6.10-Base64-%EC%9D%B8%EC%BD%94%EB%94%A9,-%EB%94%94%EC%BD%94%EB%94%A9">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>Base64를 사용한 바이너리 데이터를 인코딩, 디코딩해야 함</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>base64 모듈에 b64encode()와 b64decode() 함수를 사용하면 이 문제를 해결</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [258]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 바이트 데이터</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">b</span><span class="s1">'hello'</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [259]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Base64로 인코딩</span>
<span class="kn">import</span> <span class="nn">base64</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="n">a</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[259]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>b'aGVsbG8='</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [260]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Base64를 디코딩</span>
<span class="n">base64</span><span class="o">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[260]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>b'hello'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>Base64 인코딩은 바이트 문자열과 바이트 배열과 같은 바이트 데이터에만 사용하도록 디자인</li>
<li>또한 인코딩의 결과물은 항상 바이트 문자열이 됨</li>
<li>Base64 인코딩 데이터와 유니코드 텍스트를 함께 사용하려면 추가적인 디코딩 작업을 거쳐야 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [262]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">b64encode</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'ascii'</span><span class="p">)</span>
<span class="n">a</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[262]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'aGVsbG8='</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Base64를 디코딩할 때 바이크 문자열과 유니코드 텍스트를 사용할 수 있음. 하지만 유니코드 문자열에는 ASCII 문자만 포함해야 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6.11-바이너리-배열-구조체-읽고-쓰기">6.11 바이너리 배열 구조체 읽고 쓰기<a class="anchor-link" href="posts/books/python_cookbook/ch06/#6.11-%EB%B0%94%EC%9D%B4%EB%84%88%EB%A6%AC-%EB%B0%B0%EC%97%B4-%EA%B5%AC%EC%A1%B0%EC%B2%B4-%EC%9D%BD%EA%B3%A0-%EC%93%B0%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>바이너리 배열 구조를 파이썬 튜플로 읽거나 쓰고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>바이너리 데이터를 다루기 위해서 struct 모듈 사용</li>
<li>struct를 사용해서 튜플을 인코딩하는 식으로 파이썬 튜플을 바이너리 파일에 써보자.</li>
<li><a href="https://docs.python.org/2/library/struct.html">7.3. struct â Interpret strings as packed binary data — Python 2.7.8 documentation</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">struct</span> <span class="k">import</span> <span class="n">Struct</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">write_records</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="nb">format</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
    <span class="sd">'''일련의 튜플을 구조체의 바이너리 파일에 기록'''</span>
    <span class="n">record_struct</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">records</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">record_struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="o">*</span><span class="n">r</span><span class="p">))</span>
        
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">records</span> <span class="o">=</span> <span class="p">[</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">),</span>
               <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">7.8</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">),</span>
               <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mf">13.4</span><span class="p">,</span> <span class="mf">56.7</span><span class="p">)]</span>
    
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/data.b'</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">write_records</span><span class="p">(</span><span class="n">records</span><span class="p">,</span> <span class="s1">'&lt;idd'</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>cat 06/data.b
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>   ffffff@      @   333333@      "@
   ������*@�����YL@</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 파일을 튜플 리스트로 읽어 들이는 방법은 여러가지</li>
<li>1: 파일을 조각 조각 읽어 들일 생각이라면 다음 코드 사용</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">struct</span> <span class="k">import</span> <span class="n">Struct</span>

<span class="k">def</span> <span class="nf">read_records</span><span class="p">(</span><span class="nb">format</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
    <span class="n">record_struct</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>
    <span class="n">chunks</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">record_struct</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">b</span><span class="s1">''</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">record_struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span> <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">chunks</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/data.b'</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">read_records</span><span class="p">(</span><span class="s1">'&lt;idd'</span><span class="p">,</span> <span class="n">f</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>(1, 2.3, 4.5)
(6, 7.8, 9.0)
(12, 13.4, 56.7)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>파일을 바이트 문자열에 한 번에 읽어 들이고 추후 여러 조각으로 변환</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">struct</span> <span class="k">import</span> <span class="n">Struct</span>

<span class="k">def</span> <span class="nf">unpack_records</span><span class="p">(</span><span class="nb">format</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="n">record_struct</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">record_struct</span><span class="o">.</span><span class="n">unpack_from</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">offset</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">offset</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">record_struct</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'06/data.b'</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        
    <span class="k">for</span> <span class="n">rec</span> <span class="ow">in</span> <span class="n">unpack_records</span><span class="p">(</span><span class="s1">'&lt;idd'</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">rec</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>(1, 2.3, 4.5)
(6, 7.8, 9.0)
(12, 13.4, 56.7)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Skip-나중에-다시-보자">Skip 나중에 다시 보자<a class="anchor-link" href="posts/books/python_cookbook/ch06/#Skip-%EB%82%98%EC%A4%91%EC%97%90-%EB%8B%A4%EC%8B%9C-%EB%B3%B4%EC%9E%90">¶</a>
</h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="6.13-데이터-용약과-통계-수행">6.13 데이터 용약과 통계 수행<a class="anchor-link" href="posts/books/python_cookbook/ch06/#6.13-%EB%8D%B0%EC%9D%B4%ED%84%B0-%EC%9A%A9%EC%95%BD%EA%B3%BC-%ED%86%B5%EA%B3%84-%EC%88%98%ED%96%89">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>커다란 dataset를 요약하거나 통계를 내고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>통계, 시계열 등과 연관있는 데이터 분석을 하려면 Pandas 라이브러리를 알아봐야 함</li>
<li>
<a href="https://data.cityofchicago.org/Service-Requests/311-Service-Requests-Rodent-Baiting/97t6-zrhs">시카고의 쥐와 설치류 데이터베이스</a>(google 검색해서 찾음)를 Pandas로 분석하는 예제를 통해 맛보기를 해보자.</li>
<li>글을 쓰고 있는 현재 이 자료를 열면 CSV 파일에 74,000 개의 데이터가 들어있다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<blockquote>
<p>pip install pandas</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rats</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">'06/rats.csv'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rats</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[14]:</div>

<div class="output_html rendered_html output_subarea output_execute_result">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
<thead><tr style="text-align: right;">
<th></th>
      <th>Creation Date</th>
      <th>Status</th>
      <th>Completion Date</th>
      <th>Service Request Number</th>
      <th>Type of Service Request</th>
      <th>Number of Premises Baited</th>
      <th>Number of Premises with Garbage</th>
      <th>Number of Premises with Rats</th>
      <th>Current Activity</th>
      <th>Most Recent Action</th>
      <th>Street Address</th>
      <th>ZIP Code</th>
      <th>X Coordinate</th>
      <th>Y Coordinate</th>
      <th>Ward</th>
      <th>Police District</th>
      <th>Community Area</th>
      <th>Latitude</th>
      <th>Longitude</th>
      <th>Location</th>
    </tr></thead>
<tbody>
<tr>
<th>0     </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708674</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>    4908 W HUTCHINSON ST</td>
      <td> 60641</td>
      <td> 1142946.950001</td>
      <td> 1927808.160332</td>
      <td> 45</td>
      <td> 16</td>
      <td> 15</td>
      <td> 41.957953</td>
      <td>-87.749872</td>
      <td> (41.957952909185856, -87.74987175876076)</td>
    </tr>
<tr>
<th>1     </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708613</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>        6915 S BISHOP ST</td>
      <td> 60636</td>
      <td> 1167859.632111</td>
      <td> 1858888.135675</td>
      <td> 17</td>
      <td>  7</td>
      <td> 67</td>
      <td> 41.768329</td>
      <td>-87.660270</td>
      <td>  (41.768328601514455, -87.6602704707055)</td>
    </tr>
<tr>
<th>2     </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01707402</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>        1500 N AVERS AVE</td>
      <td> 60651</td>
      <td> 1150433.825895</td>
      <td> 1909696.767409</td>
      <td> 30</td>
      <td> 25</td>
      <td> 23</td>
      <td> 41.908111</td>
      <td>-87.722821</td>
      <td> (41.908110540569005, -87.72282129792974)</td>
    </tr>
<tr>
<th>3     </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01707381</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>        1400 N AVERS AVE</td>
      <td> 60651</td>
      <td> 1150455.039795</td>
      <td> 1909041.263606</td>
      <td> 30</td>
      <td> 25</td>
      <td> 23</td>
      <td> 41.906311</td>
      <td>-87.722761</td>
      <td>  (41.90631136039996, -87.72276050861144)</td>
    </tr>
<tr>
<th>4     </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708605</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>      5003 S KEDVALE AVE</td>
      <td> 60632</td>
      <td> 1149546.979381</td>
      <td> 1871115.957791</td>
      <td> 14</td>
      <td>  8</td>
      <td> 57</td>
      <td> 41.802257</td>
      <td>-87.727080</td>
      <td>  (41.80225730577933, -87.72707981049875)</td>
    </tr>
<tr>
<th>5     </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01707939</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>     4228 N LAWNDALE AVE</td>
      <td> 60618</td>
      <td> 1150966.422794</td>
      <td> 1927849.117493</td>
      <td> 39</td>
      <td> 17</td>
      <td> 16</td>
      <td> 41.957912</td>
      <td>-87.720388</td>
      <td> (41.957911681241406, -87.72038806227229)</td>
    </tr>
<tr>
<th>6     </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01707412</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td> 5129 N CENTRAL PARK AVE</td>
      <td> 60625</td>
      <td> 1151461.600423</td>
      <td> 1933842.899970</td>
      <td> 39</td>
      <td> 17</td>
      <td> 13</td>
      <td> 41.974349</td>
      <td>-87.718409</td>
      <td> (41.974349283846536, -87.71840945909008)</td>
    </tr>
<tr>
<th>7     </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01707409</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>     680 N LAKE SHORE DR</td>
      <td> 60611</td>
      <td> 1179659.954073</td>
      <td> 1905017.250129</td>
      <td> 42</td>
      <td> 18</td>
      <td>  8</td>
      <td> 41.894649</td>
      <td>-87.615604</td>
      <td>  (41.89464875944979, -87.61560417245973)</td>
    </tr>
<tr>
<th>8     </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01707407</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>       6223 N LE MAI AVE</td>
      <td> 60646</td>
      <td> 1140366.422315</td>
      <td> 1941009.134206</td>
      <td> 45</td>
      <td> 16</td>
      <td> 12</td>
      <td> 41.994225</td>
      <td>-87.759033</td>
      <td>  (41.99422528183371, -87.75903344019028)</td>
    </tr>
<tr>
<th>9     </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01707841</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>        6631 N MOZART ST</td>
      <td> 60645</td>
      <td> 1156129.162233</td>
      <td> 1943863.671887</td>
      <td> 50</td>
      <td> 24</td>
      <td>  2</td>
      <td> 42.001754</td>
      <td>-87.700973</td>
      <td>  (42.00175352887489, -87.70097332471786)</td>
    </tr>
<tr>
<th>10    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01707424</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>         11225 S TROY ST</td>
      <td> 60655</td>
      <td> 1157363.428932</td>
      <td> 1830008.682474</td>
      <td> 19</td>
      <td> 22</td>
      <td> 74</td>
      <td> 41.689297</td>
      <td>-87.699524</td>
      <td>  (41.68929742981148, -87.69952381260245)</td>
    </tr>
<tr>
<th>11    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01707631</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>        1240 W BARRY AVE</td>
      <td> 60657</td>
      <td> 1167484.356217</td>
      <td> 1920717.586612</td>
      <td> 32</td>
      <td> 19</td>
      <td>  6</td>
      <td> 41.938002</td>
      <td>-87.659869</td>
      <td>  (41.93800218559503, -87.65986853469147)</td>
    </tr>
<tr>
<th>12    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01707536</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>      9516 S OGLESBY AVE</td>
      <td> 60617</td>
      <td> 1193753.869877</td>
      <td> 1842362.443233</td>
      <td>  7</td>
      <td>  4</td>
      <td> 51</td>
      <td> 41.722385</td>
      <td>-87.565897</td>
      <td>  (41.72238546736288, -87.56589719418255)</td>
    </tr>
<tr>
<th>13    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708547</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>       4350 N CICERO AVE</td>
      <td> 60641</td>
      <td> 1143584.306419</td>
      <td> 1928578.821227</td>
      <td> 45</td>
      <td> 16</td>
      <td> 15</td>
      <td> 41.960056</td>
      <td>-87.747509</td>
      <td>  (41.96005573563926, -87.74750921768275)</td>
    </tr>
<tr>
<th>14    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708358</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>   11447 S CHAMPLAIN AVE</td>
      <td> 60628</td>
      <td> 1182622.317169</td>
      <td> 1829179.763628</td>
      <td>  9</td>
      <td>  5</td>
      <td> 50</td>
      <td> 41.686476</td>
      <td>-87.607077</td>
      <td>  (41.68647557183858, -87.60707728549757)</td>
    </tr>
<tr>
<th>15    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708287</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>       4544 N MOBILE AVE</td>
      <td> 60630</td>
      <td> 1133526.838073</td>
      <td> 1929663.931429</td>
      <td> 38</td>
      <td> 16</td>
      <td> 15</td>
      <td> 41.963216</td>
      <td>-87.784460</td>
      <td>  (41.96321611063977, -87.78446024221064)</td>
    </tr>
<tr>
<th>16    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01707967</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>     4232 N LAWNDALE AVE</td>
      <td> 60618</td>
      <td> 1150965.622794</td>
      <td> 1927876.017493</td>
      <td> 39</td>
      <td> 17</td>
      <td> 16</td>
      <td> 41.957986</td>
      <td>-87.720390</td>
      <td>  (41.95798551245732, -87.72039029600587)</td>
    </tr>
<tr>
<th>17    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708077</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>     4222 N LAWNDALE AVE</td>
      <td> 60618</td>
      <td> 1150967.622794</td>
      <td> 1927808.917493</td>
      <td> 39</td>
      <td> 17</td>
      <td> 16</td>
      <td> 41.957801</td>
      <td>-87.720385</td>
      <td> (41.957801346026415, -87.72038470773528)</td>
    </tr>
<tr>
<th>18    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708524</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>      5105 W OAKDALE AVE</td>
      <td> 60641</td>
      <td> 1141830.490628</td>
      <td> 1919133.826884</td>
      <td> 31</td>
      <td> 25</td>
      <td> 19</td>
      <td> 41.934171</td>
      <td>-87.754192</td>
      <td> (41.934170511750004, -87.75419177686257)</td>
    </tr>
<tr>
<th>19    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708469</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>            157 N ADA ST</td>
      <td> 60607</td>
      <td> 1167406.064126</td>
      <td> 1901226.677618</td>
      <td> 27</td>
      <td> 12</td>
      <td> 28</td>
      <td> 41.884520</td>
      <td>-87.660718</td>
      <td>  (41.88451962489873, -87.66071801603259)</td>
    </tr>
<tr>
<th>20    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708515</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>      5100 W OAKDALE AVE</td>
      <td> 60641</td>
      <td> 1141864.190628</td>
      <td> 1919134.626884</td>
      <td> 31</td>
      <td> 25</td>
      <td> 19</td>
      <td> 41.934172</td>
      <td>-87.754068</td>
      <td>  (41.93417208227522, -87.75406790849907)</td>
    </tr>
<tr>
<th>21    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708487</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>      2968 W CORTLAND ST</td>
      <td> 60647</td>
      <td> 1156082.406796</td>
      <td> 1912475.909782</td>
      <td> 35</td>
      <td> 14</td>
      <td> 22</td>
      <td> 41.915625</td>
      <td>-87.701996</td>
      <td>  (41.91562454305178, -87.70199606944088)</td>
    </tr>
<tr>
<th>22    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708852</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>     5909 N CALDWELL AVE</td>
      <td> 60646</td>
      <td> 1143646.655702</td>
      <td> 1938819.072178</td>
      <td> 39</td>
      <td> 17</td>
      <td> 12</td>
      <td> 41.988155</td>
      <td>-87.747022</td>
      <td> (41.988154601191624, -87.74702232204947)</td>
    </tr>
<tr>
<th>23    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01709769</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>      4633 W HARRISON ST</td>
      <td> 60644</td>
      <td> 1145592.447469</td>
      <td> 1896953.515994</td>
      <td> 24</td>
      <td> 11</td>
      <td> 25</td>
      <td> 41.873235</td>
      <td>-87.740929</td>
      <td>  (41.87323478970172, -87.74092940501316)</td>
    </tr>
<tr>
<th>24    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708704</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>    917 N LEAMINGTON AVE</td>
      <td> 60651</td>
      <td> 1141857.169506</td>
      <td> 1905615.879690</td>
      <td> 37</td>
      <td> 15</td>
      <td> 25</td>
      <td> 41.897075</td>
      <td>-87.754429</td>
      <td>  (41.89707530531422, -87.75442905943434)</td>
    </tr>
<tr>
<th>25    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708740</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>           938 W 31ST PL</td>
      <td> 60608</td>
      <td> 1170564.615678</td>
      <td> 1884008.799922</td>
      <td> 11</td>
      <td>  9</td>
      <td> 60</td>
      <td> 41.837204</td>
      <td>-87.649623</td>
      <td>  (41.83720388653583, -87.64962296601966)</td>
    </tr>
<tr>
<th>26    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708731</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>      4917 N KEDVALE AVE</td>
      <td> 60630</td>
      <td> 1147833.775395</td>
      <td> 1932352.027521</td>
      <td> 39</td>
      <td> 17</td>
      <td> 14</td>
      <td> 41.970329</td>
      <td>-87.731789</td>
      <td> (41.970328908371066, -87.73178863263537)</td>
    </tr>
<tr>
<th>27    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01708865</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>        3736 W PIPPIN ST</td>
      <td> 60652</td>
      <td> 1152766.583769</td>
      <td> 1853410.092421</td>
      <td> 18</td>
      <td>  8</td>
      <td> 70</td>
      <td> 41.753607</td>
      <td>-87.715738</td>
      <td>  (41.75360674492404, -87.71573839632325)</td>
    </tr>
<tr>
<th>28    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01709673</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>        1939 W NELSON ST</td>
      <td> 60657</td>
      <td> 1162881.847868</td>
      <td> 1920264.945468</td>
      <td> 32</td>
      <td> 19</td>
      <td>  5</td>
      <td> 41.936858</td>
      <td>-87.676796</td>
      <td>  (41.93685808352693, -87.67679637933988)</td>
    </tr>
<tr>
<th>29    </th>
      <td> 10/06/2014</td>
      <td>            Open</td>
      <td>        NaN</td>
      <td>            14-01709543</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>      2448 W SHERWIN AVE</td>
      <td> 60645</td>
      <td> 1158611.719992</td>
      <td> 1948725.540029</td>
      <td> 50</td>
      <td> 24</td>
      <td>  2</td>
      <td> 42.015044</td>
      <td>-87.691706</td>
      <td>   (42.01504397458928, -87.6917062515062)</td>
    </tr>
<tr>
<th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
<tr>
<th>135514</th>
      <td> 10/04/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01611595</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>     5836 S ARTESIAN AVE</td>
      <td> 60629</td>
      <td> 1161035.872799</td>
      <td> 1865896.970369</td>
      <td> 16</td>
      <td>  8</td>
      <td> 63</td>
      <td> 41.787706</td>
      <td>-87.685089</td>
      <td>  (41.78770562679793, -87.68508927571739)</td>
    </tr>
<tr>
<th>135515</th>
      <td> 10/03/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01605954</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>       2426 W PRATT BLVD</td>
      <td> 60645</td>
      <td> 1158807.060017</td>
      <td> 1945072.383824</td>
      <td> 50</td>
      <td> 24</td>
      <td>  2</td>
      <td> 42.005016</td>
      <td>-87.691088</td>
      <td>  (42.00501558156435, -87.69108831828841)</td>
    </tr>
<tr>
<th>135516</th>
      <td> 09/25/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01561251</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>       1428 S HAMLIN AVE</td>
      <td> 60623</td>
      <td> 1151278.490102</td>
      <td> 1892801.067007</td>
      <td> 24</td>
      <td> 10</td>
      <td> 29</td>
      <td> 41.861730</td>
      <td>-87.720162</td>
      <td>  (41.86173040969119, -87.72016189317569)</td>
    </tr>
<tr>
<th>135517</th>
      <td> 09/23/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01552578</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>     1341 N LOCKWOOD AVE</td>
      <td> 60651</td>
      <td> 1140777.668819</td>
      <td> 1908526.860010</td>
      <td> 37</td>
      <td> 25</td>
      <td> 25</td>
      <td> 41.905083</td>
      <td>-87.758322</td>
      <td>  (41.90508329625724, -87.75832229923284)</td>
    </tr>
<tr>
<th>135518</th>
      <td> 09/22/2010</td>
      <td>       Completed</td>
      <td> 01/07/2011</td>
      <td>            10-01545326</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>  1</td>
      <td>  0</td>
      <td>  1</td>
      <td>    Dispatch Crew</td>
      <td>                    Inspected and baited</td>
      <td>      1011 N LARAMIE AVE</td>
      <td> 60651</td>
      <td> 1141508.457520</td>
      <td> 1906237.199904</td>
      <td> 37</td>
      <td> 15</td>
      <td> 25</td>
      <td> 41.898787</td>
      <td>-87.755694</td>
      <td>   (41.89878673057768, -87.7556944800398)</td>
    </tr>
<tr>
<th>135519</th>
      <td> 09/14/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01483769</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>       7530 S WABASH AVE</td>
      <td> 60619</td>
      <td> 1178021.518474</td>
      <td> 1855100.707677</td>
      <td>  6</td>
      <td>  6</td>
      <td> 69</td>
      <td> 41.757711</td>
      <td>-87.623137</td>
      <td>  (41.75771122728605, -87.62313707074553)</td>
    </tr>
<tr>
<th>135520</th>
      <td> 09/14/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01486023</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>        5959 S LAFLIN ST</td>
      <td> 60636</td>
      <td> 1167354.393020</td>
      <td> 1865213.788830</td>
      <td> 16</td>
      <td>  7</td>
      <td> 67</td>
      <td> 41.785698</td>
      <td>-87.661941</td>
      <td> (41.785697828520156, -87.66194139257287)</td>
    </tr>
<tr>
<th>135521</th>
      <td> 09/13/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01476446</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>    9553 S PRINCETON AVE</td>
      <td> 60628</td>
      <td> 1175964.048381</td>
      <td> 1841578.557199</td>
      <td> 21</td>
      <td>  5</td>
      <td> 49</td>
      <td> 41.720651</td>
      <td>-87.631082</td>
      <td>  (41.72065109536011, -87.63108179029372)</td>
    </tr>
<tr>
<th>135522</th>
      <td> 09/01/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01409020</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>          1111 E 93RD ST</td>
      <td> 60619</td>
      <td> 1185291.743719</td>
      <td> 1843539.750299</td>
      <td>  8</td>
      <td>  4</td>
      <td> 47</td>
      <td> 41.725819</td>
      <td>-87.596855</td>
      <td>  (41.72581895961811, -87.59685549830274)</td>
    </tr>
<tr>
<th>135523</th>
      <td> 09/01/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01412884</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>          3913 W 57TH PL</td>
      <td> 60629</td>
      <td> 1151266.356900</td>
      <td> 1866188.264604</td>
      <td> 13</td>
      <td>  8</td>
      <td> 62</td>
      <td> 41.788702</td>
      <td>-87.720903</td>
      <td>  (41.78870152820766, -87.72090280848239)</td>
    </tr>
<tr>
<th>135524</th>
      <td> 08/30/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01390101</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>    7551 N CLAREMONT AVE</td>
      <td> 60645</td>
      <td> 1159347.169967</td>
      <td> 1949994.101985</td>
      <td> 49</td>
      <td> 24</td>
      <td>  2</td>
      <td> 42.018510</td>
      <td>-87.688965</td>
      <td>   (42.01850978301388, -87.6889649223713)</td>
    </tr>
<tr>
<th>135525</th>
      <td> 08/24/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01357763</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>    2428 N MAPLEWOOD AVE</td>
      <td> 60647</td>
      <td> 1158960.340079</td>
      <td> 1916052.316975</td>
      <td>  1</td>
      <td> 14</td>
      <td> 22</td>
      <td> 41.925380</td>
      <td>-87.691324</td>
      <td> (41.925379847343194, -87.69132439131293)</td>
    </tr>
<tr>
<th>135526</th>
      <td> 08/12/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01283620</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>      1718 W LE MOYNE ST</td>
      <td> 60622</td>
      <td> 1164664.151207</td>
      <td> 1910153.949810</td>
      <td>  1</td>
      <td> 14</td>
      <td> 24</td>
      <td> 41.909075</td>
      <td>-87.670533</td>
      <td>  (41.90907525072416, -87.67053340310254)</td>
    </tr>
<tr>
<th>135527</th>
      <td> 08/08/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01247571</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>      1410 W BERTEAU AVE</td>
      <td> 60613</td>
      <td> 1166079.712721</td>
      <td> 1928002.330313</td>
      <td> 47</td>
      <td> 19</td>
      <td>  6</td>
      <td> 41.958022</td>
      <td>-87.664822</td>
      <td> (41.958022022585844, -87.66482204074649)</td>
    </tr>
<tr>
<th>135528</th>
      <td> 08/05/2010</td>
      <td>       Completed</td>
      <td> 02/22/2013</td>
      <td>            10-01233874</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>    Dispatch Crew</td>
      <td> Area inspected, no cause and no baiting</td>
      <td>        3315 W OGDEN AVE</td>
      <td> 60623</td>
      <td> 1154509.572975</td>
      <td> 1891077.149085</td>
      <td> 24</td>
      <td> 10</td>
      <td> 29</td>
      <td> 41.856936</td>
      <td>-87.708347</td>
      <td>  (41.85693584874869, -87.70834713693091)</td>
    </tr>
<tr>
<th>135529</th>
      <td> 08/05/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01232122</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>       7530 S WABASH AVE</td>
      <td> 60619</td>
      <td> 1178021.518474</td>
      <td> 1855100.707677</td>
      <td>  6</td>
      <td>  6</td>
      <td> 69</td>
      <td> 41.757711</td>
      <td>-87.623137</td>
      <td>  (41.75771122728605, -87.62313707074553)</td>
    </tr>
<tr>
<th>135530</th>
      <td> 07/30/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01195231</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>    2755 N SPAULDING AVE</td>
      <td> 60647</td>
      <td> 1153780.944531</td>
      <td> 1918191.014328</td>
      <td> 35</td>
      <td> 14</td>
      <td> 22</td>
      <td> 41.931353</td>
      <td>-87.710299</td>
      <td>  (41.93135343973727, -87.71029893507783)</td>
    </tr>
<tr>
<th>135531</th>
      <td> 07/20/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01112346</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>    7939 S HERMITAGE AVE</td>
      <td> 60620</td>
      <td> 1166060.102880</td>
      <td> 1852046.485427</td>
      <td> 21</td>
      <td>  6</td>
      <td> 71</td>
      <td> 41.749593</td>
      <td>-87.667061</td>
      <td>  (41.74959262320285, -87.66706085160479)</td>
    </tr>
<tr>
<th>135532</th>
      <td> 07/20/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01115674</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>       5637 S KEELER AVE</td>
      <td> 60629</td>
      <td> 1149331.611090</td>
      <td> 1866765.049984</td>
      <td> 13</td>
      <td>  8</td>
      <td> 62</td>
      <td> 41.790322</td>
      <td>-87.727982</td>
      <td>  (41.79032191699322, -87.72798203264237)</td>
    </tr>
<tr>
<th>135533</th>
      <td> 07/19/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01110565</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>     6925 S ARTESIAN AVE</td>
      <td> 60629</td>
      <td> 1161237.257799</td>
      <td> 1858665.025277</td>
      <td> 17</td>
      <td>  8</td>
      <td> 66</td>
      <td> 41.767856</td>
      <td>-87.684551</td>
      <td>  (41.76785599857217, -87.68455093042334)</td>
    </tr>
<tr>
<th>135534</th>
      <td> 07/19/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01109534</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>    7252 S HERMITAGE AVE</td>
      <td> 60636</td>
      <td> 1165936.695291</td>
      <td> 1856601.580785</td>
      <td> 17</td>
      <td>  7</td>
      <td> 67</td>
      <td> 41.762095</td>
      <td>-87.667384</td>
      <td>  (41.76209506261827, -87.66738386159072)</td>
    </tr>
<tr>
<th>135535</th>
      <td> 07/15/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01079944</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>    4350 W CONGRESS PKWY</td>
      <td> 60624</td>
      <td> 1147309.510033</td>
      <td> 1897326.930003</td>
      <td> 24</td>
      <td> 11</td>
      <td> 26</td>
      <td> 41.874227</td>
      <td>-87.734616</td>
      <td>  (41.87422678972962, -87.73461560327037)</td>
    </tr>
<tr>
<th>135536</th>
      <td> 07/15/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01084116</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>   3727 N MARSHFIELD AVE</td>
      <td> 60613</td>
      <td> 1164658.235513</td>
      <td> 1924811.151620</td>
      <td> 47</td>
      <td> 19</td>
      <td>  6</td>
      <td> 41.949296</td>
      <td>-87.670139</td>
      <td>  (41.94929559096112, -87.67013866169015)</td>
    </tr>
<tr>
<th>135537</th>
      <td> 07/12/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01055770</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>       2614 N RACINE AVE</td>
      <td> 60614</td>
      <td> 1167856.483594</td>
      <td> 1917561.186392</td>
      <td> 32</td>
      <td> 19</td>
      <td>  7</td>
      <td> 41.929333</td>
      <td>-87.658592</td>
      <td>  (41.92933283716873, -87.65859219580943)</td>
    </tr>
<tr>
<th>135538</th>
      <td> 07/06/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01010108</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td> 2659 N CENTRAL PARK AVE</td>
      <td> 60647</td>
      <td> 1151929.608121</td>
      <td> 1917447.313431</td>
      <td> 35</td>
      <td> 14</td>
      <td> 22</td>
      <td> 41.929349</td>
      <td>-87.717122</td>
      <td>   (41.92934937797203, -87.7171219455323)</td>
    </tr>
<tr>
<th>135539</th>
      <td> 07/05/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-01008721</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>     3650 N MAGNOLIA AVE</td>
      <td> 60613</td>
      <td> 1167317.220021</td>
      <td> 1924042.110595</td>
      <td> 44</td>
      <td> 19</td>
      <td>  6</td>
      <td> 41.947128</td>
      <td>-87.660387</td>
      <td>  (41.94712843446327, -87.66038686997513)</td>
    </tr>
<tr>
<th>135540</th>
      <td> 06/15/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-00860089</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>     4742 N MAGNOLIA AVE</td>
      <td>   NaN</td>
      <td> 1167037.166277</td>
      <td> 1931628.084181</td>
      <td> 46</td>
      <td> 23</td>
      <td>  3</td>
      <td> 41.967951</td>
      <td>-87.661198</td>
      <td>  (41.967950674945655, -87.6611975602135)</td>
    </tr>
<tr>
<th>135541</th>
      <td> 01/20/2010</td>
      <td> Completed - Dup</td>
      <td> 01/07/2011</td>
      <td>            10-00083362</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>              NaN</td>
      <td>                                     NaN</td>
      <td>          1111 E 93RD ST</td>
      <td> 60619</td>
      <td> 1185291.743719</td>
      <td> 1843539.750299</td>
      <td>  8</td>
      <td>  4</td>
      <td> 47</td>
      <td> 41.725819</td>
      <td>-87.596855</td>
      <td>  (41.72581895961811, -87.59685549830274)</td>
    </tr>
<tr>
<th>135542</th>
      <td> 11/29/1999</td>
      <td>       Completed</td>
      <td> 12/26/2013</td>
      <td>            99-01925037</td>
      <td> Rodent Baiting/Rat Complaint</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>    Dispatch Crew</td>
      <td> Area inspected, no cause and no baiting</td>
      <td>         5501 S WOODLAWN</td>
      <td>   NaN</td>
      <td> 1185160.809228</td>
      <td> 1868767.031107</td>
      <td>  5</td>
      <td> 21</td>
      <td> 41</td>
      <td> 41.795048</td>
      <td>-87.596544</td>
      <td>  (41.79504811489318, -87.59654363354196)</td>
    </tr>
<tr>
<th>135543</th>
      <td>        NaN</td>
      <td>          STATUS</td>
      <td>        NaN</td>
      <td> SERVICE REQUEST NUMBER</td>
      <td>      TYPE OF SERVICE REQUEST</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td> CURRENT ACTIVITY</td>
      <td>                      MOST RECENT ACTION</td>
      <td>          STREET ADDRESS</td>
      <td>   NaN</td>
      <td>            NaN</td>
      <td>            NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>       NaN</td>
      <td>       NaN</td>
      <td>                                      NaN</td>
    </tr>
</tbody>
</table>
<p>135544 rows × 20 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 특정 필드에 대해 값의 범위를 조사</span>
<span class="n">rats</span><span class="p">[</span><span class="s1">'Current Activity'</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[15]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>array([nan, 'Dispatch Crew', 'Request Sanitation Inspector',
       'CURRENT ACTIVITY'], dtype=object)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 데이터 필터링</span>
<span class="n">crew_dispatched</span> <span class="o">=</span> <span class="n">rats</span><span class="p">[</span><span class="n">rats</span><span class="p">[</span><span class="s1">'Current Activity'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Dispatch Crew'</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">crew_dispatched</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[18]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>120739</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 시카고에서 쥐가 가장 많은 장소 10군데의 ZIP 코드</span>
<span class="n">crew_dispatched</span><span class="p">[</span><span class="s1">'ZIP Code'</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[24]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>60618    7930
60647    7498
60614    6114
60629    5324
60657    5169
60636    4324
60641    4030
60651    3528
60609    3448
60632    3420
60659    3253
60625    3182
60634    3147
60620    3139
60623    3121
...
60605    515
60656    507
60611    307
60654    229
60601     95
60606     87
60604     71
60602     66
60603     64
60661     59
60633     59
60827     22
60666      6
0          2
60635      1
Length: 61, dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dates</span> <span class="o">=</span> <span class="n">crew_dispatched</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">'Completion Date'</span><span class="p">)</span>
<span class="n">dates</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[27]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;pandas.core.groupby.DataFrameGroupBy object at 0x10555c710&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[26]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>934</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 각 날짜에 대한 카운트 얻기</span>
<span class="n">date_counts</span> <span class="o">=</span> <span class="n">dates</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">date_counts</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[29]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>Completion Date
01/01/2014           7
01/02/2013          20
01/02/2014          96
01/03/2011           4
01/03/2012         125
01/03/2013          46
01/03/2014          59
01/04/2011          54
01/04/2012          38
01/04/2013         135
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 카운트 정렬</span>
<span class="n">date_counts</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">date_counts</span><span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[30]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>Completion Date
10/26/2012         333
03/17/2011         336
12/09/2013         357
11/18/2013         362
11/13/2013         365
10/13/2011         378
10/14/2011         391
11/12/2013         401
10/07/2011         457
11/01/2013         488
dtype: int64</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>위의 자료를 보니 2013년 11월 1일에 쥐들이 가장 바빴다는 것을 알 수 있다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="posts/books/python_cookbook/ch06/#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>Pandas의 기능을 여기서 모두 다루기에는 불가능할 정도로 이는 방대한 라이브러리</li>
<li>하지만 커다란 데이터세트를 분석하고, 데이터를 그룹으로 묶고, 통계를 내는 등의 작업을 하려 한다면 고려해볼 만하다.</li>
<li>
<a href="http://www.yes24.com/24/goods/11043328?scode=032&amp;OzSrank=1">Python for Data Analysis</a>에 더 많은 정보를 얻을 수 있으니 참고</li>
</ul>
</div>
</div>
</div>
    </div>
  </div>

            </div>
        </div>
            <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="." rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-1.html" rel="next">Older posts</a>
            </li>
        </ul></nav><footer id="footer"><p>Contents © 2016         <a href="mailto:n.tesla@example.com">Nikola Tesla</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="assets/js/all-nocdn.js" type="text/javascript"></script><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
