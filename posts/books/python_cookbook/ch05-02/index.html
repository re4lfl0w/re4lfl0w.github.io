<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>ch05_02 | My Nikola Site</title>
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../rss.xml">
<link rel="canonical" href="https://example.com/posts/books/python_cookbook/ch05-02/">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><meta name="author" content="Nikola Tesla">
<meta property="og:site_name" content="My Nikola Site">
<meta property="og:title" content="ch05_02">
<meta property="og:url" content="https://example.com/posts/books/python_cookbook/ch05-02/">
<meta property="og:description" content="5.11 경로 다루기¶문제¶
기본 파일 이름, 디렉토리 이름, 절대 경로 등을 찾기 위해 경로를 다루어야 함

해결¶
경로를 다루기 위해서 os.path 모듈의 함수를 사용







In [1]:

    
import os









In [2]:

    
path = '/Users/beazley/Data/data.csv'









In">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2016-06-15T19:51:40-09:00">
</head>
<body>
    <section class="social"><ul>
<li><a href="../../../../index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="../../../../archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="../../../../categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="../../../../rss.xml" title="RSS"><i class="icon-rss"></i></a></li>
            <li><a href="https://getnikola.com" title="About me"><i class="icon-user"></i></a></li>
            <li><a href="https://twitter.com/getnikola" title="My Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="https://github.com/getnikola" title="My Github"><i class="icon-github"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
    <div class="post">
        <h1 class="p-name entry-title" itemprop="headline name">ch05_02</h1>

        <div class="meta">
            <div class="authordate">
                <time class="timeago" datetime="2016-06-15T19:51:40-09:00">2016-06-15 19:51</time>
            
                      |  
        <a href="index.ipynb" id="sourcelink">Source</a>

            </div>
            
        </div>
        <div class="body">
            <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.11-경로-다루기">5.11 경로 다루기<a class="anchor-link" href="#5.11-%EA%B2%BD%EB%A1%9C-%EB%8B%A4%EB%A3%A8%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>기본 파일 이름, 디렉토리 이름, 절대 경로 등을 찾기 위해 경로를 다루어야 함</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>경로를 다루기 위해서 os.path 모듈의 함수를 사용</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">'/Users/beazley/Data/data.csv'</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 경로의 마지막 부분 구하기</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[4]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'data.csv'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 디렉토리 이름 구하기</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[5]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'/Users/beazley/Data'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 각 부분을 합치기1</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">'tmp'</span><span class="p">,</span> <span class="s1">'data'</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[6]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'tmp/data/data.csv'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 각 부분을 합치기2</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="s1">'tmp'</span><span class="p">,</span> <span class="s1">'data'</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[7]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'/tmp/data/data.csv'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 사용자의 홈 디렉토리 펼치기</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">'~/Data/data.csv'</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">expanduser</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[9]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'/Users/re4lfl0w/Data/data.csv'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 파일 확장자 나누기</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[10]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>('~/Data/data', '.csv')</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Help on function splitext in module posixpath:

splitext(p)
    Split the extension from a pathname.
    
    Extension is everything from the last dot to the end, ignoring
    leading dots.  Returns "(root, ext)"; ext may be empty.

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="s1">'~/Data/data.csv.bak'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[12]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>('~/Data/data.csv', '.bak')</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>파일 이름을 다루기 위해서 문자열에 관련된 코드를 직접 작성하지 말고 os.path 모듈을 사용해야 함</li>
<li>이는 이식성과도 어느 정도 관련이 있음</li>
<li>os.path 모듈은 Unix와 Windows의 차이점을 알고 Data/data.csv와 Data\data.csv의 차이점을 자동으로 처리한다.</li>
<li>그리고 <strong>자동차를 만들겠다고 바퀴부터 개발해야 할 이유가 없다.</strong> 이미 있는 기능이라면 가져다 사용하는 편이 현명하다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.12-파일-존재-여부-확인">5.12 파일 존재 여부 확인<a class="anchor-link" href="#5.12-%ED%8C%8C%EC%9D%BC-%EC%A1%B4%EC%9E%AC-%EC%97%AC%EB%B6%80-%ED%99%95%EC%9D%B8">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>파일이나 디렉토리가 존재하는지 확인해야 한다</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>파일이나 디렉토리의 존재 여부를 확인하기 위해서 os.path 모듈 사용</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">'/etc/passwd'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[14]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">'/tmp/spam'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[15]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>False</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>추가적으로 파일의 종류가 무엇인지 확인할 수 있음</li>
<li>파일이 없는 경우 False를 반환</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 일반 파일인지 확인</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s1">'/etc/passwd'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[16]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 디렉토리인지 확인</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="s1">'/etc/passwd'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[17]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>False</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 심볼릭 링크인지 확인</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">islink</span><span class="p">(</span><span class="s1">'/usr/local/bin/python3'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[18]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 연결된 파일 얻기</span>
<span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="s1">'/usr/local/bin/python3'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[19]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/bin/python3.4'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>메타데이터(파일 크기, 수정 날짜) 등이 필요할 때도 os.path 모듈 사용</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="s1">'/etc/passwd'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[20]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>4962</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="s1">'/etc/passwd'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[21]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>1374560580.0</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>
<span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="s1">'/etc/passwd'</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[22]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'Tue Jul 23 15:23:00 2013'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>os.path를 사용하면 파일 테스팅은 그리 어렵지 않음</li>
<li>유의해야 할 점은 아마도 파일 권한에 관련된 것뿐</li>
<li>특히 메타데이터에 접근할 때는 권한에 주의</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>PermissionError: [Errno 13] Permission denied: '/Users/guido/Desktop/fo.txt'</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.13-디렉토리-리스팅-구하기">5.13 디렉토리 리스팅 구하기<a class="anchor-link" href="#5.13-%EB%94%94%EB%A0%89%ED%86%A0%EB%A6%AC-%EB%A6%AC%EC%8A%A4%ED%8C%85-%EA%B5%AC%ED%95%98%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>디렉토리나 파일 시스템 내부의 파일 리스트를 구하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>os.listdir() 함수로 디렉토리 내에서 파일 리스트를 얻는다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">names</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)</span>
<span class="n">names</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[29]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>['.DS_Store',
 '.ipynb_checkpoints',
 '01',
 '02',
 '03',
 '04',
 '05',
 '06',
 '07',
 '08',
 '09',
 '10',
 '11',
 '12',
 '13',
 '14',
 '15',
 'ch01.ipynb',
 'ch02_01.ipynb',
 'ch02_02.ipynb',
 'ch03_01.ipynb',
 'ch03_02.ipynb',
 'ch04.ipynb',
 'ch05_01.ipynb',
 'ch05_02.ipynb',
 'images',
 'README.md',
 'Untitled0.ipynb',
 'Untitled1.ipynb']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이렇게 하면 디렉토리와 파일, 서브디렉토리, 심볼릭 링크 등 모든 것을 구할 수 있음</li>
<li>만약 데이터를 걸러내야 한다면 os.path 라이브러리의 파일에 list comprehension을 사용</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os.path</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 일반 파일 모두 구하기</span>
<span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="n">name</span><span class="p">))]</span>
<span class="n">names</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[37]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>['.DS_Store',
 'ch01.ipynb',
 'ch02_01.ipynb',
 'ch02_02.ipynb',
 'ch03_01.ipynb',
 'ch03_02.ipynb',
 'ch04.ipynb',
 'ch05_01.ipynb',
 'ch05_02.ipynb',
 'README.md',
 'Untitled0.ipynb',
 'Untitled1.ipynb']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 디렉토리 모두 구하기</span>
<span class="n">dirnames</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">'.'</span><span class="p">,</span> <span class="n">name</span><span class="p">))]</span>
<span class="n">dirnames</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[39]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>['.ipynb_checkpoints',
 '01',
 '02',
 '03',
 '04',
 '05',
 '06',
 '07',
 '08',
 '09',
 '10',
 '11',
 '12',
 '13',
 '14',
 '15',
 'images']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>문자열의 startswith()와 endswith() 메소드를 사용하면 디렉토리의 내용을 걸러내기 유용</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [41]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pyfiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)</span>
           <span class="k">if</span> <span class="n">name</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'.ipynb'</span><span class="p">)]</span>
<span class="n">pyfiles</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[41]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>['ch01.ipynb',
 'ch02_01.ipynb',
 'ch02_02.ipynb',
 'ch03_01.ipynb',
 'ch03_02.ipynb',
 'ch04.ipynb',
 'ch05_01.ipynb',
 'ch05_02.ipynb',
 'Untitled0.ipynb',
 'Untitled1.ipynb']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>파일 이름 맻이을 하기 위해 glob 이나 fnmatch 모듈을 상요</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [45]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>
<span class="n">pyfiles</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">'*.ipynb'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pyfiles</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">fnmatch</span> <span class="k">import</span> <span class="n">fnmatch</span>
<span class="n">pyfiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">'.'</span><span class="p">)</span>
           <span class="k">if</span> <span class="n">fnmatch</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="s1">'*.ipynb'</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pyfiles</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>['ch01.ipynb', 'ch02_01.ipynb', 'ch02_02.ipynb', 'ch03_01.ipynb', 'ch03_02.ipynb', 'ch04.ipynb', 'ch05_01.ipynb', 'ch05_02.ipynb', 'Untitled0.ipynb', 'Untitled1.ipynb']

['ch01.ipynb', 'ch02_01.ipynb', 'ch02_02.ipynb', 'ch03_01.ipynb', 'ch03_02.ipynb', 'ch04.ipynb', 'ch05_01.ipynb', 'ch05_02.ipynb', 'Untitled0.ipynb', 'Untitled1.ipynb']
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>디렉토리 리스트를 구하기는 쉽지만, 앞에 나온 방법으로는 엔트리의 이름만 얻을 수 있음</li>
<li>만약 파일 크기나 수정 날짜 등 메타데이터가 필요하다면 os.path 모듈의 추가적인 함수를 사용하거나 os.stat() 함수를 사용</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [48]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 디렉토리 리스트 구하기</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="n">pyfiles</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">'*.ipynb'</span><span class="p">)</span>

<span class="c1"># 파일 크기와 수정 날짜 구하기</span>
<span class="n">name_sz_date</span> <span class="o">=</span> <span class="p">[(</span><span class="n">name</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getsize</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
                 <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">pyfiles</span><span class="p">]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">mtime</span> <span class="ow">in</span> <span class="n">name_sz_date</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">mtime</span><span class="p">)</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s1">''</span><span class="p">)</span>

<span class="c1"># 대안 파일 메타데이터 구하기</span>
<span class="n">file_metadata</span> <span class="o">=</span> <span class="p">[(</span><span class="n">name</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">stat</span><span class="p">(</span><span class="n">name</span><span class="p">))</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">pyfiles</span><span class="p">]</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">meta</span> <span class="ow">in</span> <span class="n">file_metadata</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">meta</span><span class="o">.</span><span class="n">st_size</span><span class="p">,</span> <span class="n">meta</span><span class="o">.</span><span class="n">st_mtime</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>ch01.ipynb 245557 1412210179.0
ch02_01.ipynb 96768 1412395649.0
ch02_02.ipynb 138497 1412398456.0
ch03_01.ipynb 117053 1412392955.0
ch03_02.ipynb 78895 1412388879.0
ch04.ipynb 157082 1412504109.0
ch05_01.ipynb 95395 1412548900.0
ch05_02.ipynb 21035 1412550469.0
Untitled0.ipynb 56215 1412458009.0
Untitled1.ipynb 2145 1412281641.0

ch01.ipynb 245557 1412210179.0
ch02_01.ipynb 96768 1412395649.0
ch02_02.ipynb 138497 1412398456.0
ch03_01.ipynb 117053 1412392955.0
ch03_02.ipynb 78895 1412388879.0
ch04.ipynb 157082 1412504109.0
ch05_01.ipynb 95395 1412548900.0
ch05_02.ipynb 21035 1412550469.0
Untitled0.ipynb 56215 1412458009.0
Untitled1.ipynb 2145 1412281641.0
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>마지막으로, 파일 이름을 다룰 때 <strong>인코딩</strong>과 관련된 문제가 발생할 수 있음</li>
<li>일반적으로 os.listdir()와 같은 함수가 반환하는 엔트리는 <strong>파일 시스템의 기본 인코딩으로 디코드</strong>된다. 하지만, 특정 상황에서는 파일 이름을 디코딩하는 것이 불가능 할 수도 있음</li>
<li>이런 이름과 관련된 사항은 레시피 5.14와 5.15에서 더 자세히 다룸</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.14-파일-이름-인코딩-우회">5.14 파일 이름 인코딩 우회<a class="anchor-link" href="#5.14-%ED%8C%8C%EC%9D%BC-%EC%9D%B4%EB%A6%84-%EC%9D%B8%EC%BD%94%EB%94%A9-%EC%9A%B0%ED%9A%8C">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>시스템의 기본 인코딩으로 디코딩 혹은 인코딩되지 않은 파일 이름에 입출력 작업을 수행해야 함</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>기본적으로 모든 파일 이름은 sys.getfilesystemencoding()이 반환하는 텍스트 인코딩 값으로 디코딩 혹은 인코딩되어 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [49]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">getfilesystemencoding</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[49]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'utf-8'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>하지만 이 인코딩을 우회하길 바란다면 raw 바이트 문자열로 파일 이름을 명시해야 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [53]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 유니코드로 파일 이름을 쓴다.</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'05/jalape</span><span class="se">\xf1</span><span class="s1">0.txt'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'Spicy!'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [55]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls -l 05/ja*
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>-rw-r--r--  1 re4lfl0w  staff  6 10  6 08:11 05/jalapeñ0.txt
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [59]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 디렉토리 리스트(디코딩됨)</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">'05'</span><span class="p">)</span> <span class="k">if</span> <span class="s1">'ja'</span> <span class="ow">in</span> <span class="n">name</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[59]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>['jalapeñ0.txt']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [62]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 디렉토리 리스티(디코딩되지 않음)</span>
<span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">b</span><span class="s1">'05'</span><span class="p">)</span> <span class="k">if</span> <span class="n">b</span><span class="s1">'ja'</span> <span class="ow">in</span> <span class="n">name</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[62]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[b'jalapen\xcc\x830.txt']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [63]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 로우 파일 이름으로 파일 열기</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">b</span><span class="s1">'05/jalapen</span><span class="se">\xcc\x83</span><span class="s1">0.txt'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Spicy!
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [64]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls -l <span class="m">05</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>total 2072
drwxr-xr-x  3 re4lfl0w  staff      102 10  1 07:01 <span class="ansi-blue-fg">adding_or_changing_the_encoding_of_an_already_open_file</span>
-rw-r--r--  1 re4lfl0w  staff  1000000 10  6 06:48 data
-rw-r--r--  1 re4lfl0w  staff       16 10  6 05:36 data 복사본.txt
-rw-r--r--  1 re4lfl0w  staff       16 10  6 05:36 data.bin
-rw-r--r--  1 re4lfl0w  staff     1257 10  6 06:19 data2.bin
-rw-r--r--  1 re4lfl0w  staff       11 10  6 06:28 data3.bin
drwxr-xr-x  3 re4lfl0w  staff      102 10  1 07:01 <span class="ansi-blue-fg">getting_a_directory_listing</span>
-rw-r--r--  1 re4lfl0w  staff       29 10  5 19:39 hello.txt
-rw-r--r--  1 re4lfl0w  staff       11 10  6 05:23 hello_wb.txt
-rw-r--r--  1 re4lfl0w  staff       11 10  6 05:34 hello_wb_encode.txt
-rw-r--r--  1 re4lfl0w  staff       26 10  5 23:01 hello_windows.txt
drwxr-xr-x  4 re4lfl0w  staff      136 10  1 07:01 <span class="ansi-blue-fg">iterating_over_fixed-sized_records</span>
-rw-r--r--  1 re4lfl0w  staff        6 10  6 08:11 jalapeñ0.txt
-rw-r--r--  1 re4lfl0w  staff       11 10  6 06:30 newsample.bin
drwxr-xr-x  4 re4lfl0w  staff      136 10  1 07:01 <span class="ansi-blue-fg">reading_and_writing_text_data</span>
-rw-r--r--  1 re4lfl0w  staff       61 10  6 05:57 somefile.bz2
-rw-r--r--  1 re4lfl0w  staff      100 10  6 06:03 somefile.gz
drwxr-xr-x  3 re4lfl0w  staff      102 10  1 07:01 <span class="ansi-blue-fg">wrapping_an_existing_file_descriptor_as_a_file_object</span>
drwxr-xr-x  3 re4lfl0w  staff      102 10  1 07:01 <span class="ansi-blue-fg">writing_bytes_to_a_text_file</span>
-rw-r--r--  1 re4lfl0w  staff        6 10  6 05:42 xmode.txt
-rw-r--r--  1 re4lfl0w  staff        6 10  6 05:44 xmode2.txt
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [65]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">'05'</span><span class="p">)]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[65]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>['.DS_Store',
 'adding_or_changing_the_encoding_of_an_already_open_file',
 'data',
 'data 복사본.txt',
 'data.bin',
 'data2.bin',
 'data3.bin',
 'getting_a_directory_listing',
 'hello.txt',
 'hello_wb.txt',
 'hello_wb_encode.txt',
 'hello_windows.txt',
 'iterating_over_fixed-sized_records',
 'jalapeñ0.txt',
 'newsample.bin',
 'reading_and_writing_text_data',
 'somefile.bz2',
 'somefile.gz',
 'wrapping_an_existing_file_descriptor_as_a_file_object',
 'writing_bytes_to_a_text_file',
 'xmode.txt',
 'xmode2.txt']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [66]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">b</span><span class="s1">'05'</span><span class="p">)]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[66]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>[b'.DS_Store',
 b'adding_or_changing_the_encoding_of_an_already_open_file',
 b'data',
 b'data \xe1\x84\x87\xe1\x85\xa9\xe1\x86\xa8\xe1\x84\x89\xe1\x85\xa1\xe1\x84\x87\xe1\x85\xa9\xe1\x86\xab.txt',
 b'data.bin',
 b'data2.bin',
 b'data3.bin',
 b'getting_a_directory_listing',
 b'hello.txt',
 b'hello_wb.txt',
 b'hello_wb_encode.txt',
 b'hello_windows.txt',
 b'iterating_over_fixed-sized_records',
 b'jalapen\xcc\x830.txt',
 b'newsample.bin',
 b'reading_and_writing_text_data',
 b'somefile.bz2',
 b'somefile.gz',
 b'wrapping_an_existing_file_descriptor_as_a_file_object',
 b'writing_bytes_to_a_text_file',
 b'xmode.txt',
 b'xmode2.txt']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>한글 깨지네</li>
<li>마지막 두 작업에 나온 것처럼, open()이나 os.listdir()와 같은 파일 관련 함수에 바이트 문자열을 넣었ㅇ르 때 파일 이름 처리는 거의 변하지 않음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>일반적인 환경에서 파일 이름 인코딩, 디코딩에 대해 걱정할 필요는 없음</li>
<li>대부분의 경우에는 무리없이 잘 동작</li>
<li>하지만 많은 운영체제에서 사용자는 실수로 혹은 악의적으로 인코딩 규칙을 따르지 않는 파일 이름을 생성할 수 있음</li>
<li>이런 파일 이름은 많은 파일을 다루는 파이썬 프로그램을 망가트릴 수 있음</li>
<li>파일 이름과 디렉토리를 읽을 때 디코딩되지 않은 raw 바이트를 이름으로 사용하면 프로그래밍 과정은 조금 귀찮겠지만 이런 문제점을 피해갈 수 있음</li>
<li>디코딩되지 않은 파일 이름을 출력하는 방법을 레시피 5.15에서 알아본다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.15-망가진-파일-이름-출력">5.15 망가진 파일 이름 출력<a class="anchor-link" href="#5.15-%EB%A7%9D%EA%B0%80%EC%A7%84-%ED%8C%8C%EC%9D%BC-%EC%9D%B4%EB%A6%84-%EC%B6%9C%EB%A0%A5">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>프로그램에서 디렉토리 리스트를 받아 파일 이름을 출력하려고 할 때, UnicodeEncodeError 예외와 "surrogates not allowed" 메시지가 발생하면서 프로그램이 죽어버림</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>출처를 알 수 없는 파일 이름을 출력할 때, 다음 코드로 에러 방지</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [67]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">bad_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">repr</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [73]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="n">b</span><span class="s1">'jalapen</span><span class="se">\xcc\x83</span><span class="s1">0.txt'</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [76]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">try</span><span class="p">:</span> 
    <span class="nb">print</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">UnicodeError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'error'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">bad_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>b'jalapen\xcc\x830.txt'
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [80]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="n">name</span> <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">'05'</span><span class="p">)]</span>
<span class="n">names</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[80]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>['.DS_Store',
 'adding_or_changing_the_encoding_of_an_already_open_file',
 'data',
 'data 복사본.txt',
 'data.bin',
 'data2.bin',
 'data3.bin',
 'getting_a_directory_listing',
 'hello.txt',
 'hello_wb.txt',
 'hello_wb_encode.txt',
 'hello_windows.txt',
 'iterating_over_fixed-sized_records',
 'jalapeñ0.txt',
 'newsample.bin',
 'reading_and_writing_text_data',
 'somefile.bz2',
 'somefile.gz',
 'wrapping_an_existing_file_descriptor_as_a_file_object',
 'writing_bytes_to_a_text_file',
 'xmode.txt',
 'xmode2.txt']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [82]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">getfilesystemencoding</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[82]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'utf-8'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><a href="http://stackoverflow.com/questions/18249459/python3-reload-can-not-be-called-on-import-object">python - Python3 - reload() can not be called on <strong>import</strong> object? - Stack Overflow</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [81]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span> 
        <span class="nb">print</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">UnicodeError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'error'</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">bad_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>.DS_Store
adding_or_changing_the_encoding_of_an_already_open_file
data
data 복사본.txt
data.bin
data2.bin
data3.bin
getting_a_directory_listing
hello.txt
hello_wb.txt
hello_wb_encode.txt
hello_windows.txt
iterating_over_fixed-sized_records
jalapeñ0.txt
newsample.bin
reading_and_writing_text_data
somefile.bz2
somefile.gz
wrapping_an_existing_file_descriptor_as_a_file_object
writing_bytes_to_a_text_file
xmode.txt
xmode2.txt
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>이번 레시피는 자주 발생하지는 않지만 파일 시스템에 발생할 수 있는 아주 귀찮은 문제를 다룸</li>
<li>기본적으로 파이썬은 모든 파일 이름이 sys.getfilesystemencoding()이 반환하는 값으로 인코딩되어 있음</li>
<li>하지만 특정 파일 시스템은 인코딩 규칙을 따르도록 강제하지 않아서 올바르지 않은 인코딩을 사용한 파일 이름이 생기기도 함</li>
<li>이런 일이 비일비재하게 발생하지는 않지만 세상에는 우리가 예측하지 못하는 동작을 하는 사용자가 어디에나 있으니 조심해야 함(open()에 실수로 잘못된 파일 이름을 전달하는 경우에 이런 에러가 발생할 수 있다.)</li>
<li>os.listdir()와 같은 명령을 실행할 때, 망가진 파일 이름을 사용하면 파이썬에 문제가 생김</li>
<li>한편으로 잘못된 이름이라고 단순히 무시해 벌리 수 없음</li>
<li>반면 이 이름을 올바른 텍스트 문자열로 변환할 수도 없음</li>
<li>파이썬의 해결책은 디코딩할 수 없는 바이트 값 \xhh를 Unicode 문자 \udchh로 표현하는 소위 대리 인코딩(surrogate encoding)으로 매핑하는 것</li>
<li>UTF-8 이 아닌 Latin-1 으로 인코딩한 bad.txt를 포함한 디렉토리 리스트가 어떻게 보이는지 예제를 보자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [105]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">'05'</span><span class="p">)</span>
<span class="n">files</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[105]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>['.DS_Store',
 'adding_or_changing_the_encoding_of_an_already_open_file',
 'b%E4d.txt',
 'data',
 'data 복사본.txt',
 'data.bin',
 'data2.bin',
 'data3.bin',
 'getting_a_directory_listing',
 'hello.txt',
 'hello_wb.txt',
 'hello_wb_encode.txt',
 'hello_windows.txt',
 'iterating_over_fixed-sized_records',
 'jalapeñ0.txt',
 'newsample.bin',
 'reading_and_writing_text_data',
 'somefile.bz2',
 'somefile.gz',
 'test_latin.txt',
 'wrapping_an_existing_file_descriptor_as_a_file_object',
 'writing_bytes_to_a_text_file',
 'xmode.txt',
 'xmode2.txt']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>파일 이름을 다루거나 open()과 같은 함수에 전달하는 코드가 있다면 모두 정상적으로 동작</li>
<li>이 파일 이름을 출력하려고 할 때만 문제가 발생(화면에 출력하거나 로그를 남기는 등)</li>
<li>특히 선행 리스트를 출력 하려고 하면 프로그램이 비정상적으로 종료</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [106]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 여기서는 안죽는다..</span>
<span class="c1"># 죽게 노력해봤는데 안되더라.</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>.DS_Store
adding_or_changing_the_encoding_of_an_already_open_file
b%E4d.txt
data
data 복사본.txt
data.bin
data2.bin
data3.bin
getting_a_directory_listing
hello.txt
hello_wb.txt
hello_wb_encode.txt
hello_windows.txt
iterating_over_fixed-sized_records
jalapeñ0.txt
newsample.bin
reading_and_writing_text_data
somefile.bz2
somefile.gz
test_latin.txt
wrapping_an_existing_file_descriptor_as_a_file_object
writing_bytes_to_a_text_file
xmode.txt
xmode2.txt
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>프로그램이 죽는 이유는 \udce4가 잘못된 Unicode 이기 때문</li>
<li>대리짝(surrogate pair)으로 알려진 문자 2개의 조합</li>
<li>하지만 첫번째 반쪽이 없기 때문에 올바른 Unicode라 할 수 없음</li>
<li>따라서 올바른 출력을 하려면 망가진 파일 이름을 발견했을 때 교정 작업을 해야 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [107]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">UnicodeEncodeError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">bad_filename</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>.DS_Store
adding_or_changing_the_encoding_of_an_already_open_file
b%E4d.txt
data
data 복사본.txt
data.bin
data2.bin
data3.bin
getting_a_directory_listing
hello.txt
hello_wb.txt
hello_wb_encode.txt
hello_windows.txt
iterating_over_fixed-sized_records
jalapeñ0.txt
newsample.bin
reading_and_writing_text_data
somefile.bz2
somefile.gz
test_latin.txt
wrapping_an_existing_file_descriptor_as_a_file_object
writing_bytes_to_a_text_file
xmode.txt
xmode2.txt
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>bad_filename() 함수를 어떻게 처리할지는 모두 프로그래머에게 달려 있다. 혹은 그 값을 다음과 같이 재인코딩할 수도 있다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [108]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">bad_filename</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">getfilesystemencoding</span><span class="p">(),</span> 
                           <span class="n">errors</span><span class="o">=</span><span class="s1">'surrogateescape'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">temp</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'latin-1'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [109]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">UnicodeEncodeError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">bad_filename</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>.DS_Store
adding_or_changing_the_encoding_of_an_already_open_file
b%E4d.txt
data
data 복사본.txt
data.bin
data2.bin
data3.bin
getting_a_directory_listing
hello.txt
hello_wb.txt
hello_wb_encode.txt
hello_windows.txt
iterating_over_fixed-sized_records
jalapeñ0.txt
newsample.bin
reading_and_writing_text_data
somefile.bz2
somefile.gz
test_latin.txt
wrapping_an_existing_file_descriptor_as_a_file_object
writing_bytes_to_a_text_file
xmode.txt
xmode2.txt
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 레시피를 <strong>무시</strong>할 독자들이 많을 것이라 생각한다.</li>
<li>하지만 파일 이름과 파일 시스템에 신뢰할 수 있게 동작하는 프로그램을 작성하려면 고려해야 할 문제</li>
<li>그렇지 않으면 주말에 사무실에 불려 나와 알 수 없는 버그를 고치고 있어야 할지도 모름</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.16-이미-열려있는-파일의-인코딩을-수정하거나-추가하기">5.16 이미 열려있는 파일의 인코딩을 수정하거나 추가하기<a class="anchor-link" href="#5.16-%EC%9D%B4%EB%AF%B8-%EC%97%B4%EB%A0%A4%EC%9E%88%EB%8A%94-%ED%8C%8C%EC%9D%BC%EC%9D%98-%EC%9D%B8%EC%BD%94%EB%94%A9%EC%9D%84-%EC%88%98%EC%A0%95%ED%95%98%EA%B1%B0%EB%82%98-%EC%B6%94%EA%B0%80%ED%95%98%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>이미 열려있는 파일을 닫지 않고 Unicode 인코딩을 추가하거나 변경하고 싶다</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>바이너리 모드로 이미 열려있는 파일 객체를 닫지않고 Unicode 인코딩/디코딩을 추가하고 싶다면 그 객체를 io.TextIOWrapper() 객체로 감싼다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">io</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s1">'http://www.python.org'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOWrapper</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'utf-8'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">text</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">text</span><span class="p">[:</span><span class="mi">200</span><span class="p">]</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[7]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'&lt;!doctype html&gt;\n&lt;!--[if lt IE 7]&gt;   &lt;html class="no-js ie6 lt-ie7 lt-ie8 lt-ie9"&gt;   &lt;![endif]--&gt;\n&lt;!--[if IE 7]&gt;      &lt;html class="no-js ie7 lt-ie8 lt-ie9"&gt;          &lt;![endif]--&gt;\n&lt;!--[if IE 8]&gt;      &lt;h'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>텍스트 모드로 열린 파일의 인코딩을 변경하려면 detach() 메소드로 텍스트 인코딩 레이어를 제거하고 다른 것으로 치환된다.</li>
<li>sys.stdout의 인코딩을 바꾸는 방법을 보자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">encoding</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[8]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'UTF-8'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 아마 ipython 이라 안되는것 같다.</span>
<span class="c1"># ipython에서 뭔가 조작을 하는듯</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOWrapper</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">detach</span><span class="p">(),</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'latin-1'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-9-13d5d4c96894&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>sys<span class="ansi-blue-fg">.</span>stdout <span class="ansi-blue-fg">=</span> io<span class="ansi-blue-fg">.</span>TextIOWrapper<span class="ansi-blue-fg">(</span>sys<span class="ansi-blue-fg">.</span>stdout<span class="ansi-blue-fg">.</span>detach<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> encoding<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">'latin-1'</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">AttributeError</span>: 'OutStream' object has no attribute 'detach'</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">encoding</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[10]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'UTF-8'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 코드를 실행하면 터미널의 출력이 망가질 수도 있다. 단순히 예를 위한 목적으로만 보자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>I/O 시스템은 여러 레이어로 만들어져 있다. 다음 간단한 코드를 통해 레이어를 볼 수 있다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'05/test_io'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[20]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;_io.TextIOWrapper name='05/test_io' mode='w' encoding='UTF-8'&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">buffer</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[21]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;_io.BufferedWriter name='05/test_io'&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">raw</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[22]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;_io.FileIO name='05/test_io' mode='wb'&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>io.TextIOWrapper: Unicode를 인코딩/디코딩하는 텍스트 처리 레이어</li>
<li>io.BufferedWriter: 바이너리 데이터를 처리하는 버퍼 I/O 레이어</li>
<li>io.FileIO: 운영체제에서 하위 레벨 파일 디스크립터를 표현하는 raw file</li>
<li>텍스트 인코딩의 추가, 수정에는 최상단 레이어인 io.TextIOWrapper의 추가, 수정이 포함됨</li>
</ul>
<ul>
<li>일반적으로 앞에 나타난 속성에 접근해 레이어를 직접 수정하는 것은 안전하지 않음</li>
<li>이 기술을 사용해 인코딩을 변경했을 때 무슨 일이 벌어지는지 살펴보자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [23]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[23]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;_io.TextIOWrapper name='05/test_io' mode='w' encoding='UTF-8'&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOWrapper</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'latin-1'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [25]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[25]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;_io.TextIOWrapper name='05/test_io' encoding='latin-1'&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 제대로 써지는데..?</span>
<span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'Hello'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[26]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>5</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>f의 원본값이 파괴되고 프로세스의 기저 파일을 닫았기 때문에 제대로 동작하지 않는다.</li>
<li>detach() 메소드는 파일의 최상단 레이어를 끊고 그 다음 레이어를 반환한다. 그 다음에 상단 레이어를 더 이상 사용할 수 없다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [27]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'05/test_io'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[28]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;_io.TextIOWrapper name='05/test_io' mode='w' encoding='UTF-8'&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[30]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;_io.BufferedWriter name='05/test_io'&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'hello'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ValueError</span>                                Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-31-0ec9cf64e174&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>f<span class="ansi-blue-fg">.</span>write<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">'hello'</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">ValueError</span>: underlying buffer has been detached</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>하지만 연결을 끊은 후에는, 반환된 결과에 새로운 상단 레이어를 추가할 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOWrapper</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'latin-1'</span><span class="p">)</span>
<span class="n">f</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[32]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;_io.TextIOWrapper name='05/test_io' encoding='latin-1'&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>인코딩을 변경하는 방법을 보였지만, 이 기술을 라인 처리, 에러 규칙 등 파일 처리의 다른 측면에 활용</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 잘 안됨..</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">TextIOWrapper</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">detach</span><span class="p">(),</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'ascii'</span><span class="p">,</span>
                              <span class="n">errors</span><span class="o">=</span><span class="s1">'xmlcharrefreplace'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-33-de12fd09c003&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> sys.stdout = io.TextIOWrapper(sys.stdout.detach(), encoding='ascii',
</span><span class="ansi-green-intense-fg ansi-bold">      2</span>                               errors='xmlcharrefreplace')

<span class="ansi-red-fg">AttributeError</span>: 'OutStream' object has no attribute 'detach'</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">'Jalepe</span><span class="se">\u00f1</span><span class="s1">o'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Jalepeño
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>출력부에서 ASCII가 아닌 n 문자가 ñ로 치환되었다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.17-텍스트-파일에-바이트-쓰기">5.17 텍스트 파일에 바이트 쓰기<a class="anchor-link" href="#5.17-%ED%85%8D%EC%8A%A4%ED%8A%B8-%ED%8C%8C%EC%9D%BC%EC%97%90-%EB%B0%94%EC%9D%B4%ED%8A%B8-%EC%93%B0%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>텍스트 모드로 연 파일에 로우 바이트를 쓰고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>단순히 바이트 데이터를 buffer에 씀</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 책과 상이</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="s1">'Hello</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Hello
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 책과 상이</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">buffer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="s1">'Hello</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-37-635b121f7e0e&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>sys<span class="ansi-blue-fg">.</span>stdout<span class="ansi-blue-fg">.</span>buffer<span class="ansi-blue-fg">.</span>write<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">b'Hello\n'</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">AttributeError</span>: 'OutStream' object has no attribute 'buffer'</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이와 유사하게, 텍스트 파일의 buffer 속성에서 바이너리 데이터를 읽을 수도 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>I/O 시스템은 레이어로부터 만들어짐</li>
<li>텍스트 파일은 버퍼 바이너리 모드 파일 상단에 Unicode 인코딩/디코딩 레이어를 추가해서 생성</li>
<li>buffer 속성은 바로 이 파일 아래 부분을 가리킴</li>
<li>여기에 접근하면 텍스트 인코딩/디코딩 레이어 우회 가능</li>
<li>기본적으로 sys.stdout은 언제나 텍스트 모드로 열려 있음</li>
<li>하지만 바이너리 데이터를 표준 출력에 출력하는 스크립트를 작성한다면 이 기술을 사용해 텍스트 인코딩을 우회할 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.18-기존-파일-디스크립터를-파일-객체로-감싸기">5.18 기존 파일 디스크립터를 파일 객체로 감싸기<a class="anchor-link" href="#5.18-%EA%B8%B0%EC%A1%B4-%ED%8C%8C%EC%9D%BC-%EB%94%94%EC%8A%A4%ED%81%AC%EB%A6%BD%ED%84%B0%EB%A5%BC-%ED%8C%8C%EC%9D%BC-%EA%B0%9D%EC%B2%B4%EB%A1%9C-%EA%B0%90%EC%8B%B8%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>운영체제 상에서 이미 열려있는 I/O 채널에 일치하는 정수형 파일 디스크립터를 가지고 있고(file, pipe, socket 등), 이를 상위 레벨 파이썬 파일 객체로 감싸고 싶음</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>파일 디스크립터는 운영체제가 할당한 정수형 핸들로 시스템 I/O 채널 등을 참조하기 위한 목적으로써 일반 파일과는 다르다.</li>
<li>파일 디스크립터가 있을때 open() 함수를 사용해 파이썬 파일 객체로 감쌀 수 있다. 하지만 이때 파일 이름 대신 정수형 파일 디스크립터를 먼저 전달해야 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [64]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 하위 레벨 파일 디스크립터 열기</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">fd</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">'05/data.bin'</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">O_WRONLY</span> <span class="o">|</span> <span class="n">os</span><span class="o">.</span><span class="n">O_CREAT</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [65]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 올바른 파일로 바꾸기</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="s1">'wt'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [66]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'hello world</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[66]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>12</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [67]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>상위 레벨 파일 객체가 닫혔거나 파괴되었다면, 그 하단 파일 디스크립터 역시 닫힘</li>
<li>이런 동작을 원하지 않는다면 closefd = False 인자를 open()에 전달해야 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [63]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 파일 객체를 생성하지만, 사용이 끝났을 때 fd를 닫지 않음</span>
<span class="c1"># f = open(fd, 'wt', closefd=False)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>Unix 시스템 상에서 이 기술을 사용하면 기존 I/O 채널(pipe, socket 등)을 감싸 파일과 같은 인터페이스로 사용할 수 있는 쉬운 길이 열림</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [50]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">socket</span> <span class="k">import</span> <span class="n">socket</span><span class="p">,</span> <span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [52]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">echo_client</span><span class="p">(</span><span class="n">client_sock</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'Got connection from'</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
    
    <span class="c1"># 읽기/쓰기를 위해 소켓에 대한 텍스트 모드 파일 wrapper를 만든다.</span>
    <span class="n">client_in</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">client_sock</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="s1">'rt'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'latin-1'</span><span class="p">,</span>
                     <span class="n">closefd</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">client_out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">client_sock</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="s1">'wt'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'latin-1'</span><span class="p">,</span>
                      <span class="n">closefd</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="c1"># 파일 I/O를 사용해 클라이언트에 라인을 에코한다.</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">client_in</span><span class="p">:</span>
        <span class="n">client_out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
        <span class="n">client_out</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
    <span class="n">client_sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    
<span class="k">def</span> <span class="nf">echo_server</span><span class="p">(</span><span class="n">address</span><span class="p">):</span>
    <span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">)</span>
    <span class="n">sock</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">address</span><span class="p">)</span>
    <span class="n">sock</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">client</span><span class="p">,</span> <span class="n">addr</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
        <span class="n">echo_client</span><span class="p">(</span><span class="n">client</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>앞의 나온 예제는 내장 함수 open()의 기능을 보이기 위한 목적</li>
<li>Unix 기반 시스템에서만 동작</li>
<li>소켓에 대한 파일같은 인터페이스가 필요</li>
<li>크로스 플랫폼 코드가 필요하다면 소켓의 makefile() 메소드를 사용해야 함</li>
<li>하지만 이식성을 신경쓰지 않는다면 makefile()을 사용하는 것보다 앞에 나온 예제가 성능 면에서 훨씬 뛰어남</li>
<li>이미 열려있는 파일을 가리키는 alias를 만들어 처음과 조금 다른 방법으로 사용하였는데 이 기술을 사용할 수도 있음</li>
<li>예를 들어 stdout(일반적으로 텍스트 모드로 열려 있다)에 바이너리 데이터를 넣기 위한 파익 객체를 만드는 방법을 보자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [69]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 제대로 동작 안됨</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="c1"># stdout에 대한 바이너리 모드 파일 만들기</span>
<span class="n">bstdout</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span> <span class="s1">'wb'</span><span class="p">,</span> <span class="n">closefd</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">bstdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="s1">'Hello World</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="n">bstdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">UnsupportedOperation</span>                      Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-69-1844da0dccec&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-green-fg">import</span> sys
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-red-fg"># stdout에 대한 바이너리 모드 파일 만들기</span>
<span class="ansi-green-fg">----&gt; 4</span><span class="ansi-red-fg"> </span>bstdout <span class="ansi-blue-fg">=</span> open<span class="ansi-blue-fg">(</span>sys<span class="ansi-blue-fg">.</span>stdout<span class="ansi-blue-fg">.</span>fileno<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">'wb'</span><span class="ansi-blue-fg">,</span> closefd<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> bstdout<span class="ansi-blue-fg">.</span>write<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">b'Hello World\n'</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      6</span> bstdout<span class="ansi-blue-fg">.</span>flush<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/site-packages/IPython/kernel/zmq/iostream.py</span> in <span class="ansi-cyan-fg">fileno</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    192</span> 
<span class="ansi-green-intense-fg ansi-bold">    193</span>     <span class="ansi-green-fg">def</span> fileno<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 194</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">raise</span> UnsupportedOperation<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">"IOStream has no fileno."</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    195</span> 
<span class="ansi-green-intense-fg ansi-bold">    196</span>     <span class="ansi-green-fg">def</span> write<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> string<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">UnsupportedOperation</span>: IOStream has no fileno.</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>기존 파일 디스크립터를 파일로 감싸는 것도 가능하지만, 모든 파일 모드를 지원하지 않을 수 있고 이런 파일 디스크립터에 예상치 못한 부작용이 생길 수 있음(에러 처리, 파일 끝 찾기 등에서 특히 위험)</li>
<li>또한 동작성이 운영체제에 따라 달라지기도 함</li>
<li>앞에서 나온 모든 예제는 Unix가 아닌 시스템에서 아마도 동작하지 않을 것이다.</li>
<li>결과적으로 구현물이 잘 동작하는지 꼼꼼히 테스트해 보는 수밖에 없다</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.19-임시-파일과-디렉토리-만들기">5.19 임시 파일과 디렉토리 만들기<a class="anchor-link" href="#5.19-%EC%9E%84%EC%8B%9C-%ED%8C%8C%EC%9D%BC%EA%B3%BC-%EB%94%94%EB%A0%89%ED%86%A0%EB%A6%AC-%EB%A7%8C%EB%93%A4%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>임시 파일이나 디렉토리를 만들어 프로그램에 사용해야 함</li>
<li>그 후에 파일이나 디렉토리는 아마도 파기할 생각</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>tempfile 모듈에 이런 목적의 함수가 많이 있음</li>
<li>이름없는 임시 파일을 만들기 위해서 tempfile.TemporaryFile 사용</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [70]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tempfile</span> <span class="k">import</span> <span class="n">TemporaryFile</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [71]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s1">'w+t'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="c1"># 파일에서 읽기/쓰기</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'Hello World</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">'Testing</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
    
    <span class="c1"># 처음으로 이동해 데이터를 읽는다.</span>
    <span class="n">f</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    
<span class="c1"># 임시 파일은 파괴된다.</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [72]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[72]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'Hello World\nTesting\n'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [73]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">TemporaryFile</span><span class="p">(</span><span class="s1">'w+t'</span><span class="p">)</span>
<span class="c1"># 임시 파일 사용</span>
<span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="c1"># 파일 파기</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>TemporaryFile()에 전달하는 첫 번째 인자는 파일 모드이고, 텍스트 모드에는 대개 w+t를, 바이너리 모드에는 w+b를 사용한다.</li>
<li>이 모드는 읽기와 쓰기를 동시에 지원하기 때문에 모드 변경을 위해 파일을 닫으면 실제로 파기하므로 유용</li>
<li>TemporaryFile()은 추가적으로 내장 함수 open()과 동일한 인자를 받음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [74]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># with TemporaryFile('w+t', encoding='utf-8', erros='ignore') as f:</span>
    <span class="c1">#</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>대게 Unix 시스템에서 TemporaryFile()로 생성한 파일에 이름이 없고 디렉토리 엔트리도 갖지 않는다.</li>
<li>이 제한을 없애고 싶으면 NamedTemporaryFile()을 사용하면 도니다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [75]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tempfile</span> <span class="k">import</span> <span class="n">NamedTemporaryFile</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [76]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="s1">'w+t'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'filename is:'</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    
<span class="c1"># 파일이 자동으로 파기된다.</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>filename is: /var/folders/7m/8grmt2yn73sbggnyzcg5phq80000gn/T/tmp9y6stc5b
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [77]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls -l /var/folders/7m/8grmt2yn73sbggnyzcg5phq80000gn/T/tmp9y6stc5b
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>ls: /var/folders/7m/8grmt2yn73sbggnyzcg5phq80000gn/T/tmp9y6stc5b: No such file or directory
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>f.name 속성에 임시 파일의 파일 이름이 담겨 있다. 다른 코드에 이 파일을 전달해야 할 필요가 생겼을 때 이 속성을 유효하게 사용할 수 있다.</li>
<li>TemporaryFile()과 마찬가지로 생성된 파일의 사용이 끝났을 떄 자동으로 삭제된다. 이런 동작을 원하지 않는다면 delete=False 키워드 인자를 사용한다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [78]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="s1">'w+t'</span><span class="p">,</span> <span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'filename is:'</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>filename is: /var/folders/7m/8grmt2yn73sbggnyzcg5phq80000gn/T/tmpiwe_8w0z
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [79]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls -l /var/folders/7m/8grmt2yn73sbggnyzcg5phq80000gn/T/tmpiwe_8w0z
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>-rw-------  1 re4lfl0w  staff  0 10  6 11:01 /var/folders/7m/8grmt2yn73sbggnyzcg5phq80000gn/T/tmpiwe_8w0z
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>임시 디렉토리를 만들기 위해서는 tempfile.TemporaryDirectory()를 사용한다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [80]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">tempfile</span> <span class="k">import</span> <span class="n">TemporaryDirectory</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [81]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="n">TemporaryDirectory</span><span class="p">()</span> <span class="k">as</span> <span class="n">dirname</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'dirname is:'</span><span class="p">,</span> <span class="n">dirname</span><span class="p">)</span>
    <span class="c1"># Use the directory</span>
    
<span class="c1"># 디렉토리와 모든 내용물이 파괴된다.</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>dirname is: /var/folders/7m/8grmt2yn73sbggnyzcg5phq80000gn/T/tmpkthphxqz
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>임시 파일과 디렉토리를 만들 때 TemporaryFile(), NamedTemporaryFile(), TemporaryDirectory() 함수가 가장 쉬운 방법</li>
<li>이 함수는 생성과 추후 파기까지 모두 자동으로 처리</li>
<li>더 하위 레벨로 내려가면 mkstemp()와 mkdtemp()로 임시 파일과 디렉토리를 만들 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [82]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">tempfile</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [83]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkstemp</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[83]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>(58, '/var/folders/7m/8grmt2yn73sbggnyzcg5phq80000gn/T/tmpg0x1bhfd')</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [84]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tempfile</span><span class="o">.</span><span class="n">mkdtemp</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[84]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'/var/folders/7m/8grmt2yn73sbggnyzcg5phq80000gn/T/tmpinm5ydkn'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>하지만 이 함수는 그 이상 관리를 책임지지 않음</li>
<li>mkstemp() 함수는 단순히 raw OS 파일 디스크립털르 반환할 뿐 이를 올바른 파일로 바꾸는 것은 프로그래머의 역할로 남겨둠. 이와 유사하게 파일을 제거하는 것도 독자에게 달려있음</li>
<li>일반적으로 임시 파일은 /var/tmp와 같은 시스템의 기본 위치에 생성</li>
<li>실제 위치를 찾으려면 tempfile.gettempdir() 함수 사용</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [95]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tempfile</span><span class="o">.</span><span class="n">gettempdir</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[95]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'/var/folders/7m/8grmt2yn73sbggnyzcg5phq80000gn/T'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>모든 임시 파일 관련 함수는 디렉토리와 이름 규칙을 오버라이드 할 수 있도록 함</li>
<li>prefix, suffix, dir 키워드 인자를 사용하면 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [87]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s1">'mytemp_'</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s1">'.txt'</span><span class="p">,</span> <span class="nb">dir</span><span class="o">=</span><span class="s1">'/tmp'</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">name</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[87]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'/tmp/mytemp_1dgbtfay.txt'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [88]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">NamedTemporaryFile</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Help on function NamedTemporaryFile in module tempfile:

NamedTemporaryFile(mode='w+b', buffering=-1, encoding=None, newline=None, suffix='', prefix='tmp', dir=None, delete=True)
    Create and return a temporary file.
    Arguments:
    'prefix', 'suffix', 'dir' -- as for mkstemp.
    'mode' -- the mode argument to io.open (default "w+b").
    'buffering' -- the buffer size argument to io.open (default -1).
    'encoding' -- the encoding argument to io.open (default None)
    'newline' -- the newline argument to io.open (default None)
    'delete' -- whether the file is deleted on close (default True).
    The file is created as mkstemp() would do it.
    
    Returns an object with a file-like interface; the name of the file
    is accessible as file.name.  The file will be automatically deleted
    when it is closed unless the 'delete' argument is set to False.

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>마지막으로 tempfile()은 가장 안전한 방식으로 파일을 생성한다는 점 기억</li>
<li>파일에 접근할 수 있는 권한은 현재 사용자에게만 주고, 파일 생성에서 레이스 컨디션이 발생하지 않도록 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.20-시리얼-포트와-통신">5.20 시리얼 포트와 통신<a class="anchor-link" href="#5.20-%EC%8B%9C%EB%A6%AC%EC%96%BC-%ED%8F%AC%ED%8A%B8%EC%99%80-%ED%86%B5%EC%8B%A0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>시리얼 포트를 통해 하드웨어 디바이스(로봇, 센서 등)와 통신하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>파이썬의 내장 기능으로 직접 해결할 수도 있지만, 그보다는 pySerial 패키지를 사용하는 것이 더 좋음</li>
<li>패키지 사용을 시작하기는 아주 쉬움</li>
</ul>
<blockquote>
<p>pip install pyserial</p>
</blockquote>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [97]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">serial</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [100]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ser</span> <span class="o">=</span> <span class="n">serial</span><span class="o">.</span><span class="n">Serial</span><span class="p">(</span><span class="s1">'/dev/tty.Bluetooth-Serial-1'</span><span class="p">,</span> <span class="c1">#  elqkdltm dlfmadms ekffkwlsek.</span>
                    <span class="n">baudrate</span><span class="o">=</span><span class="mi">9600</span><span class="p">,</span>
                    <span class="n">bytesize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span>
                    <span class="n">parity</span><span class="o">=</span><span class="s1">'N'</span><span class="p">,</span>
                    <span class="n">stopbits</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [103]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls -l /dev <span class="p">|</span> grep Serial
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>crw-rw-rw-  1 root      wheel        33,   1 10  4 16:29 cu.Bluetooth-Serial-1
crw-rw-rw-  1 root      wheel        33,   3 10  4 16:29 cu.Bluetooth-Serial-2
crw-rw-rw-  1 root      wheel        33,   0 10  4 16:29 tty.Bluetooth-Serial-1
crw-rw-rw-  1 root      wheel        33,   2 10  4 16:29 tty.Bluetooth-Serial-2
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>디바이스 이름은 디바이스의 종류나 운영체제에 따라 달라짐</li>
<li>Windows에서 0, 1 등을 사용해서 "COM0", "COM1" 과 같은 포트를 연다.</li>
<li>열고 나서 read(), readline(), write() 호출로 데이터를 읽고 쓴다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [104]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ser</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b</span><span class="s1">'G1 X50 Y50</span><span class="se">\r\n</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[104]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>12</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [105]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">resp</span> <span class="o">=</span> <span class="n">ser</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-105-12aebcd5007d&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>resp <span class="ansi-blue-fg">=</span> ser<span class="ansi-blue-fg">.</span>readline<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/site-packages/serial/serialposix.py</span> in <span class="ansi-cyan-fg">read</span><span class="ansi-blue-fg">(self, size)</span>
<span class="ansi-green-intense-fg ansi-bold">    459</span>         <span class="ansi-green-fg">while</span> len<span class="ansi-blue-fg">(</span>read<span class="ansi-blue-fg">)</span> <span class="ansi-blue-fg">&lt;</span> size<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    460</span>             <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 461</span><span class="ansi-red-fg">                 </span>ready<span class="ansi-blue-fg">,</span>_<span class="ansi-blue-fg">,</span>_ <span class="ansi-blue-fg">=</span> select<span class="ansi-blue-fg">.</span>select<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">[</span>self<span class="ansi-blue-fg">.</span>fd<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span> self<span class="ansi-blue-fg">.</span>_timeout<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    462</span>                 <span class="ansi-red-fg"># If select was used with a timeout, and the timeout occurs, it</span>
<span class="ansi-green-intense-fg ansi-bold">    463</span>                 <span class="ansi-red-fg"># returns with empty lists -&gt; thus abort read operation.</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>대개의 경우 이 시점부터 시리얼 통신은 아주 간단하다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>겉보기에는 시리얼 통신이 간단해 보이지만 때로 복잡해지는 경우가 있음</li>
<li>pySerial과 같은 패키지를 사용해야 하는 이유로 고급 기능(타임아웃, 컨트롤 플로우, 버퍼 플러싱, 핸드쉐이킹 등)을 지원한다는 점</li>
<li>예를 들어 RTS-CTS handshaking을 활성화하기 위해 Serial()에 rtscts=True 인자를 전달하기만 하면 됨</li>
<li>
<strong>제공되는 문서도 완벽</strong>하기 때문에 여기서 <strong>시간을 허비할 이유가 없어 보인다.</strong>
</li>
<li>시리얼 포트와 관련된 모든 입출력은 바이너리임을 기억하자.</li>
<li>따라서 코드를 작성할 떄 텍스트가 아닌 바이트를 사용하도록 해야 한다.(혹은 필요하다면 올바른 텍스트 인코딩/디코딩을 수행)</li>
<li>바이너리 코드 명령어나 패킷을 만들 때 struct 모듈을 사용하면 편리</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="5.21-파이썬-객체를-직렬화하기">5.21 파이썬 객체를 직렬화하기<a class="anchor-link" href="#5.21-%ED%8C%8C%EC%9D%B4%EC%8D%AC-%EA%B0%9D%EC%B2%B4%EB%A5%BC-%EC%A7%81%EB%A0%AC%ED%99%94%ED%95%98%EA%B8%B0">¶</a>
</h3>
<ul>
<li>pass</li>
<li>pickle은 array 모듈이나 numpy와 같은 라이브러리가 만들어 낸 거대한 자료 구조에 사용하기에 효율적인 인코딩 방식이 아니다.</li>
<li>뱅대한 자료를 이동해야 한다면 bulk 배열을 파일에 저장하거나 HDF5(서드파티 라이브러리가 지원)와 같은 좀 더 표준화된 인코딩을 사용하는 것이 좋음</li>
<li>솔직히 말해서 데이터베이스에 자료를 저장하거나 할 때 XML, CSV, JSON과 같은 좀 더 표준적인 데이터 인코딩을 사용하는 것이 더 좋음</li>
</ul>
</div>
</div>
</div>
    </div>
  </div>

        </div>
                <ul class="pager hidden-print">
<li class="previous">
                <a href="../ch05-01/" rel="prev" title="ch05_01">Previous post</a>
            </li>
            <li class="next">
                <a href="../ch06/" rel="next" title="ch06">Next post</a>
            </li>
        </ul>
<div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="re4lfl0w",
            disqus_url="https://example.com/posts/books/python_cookbook/ch05-02/",
        disqus_title="ch05_02",
        disqus_identifier="cache/posts/books/python_cookbook/ch05_02.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


    </div>
                    <footer id="footer"><p>Contents © 2016         <a href="mailto:n.tesla@example.com">Nikola Tesla</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="../../../../assets/js/all-nocdn.js" type="text/javascript"></script><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
