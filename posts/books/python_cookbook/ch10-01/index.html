<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns#
article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>ch10_01 | My Nikola Site</title>
<link href="../../../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../../../rss.xml">
<link rel="canonical" href="https://example.com/posts/books/python_cookbook/ch10-01/">
<!--[if lt IE 9]><script src="/assets/js/html5.js"></script><![endif]--><meta name="author" content="Nikola Tesla">
<meta property="og:site_name" content="My Nikola Site">
<meta property="og:title" content="ch10_01">
<meta property="og:url" content="https://example.com/posts/books/python_cookbook/ch10-01/">
<meta property="og:description" content="10. 모듈과 패키지¶
start: 2014-10-10
end:

커다란 프로젝트나 파이썬 설치에 있어 모듈과 패키지는 핵심이 됨

이번 장은 모듈과 패키지에 관련된 패키지 구성, 거대한 모듈을 여러 파일로 쪼개기, 네임스페이스 패키지 생성 등 일반적인 프로그래밍 기술에 초점을 맞춘다.
그리고 import 구문 자체를 커스터마이징 하는 레시피도 제공



">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2016-06-15T19:51:40-09:00">
</head>
<body>
    <section class="social"><ul>
<li><a href="../../../../index.html" title="Home"><i class="icon-home"></i></a></li>
            <li><a href="../../../../archive.html" title="Archives"><i class="icon-folder-open-alt"></i></a></li>
            <li><a href="../../../../categories/index.html" title="Tags"><i class="icon-tags"></i></a></li>
            <li><a href="../../../../rss.xml" title="RSS"><i class="icon-rss"></i></a></li>
            <li><a href="https://getnikola.com" title="About me"><i class="icon-user"></i></a></li>
            <li><a href="https://twitter.com/getnikola" title="My Twitter"><i class="icon-twitter"></i></a></li>
            <li><a href="https://github.com/getnikola" title="My Github"><i class="icon-github"></i></a></li>

        </ul></section><section class="page-content"><div class="content" rel="main">
    <div class="post">
        <h1 class="p-name entry-title" itemprop="headline name">ch10_01</h1>

        <div class="meta">
            <div class="authordate">
                <time class="timeago" datetime="2016-06-15T19:51:40-09:00">2016-06-15 19:51</time>
            
                      |  
        <a href="index.ipynb" id="sourcelink">Source</a>

            </div>
            
        </div>
        <div class="body">
            <div tabindex="-1" id="notebook" class="border-box-sizing">
    <div class="container" id="notebook-container">

<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="10.-모듈과-패키지">10. 모듈과 패키지<a class="anchor-link" href="#10.-%EB%AA%A8%EB%93%88%EA%B3%BC-%ED%8C%A8%ED%82%A4%EC%A7%80">¶</a>
</h2>
<ul>
<li>start: 2014-10-10</li>
<li>
<p>end:</p>
</li>
<li>
<p>커다란 프로젝트나 파이썬 설치에 있어 모듈과 패키지는 핵심이 됨</p>
</li>
<li>이번 장은 모듈과 패키지에 관련된 패키지 구성, 거대한 모듈을 여러 파일로 쪼개기, 네임스페이스 패키지 생성 등 일반적인 프로그래밍 기술에 초점을 맞춘다.</li>
<li>그리고 import 구문 자체를 커스터마이징 하는 레시피도 제공</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="10.1-모듈의-계층적-패키지-만들기">10.1 모듈의 계층적 패키지 만들기<a class="anchor-link" href="#10.1-%EB%AA%A8%EB%93%88%EC%9D%98-%EA%B3%84%EC%B8%B5%EC%A0%81-%ED%8C%A8%ED%82%A4%EC%A7%80-%EB%A7%8C%EB%93%A4%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>코드를, 모듈을 계층적으로 구성하는 패키지로 정리하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>패키지 구조를 만들기는 간단하다. 파일 시스템에서 원하는 대로 코드를 구성하고 모든 디렉토리에 __init__.py 파일을 정의한다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>tree 10/graphics/
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>10/graphics/
├── __init__.py
├── formats
│   ├── __init__.py
│   ├── jpg.py
│   └── png.py
└── primitive
    ├── __init__.py
    ├── fill.py
    ├── line.py
    └── text.py

2 directories, 8 files
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이렇게 하고 난 후에 다음과 같이 다양한 import 구문을 사용할 수 있다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">cd</span> 10
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>/Users/re4lfl0w/Documents/ipython/books/python_cookbook/10
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">graphics.primitive.line</span>
<span class="kn">from</span> <span class="nn">graphics.primitive</span> <span class="k">import</span> <span class="n">line</span>
<span class="kn">import</span> <span class="nn">graphics.formats.jpg</span> <span class="k">as</span> <span class="nn">jpg</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>계층적 모듈을 만드는 것은 파일 시스템에서 디렉토리를 구성하는 것만큼이나 쉽다. __init__.py 파일은 서로 다른 패키지 레벨에 대해 추가적인 초기화 코드를 실행하기 위해 존재한다.</li>
<li>예를 들어 import graphics 라는 코드가 있으면 graphics/__init__.py 파일이 임포트 되고 graphics 네임스페이스를 형성함</li>
<li>import graphics.formats.jpg와 같이 임포트하면 최종적으로 graphics/formats/jpg.py 파일을 임포트하기 전에 graphics/__init__.py와 graphics/formats/__init__.py가 모두 임포트 됨</li>
<li>대개의 경우 __init__.py 파일을 빈 파일로 만들어도 상관 없지만, 특정 상황에는 코드를 넣어야 함. 예를 들어 __init__.py 파일이 서브모듈을 자동적으로 로딩하도록 만들 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">writefile</span> graphics/formats/__init__.py
from . import jpg
from . import png
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Overwriting graphics/formats/__init__.py
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 파일의 경우 사용자가 graphics.formats.jpg와 graphics.formats.png를 일일이 임포트하지 않고 import graphics.formats 만 실행하면 나머지는 자동으로 처리됨</li>
<li>또한 모듈을 나누기 위해 사용한 여러 파일의 정의를 하나의 네임스페이스로 통합할 때도 __init__.py에 코드를 넣는다. 이 내용은 레시피 10.4에서 다룸</li>
<li>영리한 프로그래머라면 파이썬 3.3에서는 __init__.py 파일이 없어도 패키지 임포트가 잘 수행된다는 것을 알아차렸을 것이다.</li>
<li>__init__.py 파일을 정의하지 않으면 "namespace package"로 알려진 것을 생성하게 됨</li>
<li>이 내요은 레시피 10.5에 나온다. 주어진 모든 상황이 동일하다면 새로운 패키지를 만들 때 __init__.py 파일을 넣도록 하자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="10.2-일괄-임포트-제어">10.2 일괄 임포트 제어<a class="anchor-link" href="#10.2-%EC%9D%BC%EA%B4%84-%EC%9E%84%ED%8F%AC%ED%8A%B8-%EC%A0%9C%EC%96%B4">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>사용자가 from module import * 구문으로 모든 것을 임포트하려 할 때 세세한 내용을 제어하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>모듈에 내보낼 이름을 담은 리스트를 __all__ 변수에 명시</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [88]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">writefile</span> somemodule.py
def spam():
    print('spam method')

def grok():
    print('grok method')

blah = 42

# 'spam'과 'grok'만 내보낸다.
__all__ = ['spam', 'grok', 'blah']
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Overwriting somemodule.py
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [89]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">spam</span><span class="p">,</span> <span class="n">grok</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [90]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">somemodule</span> <span class="k">import</span> <span class="o">*</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [91]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spam</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [92]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grok</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [93]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">blah</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[93]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>42</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>from module import *을 사용하는 것은 대부분의 경우에 권장하지 않지만, 모듈에 많은 내용이 정의되어 있는 경우 이렇게 임포트하는 사용자가 여전히 많다.</li>
<li>앞에 나온 처리를 하지 않으면 밑줄로 시작하지 않는 모든 이름을 내보낸다.</li>
<li>하지만 __all__을 정의해 놓는다면 우리가 원하는 것만 임포트하도록 제어가 가능</li>
<li>__all__을 빈 리스트로 남겨두면 아무것도 내보내지 않음</li>
<li>만약 정의하지 않은 이름을 __all__에 넣으면 AttributeError 예외가 발생함: 이건 안되는듯...</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="10.3-상대-경로-패키지-서브모듈-임포트">10.3 상대 경로 패키지 서브모듈 임포트<a class="anchor-link" href="#10.3-%EC%83%81%EB%8C%80-%EA%B2%BD%EB%A1%9C-%ED%8C%A8%ED%82%A4%EC%A7%80-%EC%84%9C%EB%B8%8C%EB%AA%A8%EB%93%88-%EC%9E%84%ED%8F%AC%ED%8A%B8">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>패키지로 구성된 코드가 있고, 패키지 이름을 하드코딩하지 않고 다른 패키지 서브모듈을 임포트하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>다른 패키지의 모듈을 임포트하려면 패키지 상태 임포트(package relative import)를 사용하낟.</li>
<li>예를 들어 파일 시스템에 다음과 같이 구성된 mypackage가 있다고 가정해 보자.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [105]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>tree mypackage/
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>mypackage/
├── A
│   ├── __init__.py
│   ├── grok.py
│   └── spam.py
├── B
│   ├── __init__.py
│   └── bar.py
└── __init__.py

2 directories, 6 files
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>모듈 mypackage.A.spam 이 동일한 디렉토리의 grok 모듈을 임포트하려면 다음과 같이 하면 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># mypackage/A/spam.py</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">grok</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>동일한 모듈이 다른 디렉토리에 있는 B.bar 모듈을 임포트하고 싶으면 다음과 같이 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># mypackage/A/spam.py</span>

<span class="kn">from</span> <span class="nn">..B</span> <span class="k">import</span> <span class="n">bar</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>2 방식 모두 spam.py 파일에 상대적인 경로로 접근하고 상위 레벨 패키지 이름을 사용하지 않았다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>패키지 내부에서 동일한 패키지의 모듈을 임포트할 때 절대 경로를 모두 명시해도 되고, 앞의 예제에 나온대로 상대 경로를 사용해도 된다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [106]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># mypackage/A/spam.py</span>

<span class="kn">from</span> <span class="nn">mypackage.A</span> <span class="k">import</span> <span class="n">grok</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">grok</span>
<span class="kn">import</span> <span class="nn">grok</span> <span class="c1"># Error(찾을 수 없음))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>mypckage.A와 같이 절대 경로를 사용하면 소스 코드에 상위 레벨 패키지 이름을 <strong>하드코딩</strong>한다는 단점이 생김</li>
<li>따라서 코드의 안정성이 떨어지고 구조를 바꾸기라도 한다면 훨씬 어려운 작업을 해야 한다.</li>
<li>예를 들어 패키지의 이름을 바꾸는 경우에 모든 파일을 일일이 열어서 소스코드를 수정해야 한다.</li>
<li>이와 유사하게 하드코딩한 이름은 다른 사람이 코드를 옮길 때도 어려움을 야기함</li>
<li>누군가 두 패키지의 서로 다른 버전을 설치하며 이름으로만 구분하면 상대 경로는 그대로 잘 동작하지만 절대 경로를 모든 것이 문제가 됨</li>
</ul>
<ul>
<li>.: 현재 디렉토리</li>
<li>..: 상위 디렉토리</li>
<li>이 구문은 임포트의 from 구문에만 동작함</li>
</ul>
<ul>
<li>상대 임포트를 사용해서 파일 시스템을 여기 저기 열어볼 수 있을 것 같이 느껴지겠지만, 패키지를 정의한 디렉토리를 벗어나는 것은 불가능</li>
<li>점을 붙인 이름으로 패키지가 아닌 디렉토리에 접근해서 파일을 임포트하는 상황을 방지하기 위함</li>
</ul>
<ul>
<li>마지막으로, 상대 경로로 임포트하기는 올바른 패키지 내부에 위치한 모듈에만 동작한다는 점 기억</li>
<li>정확히 말해서 상위 레벨 스크립트에 있는 간단한 모듈에는 사용할 수 없음</li>
<li>그리고 패키지의 일부가 스크립트도 직접 실행되는 경우에도 사용할 수 없음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [109]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 상대적 임포트가 실패함</span>
<span class="o">!</span>python mypackage/A/spam.py
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [111]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 상대적 임포트가 동작</span>
<span class="o">!</span>python -m mypackage.A.spam
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>상대적 패키지 임포트 <a href="http://legacy.python.org/dev/peps/pep-0328/">PEP 328</a>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="10.4-모듈을-여러-파일로-나누기">10.4 모듈을 여러 파일로 나누기<a class="anchor-link" href="#10.4-%EB%AA%A8%EB%93%88%EC%9D%84-%EC%97%AC%EB%9F%AC-%ED%8C%8C%EC%9D%BC%EB%A1%9C-%EB%82%98%EB%88%84%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>여러 파일로 나누고 싶은 모듈이 있다. 하지만 기존 코드를 깨지 않고 별도의 파일을 하나의 모듈로 유지하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>프로그램 모듈을 패키지로 변환하면 여러 파일로 나눌 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [113]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># mymodule.py</span>

<span class="k">class</span> <span class="nc">A</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">spam</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'A.spam'</span><span class="p">)</span>
        
<span class="k">class</span> <span class="nc">B</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">bar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'B.bar'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>mymodule.py 파일을 2개로 나누고 파일마다 클래스 정의를 넣고 싶다면 어떻게 해야 할까?</li>
<li>우선 mymodule.py 파일을 mymodule 디렉토리로 치환</li>
<li>그리고 그 디렉토리에 다음과 같이 파일을 생성함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [119]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>tree mymodule/
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>mymodule/
├── __init__.py
├── a.py
└── b.py

0 directories, 3 files
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [120]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">writefile</span> mymodule/a.py
class A:
    def spam(self):
        print('A.spam')
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Overwriting mymodule/a.py
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [121]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">writefile</span> mymodule/b.py
from .a import A

class B(A):
    def bar(self):
        print('B.bar')
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Overwriting mymodule/b.py
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [122]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">writefile</span> mymodule/__init__.py
from .a import A
from .b import B
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Overwriting mymodule/__init__.py
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>앞에 나온 단계를 수행하고 나면 하나의 모듈로 mymodule 패키지가 나타남</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [123]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">mymodule</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [124]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">mymodule</span><span class="o">.</span><span class="n">A</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [125]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">spam</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>A.spam
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [126]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span> <span class="o">=</span> <span class="n">mymodule</span><span class="o">.</span><span class="n">B</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [127]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">b</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>B.bar
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>이번 레시피에서 가장 중요한 부분은 사용자가 수많은 작은 모듈을 가지고 작업하게 할지, 아니면 하나의 모듈만 사용하게 할지를 디자인 측면에서 결정하는 것</li>
<li>예를 들어 방대한 코드 베이스에서 모든 것을 볃롣의 파일로 나누고 사용자가 다음과 같이 수많은 import 구문을 쓰게 만들 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>from mymodule.a import A
from mymodule.b import B</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이렇게 해도 동작은 하지만 사용자의 부담이 커진다는 단점 존재</li>
<li>다음과 같이 import 구문을 하나만 사용해서 임포트하는 간편한 방법도 존재</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>from mymodule import A, B</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>후자의 경우, mymodule을 하나의 커다란 소스 파일로 생각하는 것이 일반적</li>
<li>하지만 이 레시피는 여러 파일을 합쳐서 하나의 네임스페이스로 만드는 방법을 다루었음</li>
<li>이렇게 하기위해서 패키지 디렉토리를 하나 만들고 __init__.py 파일로 합치는 것이 핵심</li>
</ul>
<ul>
<li>모듈을 나누면 서로를 참조하는 경우에 주의를 기울여야 함</li>
<li>예를 들어 이번 레시피에서 B클래스는 베이스 클래스 A에 접근해야 함</li>
<li>패키지 상대적 임포트 from .a import A로 이것을 얻음</li>
</ul>
<ul>
<li>이번 레시피에서는 상위 레벨 이름에 접근할 때 하드코딩을 피하기 위해 <strong>패키지 상대적 임포트</strong>를 사용</li>
<li>이 방식은 추후 <strong>모듈 이름 변경</strong>이나 <strong>코드 이동</strong>에 <strong>이점</strong>. 레시피 10.3 참고</li>
</ul>
<ul>
<li>레시피 내용을 확장해 lazy 임포트를 수행할 수도 있음</li>
<li>__init__.py 파일은 필요한 모든 부품을 한 번에 임포트 함</li>
<li>하지만 아주 큰 모듈의 경우 필요한 경우에만 부품을 불러오고 싶을 것</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [132]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">writefile</span> mymodule/__init__.py
def A():
    from .a import A
    return A()

def B():
    from .b import B
    return B()
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Overwriting mymodule/__init__.py
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이번 버전에서 A와 B 클래스는 처음 접근했을 때 원하는 클래스를 불러오는 함수로 치환했음. 사용자에게는 별다른 차이점이 없다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [136]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">del</span> <span class="n">mymodule</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [137]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">mymodule</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">mymodule</span><span class="o">.</span><span class="n">A</span><span class="p">()</span>
<span class="n">a</span><span class="o">.</span><span class="n">spam</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>A.spam
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>게으른 로딩은 상속과 타입 확인과 같은 코드에서 문제가 된다는 단점이 있음</li>
<li>예를 들어 다음과 같이 코드를 조금 더 수정해야 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [139]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Error</span>
<span class="c1"># if isinstance(x, mymodule.A):</span>
<span class="c1">#     pass</span>

<span class="c1"># Ok</span>
<span class="c1"># if isinstance(x, mymodule.a.A):</span>
<span class="c1">#     pass</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>실제로 게으른 로딩을 하는 예제를 보려면 표준 라이브러리의 <a href="http://svn.python.org/projects/python/branches/release26-maint/Lib/multiprocessing/__init__.py">multiprocessing/__init__.py</a> 파일 참고</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="10.5-공통된-네임스페이스에-코드-임포트-디렉토리-만들기">10.5 공통된 네임스페이스에 코드 임포트 디렉토리 만들기<a class="anchor-link" href="#10.5-%EA%B3%B5%ED%86%B5%EB%90%9C-%EB%84%A4%EC%9E%84%EC%8A%A4%ED%8E%98%EC%9D%B4%EC%8A%A4%EC%97%90-%EC%BD%94%EB%93%9C-%EC%9E%84%ED%8F%AC%ED%8A%B8-%EB%94%94%EB%A0%89%ED%86%A0%EB%A6%AC-%EB%A7%8C%EB%93%A4%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>여러 사람이 관리하고 배포해야 하는 커다란 코드가 있다.</li>
<li>모든 부분은 파일의 디렉토리로 구성되어 있음</li>
<li>하지만 각 부분을 별도의 이름있는 패키지로 설치하지 않고 모든 부분을 공통된 패키지 접두어로 합치고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>우선, 이 문제를 해결하기 위해서 별도로 관리되는 서브패키지에 대한 네임스페이스로 동작하는 상위 레벨 파이썬 패키지를 정의해야 함.</li>
<li>이런 문제는 커다란 애플리케이션 프레임워크에서 사용자가 직접 플러그인이나 add-on을 배포하도록 하고 싶을 때 종종 발생함</li>
</ul>
<ul>
<li>별도의 디렉토리를 공통된 네임스페이스로 합치기 위해서는, 보통 파이썬 패키지와 같은 코드를 구성해야 하는데, 요소를 합치려고 하는 디렉토리에는 __init__.py 파일을 생략해야 함</li>
<li>이해를 돕기 위해 다음과 같이 2개의 파이썬 코드 디렉토리가 있다고 가정해 보자.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [144]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>tree foo-package/
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>foo-package/
└── spam
    └── blah.py

1 directory, 1 file
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [145]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>tree bar-package/
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>bar-package/
└── spam
    └── grok.py

1 directory, 1 file
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 디렉토리에 spam이 공통 네임스페이스로 사용됨</li>
<li>모든 디렉토리에 __init__.py 파일이 없음에 주목</li>
</ul>
<ul>
<li>이제 foo-package와 bar-package를 파이썬 모듈 경로에 추가했을 때 어떤 일이 생기는지 살펴보자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [148]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="s1">'foo-package'</span><span class="p">,</span> <span class="s1">'bar-package'</span><span class="p">])</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [149]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">spam.blah</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [150]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">spam.grok</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [151]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">path</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[151]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>['',
 '/Users/re4lfl0w/Documents/ipython_private/scripts',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python34.zip',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/plat-darwin',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/lib-dynload',
 '/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4',
 '/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4/plat-darwin',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/site-packages',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/site-packages/IPython/extensions',
 '/Users/re4lfl0w/.ipython',
 '/Users/re4lfl0w/Documents/ipython_private/scripts/',
 'foo-package',
 'bar-package']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>보이는 것처럼, 마치 마법처럼 두 패키지 디렉토리가 하나로 합쳐지고 spam.blah나 spam.grok을 임포트할 수 있다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>여기에 나온 기능은 namespace package 라 불린다.</li>
<li>네임스페이스 패키지는 특별한 종류의 패키지로서, 서로 다른 코드 디렉토리를 하나의 네임스페이스로 합치는 역할을 함</li>
<li>방대한 프레임워크에서 이 기능이 유용한데, 프레임워크의 여러 부분을 별도의 디렉토리에 설치할 수 있기 때문</li>
<li>또한 사람들이 third-party 애드온이나 플러그인을 만들고 배포하기도 쉽다.</li>
</ul>
<ul>
<li>네임스페이스 패키지를 만들 때 공통된 네임스페이스가 되는 상위 레벨 디렉토리에 __init__.py 파일을 만들지 않는 것이 중요하다.</li>
<li>__init__.py 파일을 넣지 않으면 패키지 임포트에서 흥미로운 일이 생김</li>
<li>에러가 발생하지 않고 인터프리터가 패키지 이름을 포함하는 모든 디렉토리의 리스트를 생성하기 시작함</li>
<li>그리고 특별한 네임스페이스 패키지 모듈이 생성되고 디렉토리의 읽기 전용 복사본이 __path__ 변수에 저장됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [152]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">spam</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [153]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spam</span><span class="o">.</span><span class="n">__path__</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[153]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>_NamespacePath(['foo-package/spam', 'bar-package/spam'])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>__path__에 있는 디렉토리는 패키지 부속을 찾을 때 사용함(예: spam.grok 이나 spam.blah를 임포트할 때)</li>
<li>네임스페이스 패키지의 중요한 기능은 누구라도 네임스페이스를 확장할 수 있다는 점</li>
<li>예를 들어 다음과 같은 코드 디렉토리를 만들었다고 가정해 보자.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [156]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>tree my-package
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>my-package
└── spam
    └── custom.py

1 directory, 1 file
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>만약 이 코드를 sys.path에 다른 패키지와 함께 추가헀다면, 다른 spam 패키지 디렉토리와 마찬가지로 하나로 병합됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [158]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">path</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[158]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>['',
 '/Users/re4lfl0w/Documents/ipython_private/scripts',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python34.zip',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/plat-darwin',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/lib-dynload',
 '/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4',
 '/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4/plat-darwin',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/site-packages',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/site-packages/IPython/extensions',
 '/Users/re4lfl0w/.ipython',
 '/Users/re4lfl0w/Documents/ipython_private/scripts/',
 'foo-package',
 'bar-package']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [157]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">spam.custom</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ImportError</span>                               Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-157-bfec4a60ec95&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span><span class="ansi-green-fg">import</span> spam<span class="ansi-blue-fg">.</span>custom

<span class="ansi-red-fg">ImportError</span>: No module named 'spam.custom'</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [159]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">'my-package'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [161]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">path</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[161]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>['',
 '/Users/re4lfl0w/Documents/ipython_private/scripts',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python34.zip',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/plat-darwin',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/lib-dynload',
 '/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4',
 '/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4/plat-darwin',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/site-packages',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/site-packages/IPython/extensions',
 '/Users/re4lfl0w/.ipython',
 '/Users/re4lfl0w/Documents/ipython_private/scripts/',
 'foo-package',
 'bar-package',
 'my-package']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [160]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">spam.custom</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [162]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">spam.grok</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [163]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">spam.blah</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>디버깅 도구로섰, 어떤 패키지가 네임스페이스 패키지로 동작하는지 알아보는 방법은 __file__ 속성을 확인하는 것</li>
<li>이것을 찾을 수 없으면 이 패키지는 네임스페이스이다.</li>
<li>또한 표현 문자열에 "namespace" 라는 단어도 나타남</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [164]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spam</span><span class="o">.</span><span class="n">__file__</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-164-745dacaf6c82&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>spam<span class="ansi-blue-fg">.</span>__file__

<span class="ansi-red-fg">AttributeError</span>: 'module' object has no attribute '__file__'</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [165]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spam</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[165]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;module 'spam' (namespace)&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>표준라이브러리 import시</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [166]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="n">re</span><span class="o">.</span><span class="n">__file__</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[166]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/re.py'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [167]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">re</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[167]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;module 're' from '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/re.py'&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>네임스페이스 패키지에 대한 자세한 내용은 <a href="http://legacy.python.org/dev/peps/pep-0420/">PEP 420</a>에 나옴</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="10.6-모듈-리로드">10.6 모듈 리로드<a class="anchor-link" href="#10.6-%EB%AA%A8%EB%93%88-%EB%A6%AC%EB%A1%9C%EB%93%9C">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>소스 코드에 수정을 했기 때문에 이미 불러온 모듈을 다시 불러오고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>이미 불러온 모듈을 다시 불러오려면 imp.reload()를 사용함</li>
<li>python 2.7에서는 그냥 reload(re) 하면 됨</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [171]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">spam</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [202]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># This module provides the components needed to build your own __import__</span>
<span class="c1"># function.  Undocumented functions are obsolete.</span>

<span class="c1"># In most cases it is preferred you consider using the importlib module's</span>
<span class="c1"># functionality over this module.</span>

<span class="c1"># help(imp)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [172]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">imp</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [173]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">imp</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">spam</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[173]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;module 'spam' (namespace)&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>디버깅이나 개발 도중에 모듈 다시 불러오기를 유용하게 사용한다. 하지만 실제 애플리케이션에 사용하기에는 너무 위험하고 예상대로 동작하지 않는 경우가 많다.</li>
<li>내부적으로 reload()는 모듈의 기반 딕셔너리에 있는 내용을 모두 지우고 모듈의 소스 코드를 다시 실행한다. 모듈 객체의 독자성 자체에는 변함이 없음. 따라서 이렇게 하면 프로그램에서 임포트한 모듈 전체를 갱신함</li>
<li>하지만 reload()는 from module import name과 같은 구문으로 임포트한 정의는 갱신하지 않는다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [191]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">writefile</span> spam2.py
def bar():
    print('bar')
    
def grok():
    print('grok')
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Overwriting spam2.py
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [186]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">spam2</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [187]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">spam2</span> <span class="k">import</span> <span class="n">grok</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [188]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spam2</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>bar
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [190]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">grok</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>grok
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>파이썬을 종료하지 않고, spam.py 파일을 다음과 같이 수정함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [192]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">writefile</span> spam2.py
def bar():
    print('bar')
    
def grok():
    print('New grok')
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Overwriting spam2.py
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이제 인터렉티브 세션으로 돌아가서 모듈을 다시 불러오고 실험을 해보자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [193]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">imp</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [196]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">imp</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">spam2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[196]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>&lt;module 'spam2' from '/Users/re4lfl0w/Documents/ipython/books/python_cookbook/10/spam2.py'&gt;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [197]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">spam2</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>bar
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [198]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 기존 출력</span>
<span class="n">grok</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>grok
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [199]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 새로운 출력</span>
<span class="n">spam2</span><span class="o">.</span><span class="n">grok</span><span class="p">()</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>New grok
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 예제에서 2 종류의 grok() 함수가 로딩된 것을 볼 수 있음</li>
<li>일반적으로 이런 동작성은 원하지도 않고 결국에는 골치 아픈 문제만 야기함</li>
<li>이런 이유로 모듈 다시 불러오기는 실제 애플리케이션에 사용하지 않는 것이 좋음</li>
<li>그보다는 디버깅 용도나 인터렉티브 세션에서 인터프리터를 실험할 때 사용하도록 하자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="10.7-디렉토리나-Zip-파일을-실행-가능하게-만들기">10.7 디렉토리나 Zip 파일을 실행 가능하게 만들기<a class="anchor-link" href="#10.7-%EB%94%94%EB%A0%89%ED%86%A0%EB%A6%AC%EB%82%98-Zip-%ED%8C%8C%EC%9D%BC%EC%9D%84-%EC%8B%A4%ED%96%89-%EA%B0%80%EB%8A%A5%ED%95%98%EA%B2%8C-%EB%A7%8C%EB%93%A4%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>간단한 스크립트로는 해결할 수 없어 여러 파일로 나누어야 하는 프로그램을 작성하는 중이다.</li>
<li>이때 사용자가 쉽게 프로그램을 실행하는 방법을 제공하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>프로그램이 여러 파일로 나누어야 할 정도로 방대해졌다면 프로그램 디렉토리에 파일을 넣고 __main__.py 파일을 추가하면 된다. 예를 들어 다음과 같이 디렉토리를 만든다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [208]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>tree myapplication/
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>myapplication/
├── __main__.py
├── __pycache__
│   └── __main__.cpython-34.pyc
├── bar.py
├── grok.py
└── spam.py

1 directory, 5 files
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>__main__.py 파일이 있으면, 다음과 같이 간단히 파이썬 인터프리터를 실행할 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [209]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>python3 myapplication/
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>그러면 인터프리터가 __main__.py 파일을 메인으로 실행함</li>
<li>모든 코드를 zip 파일에 담아 두어도 동일하게 동작함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [210]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls myapplication/
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>__main__.py <span class="ansi-blue-fg">__pycache__</span> bar.py      grok.py     spam.py
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [211]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>zip -r myapplication/myapp.zip myapplication/*.py
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>  adding: myapplication/__main__.py (stored 0%)
  adding: myapplication/bar.py (stored 0%)
  adding: myapplication/grok.py (stored 0%)
  adding: myapplication/spam.py (stored 0%)
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [213]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls -l myapplication/
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>total 8
-rw-r--r--  1 re4lfl0w  staff    0 10 11 12:01 __main__.py
drwxr-xr-x  3 re4lfl0w  staff  102 10 11 12:03 <span class="ansi-blue-fg">__pycache__</span>
-rw-r--r--  1 re4lfl0w  staff    0 10 11 12:01 bar.py
-rw-r--r--  1 re4lfl0w  staff    0 10 11 12:01 grok.py
-rw-r--r--  1 re4lfl0w  staff  708 10 11 12:06 myapp.zip
-rw-r--r--  1 re4lfl0w  staff    0 10 11 12:01 spam.py
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [214]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>python3 myapplication/myapp.zip
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>/Users/re4lfl0w/virtualenv/python3_test/bin/python3: can't find '__main__' module in 'myapplication/myapp.zip'
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>디렉토리나 zip 파일을 만들고 __main__.py 파이을 추가하면 커다란 파이썬 애플리케이션을 쉽게 배포할 수 있음</li>
<li>이는 파이썬 라이브러리에 설치되어 표준 라이브러리 모듈로 사용하도록 한 패키지 코드와는 조금 다름</li>
<li>단지 누군가의 실행을 돕기 위해 만들어 낸 코드 번들이라고 생각하면 됨</li>
<li>디렉토리와 zip 파일은 일반적인 파일과는 조금 다르므로, 좀 더 쉬운 실행을 위해 지원 shell script 를 추가할 수 있음</li>
<li>myapp.zip 파일에 코드가 들어 있으면 상위 레벨 스크립트를 다음과 같이 만들 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>#!/usr/bin/env python3 /usr/local/bin/myapp.zip</code></pre>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="10.8-패키지의-데이터-파일-읽기">10.8 패키지의 데이터 파일 읽기<a class="anchor-link" href="#10.8-%ED%8C%A8%ED%82%A4%EC%A7%80%EC%9D%98-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%8C%8C%EC%9D%BC-%EC%9D%BD%EA%B8%B0">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>패키지에 포함되어 있는 데이터 파일을 읽어야 한다. 가능하면 호환성이 높은 방식으로 읽고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>다음과 같이 구성되어 있는 패키지 파일이 있다고 가정해 보자</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [221]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>tree mypackage_10_8/
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>mypackage_10_8/
├── __init__.py
├── somedata.dat
└── spam.py

0 directories, 3 files
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이제 spam.py 파일이 somedata.dat 파일의 데이터를 읽어야 한다. 이때 당므과 같은 코드를 작성한다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [222]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%</span><span class="k">writefile</span> mypackage_10_8/spam.py

import pkgutil
data = pkgutil.get_data(__package__, 'somedata.dat')
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Overwriting mypackage_10_8/spam.py
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>데이터 파일을 읽기 위해 open()과 같이 내장되어 있는 입출력 함수를 사용하고 싶을 것이다. 하지만 이 방식에는 몇 가지 문제점이 존재</li>
</ul>
<ul>
<li>첫째, 패키지는 인터프리터에서 현재 작업 중인 디렉토리에 대한 제어 능력이 극히 부족하다. 따라서 모든 입출력 동작은 절대 경로 파일 이름을 사용해야 함. 모든 모듈에 __file__ 변수가 제공되므로 불가능한 것은 아니지만, 코드가 굉장히 복잡해짐</li>
<li>둘째, 패키지는 종종 zip 이나 .egg 파일로 설치되어 있어 일반적인 파일 시스템 디렉토리의 파일과는 조금 다르다. 만약 open()으로 데이터 파일을 열려고 시도하면 제대로 동작하지 않는다.</li>
<li>pkgutil.get_data() 함수는 패키지가 어떻게 설치되었는지, 어디에 설치되었는지에 상관없이 데이터 파일을 얻는 상위 레벨 도구로 사용하도록 디자인되었음. 파일의 내용을 바이트 문자열로 반환하는 동작을 간단히 "수행한다."</li>
<li>get_data()의 첫번째 인자는 패키지 이름을 담은 문자열이다. 직접 이름을 제공하거나 __package__와 같은 특별 변수를 넣는다. 두번째 인자는 패키지 파일의 상대적 경로 이름이다. 필요하다면 표준 Unix 파일 이름 규칙으로 다른 디렉토리에 접근할 수도 있음. 단 이때, 파일이 동일한 패키지에 위치하고 있어야 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="10.9-sys.path에-디렉토리-추가">10.9 sys.path에 디렉토리 추가<a class="anchor-link" href="#10.9-sys.path%EC%97%90-%EB%94%94%EB%A0%89%ED%86%A0%EB%A6%AC-%EC%B6%94%EA%B0%80">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>sys.path에 포함되어 있지 않아서 임포트할 수 없는 파이썬 코드가 있다. 새로운 디렉토리를 파이썬 경로에 추가하고 싶지만 하드코딩은 피하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>새로운 디렉토리를 sys.path에 추가하는 일반적인 방법이 2가지 있다.</li>
<li>첫째, 이 이름을 PYTHONPATH 환경변수에 추가한다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span><span class="nb">echo</span> <span class="nv">$PYTHONPATH</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>/Users/re4lfl0w/Documents/ipython_private/scripts/
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>ls -l /Users/re4lfl0w/Documents/ipython/books/python_cookbook/10/mymodule/
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>total 24
-rw-r--r--  1 re4lfl0w  staff   90 10 11 11:02 __init__.py
drwxr-xr-x  5 re4lfl0w  staff  170 10 11 10:53 <span class="ansi-blue-fg">__pycache__</span>
-rw-r--r--  1 re4lfl0w  staff   52 10 11 10:53 a.py
-rw-r--r--  1 re4lfl0w  staff   71 10 11 10:53 b.py
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>커스텀 애플리케이션에서 이 환경변수는 프로그램을 실행할 때나 쉘 스크립터를 통해서 설정할 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><a href="http://fishshell.com/docs/current/index.html#variables">fish user documentation</a></li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># fish shell</span>
<span class="o">!</span><span class="nb">set</span> PYTHONPATH <span class="nv">$PYTHONPATH</span> ~/tmp/
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>2번째 방식은 다음과 가이 디렉토리를 리스팅하는 .pth 파일을 만드는 것</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># pth 설정</span>
<span class="o">!</span>cat /Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/site-packages/myapplication.pth
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>/Users/re4lfl0w/Documents/ipython/books/python_cookbook/10/mypackage
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 .pth 파일은 파이썬의 site-package 디렉토리에 넣어야 함</li>
<li>일반적으로 /usr/local/lib/python3.3/site-packages나 ~/.local/lib/python3.3/site-packages에 위치하고 있다.</li>
<li>인터프리터를 시작할 때, .pth 파일에 리스팅된 디렉토리가 sys.path에 추가됨(파일 시스템에 존재해야 함)</li>
<li>만약 이 파일이 시스템에 영향을 주는 파이썬 인터프리터에 추가되는 경우에는 관리자 권한을 요구할 수도 있다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>파일 위치 관련 문제를 해결하기 위해 sys.path를 직접 수정하는 코드를 작성할 수도 있지 않을까?</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># import sys</span>
<span class="c1"># sys.path.insert(0, '/some/dir')</span>
<span class="c1"># sys.path.insert(0, '/other/dir')</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이 방식이 동작하기는 하지만, 실제로 굉장히 위험한 접근법이므로 가능하다면 사용하지 않도록 함</li>
<li>우선 소스에 하드코딩된 디렉토리 이름을 추가한다는 문제</li>
<li>코드를 새로운 위치로 옮기거나 할 때 관리가 어려워짐</li>
<li>설정하는 곳을 다른 곳으로 빼서 소스 코드를 수정하지 않고 조절하는 방법을 제공하는 것이 더 좋음</li>
</ul>
<ul>
<li>때로는 __file__과 같이 모듈 레벨 변수를 사용한 절대 경로를 올바르게 만들면 하드코딩된 디렉토리 사용을 피할 수 있다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">path</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[3]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>['',
 '/Users/re4lfl0w/Documents/ipython_private/scripts',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python34.zip',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/plat-darwin',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/lib-dynload',
 '/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4',
 '/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4/plat-darwin',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/site-packages',
 '/Users/re4lfl0w/Documents/ipython/books/python_cookbook/10/mypackage',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/site-packages/IPython/extensions',
 '/Users/re4lfl0w/.ipython',
 '/Users/re4lfl0w/Documents/ipython_private/scripts/']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="k">import</span> <span class="n">abspath</span><span class="p">,</span> <span class="n">join</span><span class="p">,</span> <span class="n">dirname</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dirname</span><span class="p">(</span><span class="s1">'__file__'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[6]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>''</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="s1">'__file__'</span><span class="p">),</span> <span class="s1">'src'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[9]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'src'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">abspath</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="s1">'__file__'</span><span class="p">),</span> <span class="s1">'src'</span><span class="p">))</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[10]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>'/Users/re4lfl0w/Documents/ipython/books/python_cookbook/10/src'</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">abspath</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="s1">'__file__'</span><span class="p">),</span> <span class="s1">'src'</span><span class="p">)))</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sys</span><span class="o">.</span><span class="n">path</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[31]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>['/Users/re4lfl0w/Documents/ipython/books/python_cookbook/10/src',
 '',
 '/Users/re4lfl0w/Documents/ipython_private/scripts',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python34.zip',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/plat-darwin',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/lib-dynload',
 '/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4',
 '/usr/local/Cellar/python3/3.4.1/Frameworks/Python.framework/Versions/3.4/lib/python3.4/plat-darwin',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/site-packages',
 '/Users/re4lfl0w/Documents/ipython/books/python_cookbook/10/mypackage',
 '/Users/re4lfl0w/virtualenv/python3_test/lib/python3.4/site-packages/IPython/extensions',
 '/Users/re4lfl0w/.ipython',
 '/Users/re4lfl0w/Documents/ipython_private/scripts/']</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>이렇게 하면 삽입 과정을 실행하는 코드가 위치한 디렉토리 위치에 src 디렉토리를 추가한다.</li>
<li>site-packages 디렉토리는 일반적으로 서드파티 모듈과 패키지가 설치되는 곳</li>
<li>코드를 이런 방식으로 설치했다면 바로 여기에 위치하게 됨</li>
<li>환경 설정을 위한 .pth 파일이 site-packages 에 나타나야 하지만, 원한다면 시스템의 어떤 디렉토리도 참조하도록 할 수 있음</li>
<li>따라서 .pth 파일에 포함되어 있기만 하다면 전혀 다른 디레고리 집합을 고르도록 코드에 지시할 수 있음</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="10.10-문자열로-주어진-모듈-이름-임포트">10.10 문자열로 주어진 모듈 이름 임포트<a class="anchor-link" href="#10.10-%EB%AC%B8%EC%9E%90%EC%97%B4%EB%A1%9C-%EC%A3%BC%EC%96%B4%EC%A7%84-%EB%AA%A8%EB%93%88-%EC%9D%B4%EB%A6%84-%EC%9E%84%ED%8F%AC%ED%8A%B8">¶</a>
</h3>
<h4 id="문제">문제<a class="anchor-link" href="#%EB%AC%B8%EC%A0%9C">¶</a>
</h4>
<ul>
<li>임포트하고 싶은 모듈 이름을 문자열 형태로 가지고 있다. 이 문자열에 import를 실행하고 싶다.</li>
</ul>
<h4 id="해결">해결<a class="anchor-link" href="#%ED%95%B4%EA%B2%B0">¶</a>
</h4>
<ul>
<li>importlib.import_module() 함수로, 문자열로 주어진 모듈이나 패키지 이름을 임포트할 수 있다.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [32]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">importlib</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">math</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="s1">'math'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [34]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt output_prompt">Out[34]:</div>


<div class="output_text output_subarea output_execute_result">
<pre>0.9092974268256817</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [35]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mod</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="s1">'urllib.request'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [36]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">u</span> <span class="o">=</span> <span class="n">mod</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s1">'http://www.python.org'</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>import_module은 import와 동일한 과정을 수행하지만 결과 모듈 객체를 반환단다는 점이 다르다. 이것을 변수로 저장하고 추후 일반적인 모듈처럼 사용할 수 있음</li>
<li>패키지를 가지고 작업중이라면 import_module()로 상대적 경로를 임포트할 수 있음</li>
<li>하지만 다음과 같이 추가적인 인자를 넣어야 함</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">importlib</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [67]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># 'from . import b'와 동일</span>
<span class="c1"># . 넣으면 안되네</span>
<span class="c1"># .은 __init__에서만 사용 가능한건가??</span>
<span class="c1"># 나중에 다시 한 번 찾아보자..</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="s1">'spam2'</span><span class="p">,</span> <span class="n">__package__</span><span class="p">)</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [51]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>cat somemodule.py
</pre></div>

</div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>def spam():
    print('spam method')

def grok():
    print('grok method')

blah = 42

# 'spam'과 'grok'만 내보낸다.
__all__ = ['spam', 'grok', 'blah']</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [60]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">mymodule</span> <span class="k">import</span> <span class="n">A</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">__package__</span>
</pre></div>

</div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="토론">토론<a class="anchor-link" href="#%ED%86%A0%EB%A1%A0">¶</a>
</h4>
<ul>
<li>import_module()을 사용해서 모듈을 수동으로 사용할 때 발생하는 문제는 대개 모듈을 감싸거나 수정하는 코드를 작성할 때 발생한다.</li>
<li>예를 들어, 모듈을 이름으로 불러오고 로딩한 코드에 패치를 하는 커스텀 임포팅 메커니즘을 구현하는 중이라고 가정해 보자.</li>
<li>오래된 코드에서 내장된 __import__() 함수로 임포트를 수행하는 것을 볼 수 있다. 이 방식도 동작은 하지만, 대개는 importlib.import_module()을 사용하는 것이 더 쉽다.</li>
<li>임포트 처리를 커스터마이즈하는 고급 예제는 레시피 10.11 참고</li>
</ul>
</div>
</div>
</div>
    </div>
  </div>

        </div>
                <ul class="pager hidden-print">
<li class="previous">
                <a href="../ch09-02/" rel="prev" title="ch09_02">Previous post</a>
            </li>
            <li class="next">
                <a href="../ch10-02/" rel="next" title="ch10_02">Next post</a>
            </li>
        </ul>
<div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="re4lfl0w",
            disqus_url="https://example.com/posts/books/python_cookbook/ch10-01/",
        disqus_title="ch10_01",
        disqus_identifier="cache/posts/books/python_cookbook/ch10_01.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


    </div>
                    <footer id="footer"><p>Contents © 2016         <a href="mailto:n.tesla@example.com">Nikola Tesla</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    </section><script src="../../../../assets/js/all-nocdn.js" type="text/javascript"></script><script type="text/javascript">
            $(function(){
                $('.timeago').timeago();
            });
        </script>
</body>
</html>
